#!/bin/bash
#SBATCH --job-name=train-random
#SBATCH --partition=xlab-gpu
#SBATCH --nodes=1
#SBATCH --mem=64G
#SBATCH --gres=gpu:1
#SBATCH --time=20:00:00
#SBATCH --mail-type=ALL
#SBATCH --mail-user=alisaliu@uw.edu
#SBATCH --output="slurm/train/slurm-%J-%x.out"

cat $0
echo "--------------------"

MODEL_OUTPUT_DIR=output/mnli_random/random_$FRACTION

python -m cartography.classification.run_glue \
    -c configs/mnli.jsonnet \
    --do_train \
    --do_test \
    --train filtered/random/cartography_random_$FRACTION/train.tsv \
    -o $MODEL_OUTPUT_DIR
--------------------
2021-03-13 21:38:50,692 - WARNING - __main__ - Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
2021-03-13 21:39:00,717 - INFO - transformers.configuration_utils - loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-large-config.json from cache at /usr/lusers/alisaliu/.cache/torch/transformers/c22e0b5bbb7c0cb93a87a2ae01263ae715b4c18d692b1740ce72cacaa99ad184.2d28da311092e99a05f9ee17520204614d60b0bfdb32f8a75644df7737b6a748
2021-03-13 21:39:00,720 - INFO - transformers.configuration_utils - Model config RobertaConfig {
  "architectures": [
    "RobertaForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "bos_token_id": 0,
  "do_sample": false,
  "eos_token_id": 2,
  "eos_token_ids": null,
  "finetuning_task": "mnli",
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 1024,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "intermediate_size": 4096,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-05,
  "length_penalty": 1.0,
  "max_length": 20,
  "max_position_embeddings": 514,
  "model_type": "roberta",
  "num_attention_heads": 16,
  "num_beams": 1,
  "num_hidden_layers": 24,
  "num_labels": 3,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 1,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "type_vocab_size": 1,
  "use_bfloat16": false,
  "vocab_size": 50265
}

2021-03-13 21:39:20,756 - INFO - transformers.tokenization_utils - loading file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-large-vocab.json from cache at /usr/lusers/alisaliu/.cache/torch/transformers/1ae1f5b6e2b22b25ccc04c000bb79ca847aa226d0761536b011cf7e5868f0655.ef00af9e673c7160b4d41cfda1f48c5f4cba57d5142754525572a846a1ab1b9b
2021-03-13 21:39:20,759 - INFO - transformers.tokenization_utils - loading file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-large-merges.txt from cache at /usr/lusers/alisaliu/.cache/torch/transformers/f8f83199a6270d582d6245dc100e99c4155de81c9745c6248077018fe01abcfb.70bec105b4158ed9a1747fea67a43f5dee97855c64d62b6ec3742f4cfdb5feda
2021-03-13 21:39:30,879 - INFO - transformers.modeling_utils - loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-large-pytorch_model.bin from cache at /usr/lusers/alisaliu/.cache/torch/transformers/195c00f28dc68ef13a307c6db84d566f801f03b2b6bcf8b29524f10f767fac2a.fc7abf72755ecc4a75d0d336a93c1c63358d2334f5998ed326f3b0da380bf536
2021-03-13 21:39:42,700 - INFO - transformers.modeling_utils - Weights of AdaptedRobertaForSequenceClassification not initialized from pretrained model: ['classifier.dense.weight', 'classifier.dense.bias', 'classifier.out_proj.weight', 'classifier.out_proj.bias']
2021-03-13 21:39:42,702 - INFO - transformers.modeling_utils - Weights from pretrained model not used in AdaptedRobertaForSequenceClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
2021-03-13 21:39:45,183 - INFO - __main__ - Training/evaluation parameters <cartography.classification.params.Params object at 0x2b010e8e5f40>
2021-03-13 21:39:45,193 - INFO - __main__ - Creating features from dataset file at /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/
2021-03-13 21:39:45,318 - INFO - cartography.classification.glue_utils - Writing example 0/3927
2021-03-13 21:39:46,907 - INFO - __main__ - Saving features into cached file /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/filtered/random/cartography_random_0.01/cache_20/cached_train_roberta-large_128_mnli
2021-03-13 21:39:47,510 - INFO - __main__ - ***** Running training *****
2021-03-13 21:39:47,511 - INFO - __main__ -   Num examples = 3927
2021-03-13 21:39:47,511 - INFO - __main__ -   Num Epochs = 5
2021-03-13 21:39:47,511 - INFO - __main__ -   Instantaneous batch size per GPU = 32
2021-03-13 21:39:47,511 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 96
2021-03-13 21:39:47,511 - INFO - __main__ -   Gradient Accumulation steps = 3
2021-03-13 21:39:47,511 - INFO - __main__ -   Total optimization steps = 205
Epoch:   0%|                                                                  | 0/5 [00:00<?, ?it/s]
Iteration:   0%|                                                            | 0/123 [00:00<?, ?it/s][Atrain_epoch: 0 train_acc: 0.0000:   0%|                                       | 0/5 [00:00<?, ?it/s]/gscratch/cse/alisaliu/miniconda3/envs/cartography/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:247: UserWarning: To get the last learning rate computed by the scheduler, please use `get_last_lr()`.
  warnings.warn("To get the last learning rate computed by the scheduler, "

lr = 0.00001099, loss = 0.3733:   0%|                                       | 0/123 [00:02<?, ?it/s][A
lr = 0.00001099, loss = 0.3790:   0%|                                       | 0/123 [00:03<?, ?it/s][A/gscratch/cse/alisaliu/miniconda3/envs/cartography/lib/python3.9/site-packages/transformers/optimization.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at  /opt/conda/conda-bld/pytorch_1607370151529/work/torch/csrc/utils/python_arg_parser.cpp:882.)
  exp_avg.mul_(beta1).add_(1.0 - beta1, grad)

lr = 0.00001094, loss = 0.3737:   0%|                                       | 0/123 [00:04<?, ?it/s][A
lr = 0.00001094, loss = 0.3735:   0%|                                       | 0/123 [00:04<?, ?it/s][A
lr = 0.00001094, loss = 0.3710:   0%|                                       | 0/123 [00:05<?, ?it/s][A
lr = 0.00001089, loss = 0.3712:   0%|                                       | 0/123 [00:06<?, ?it/s][A
lr = 0.00001089, loss = 0.3729:   0%|                                       | 0/123 [00:06<?, ?it/s][A
lr = 0.00001089, loss = 0.3732:   0%|                                       | 0/123 [00:07<?, ?it/s][A
lr = 0.00001083, loss = 0.3738:   0%|                                       | 0/123 [00:08<?, ?it/s][A
lr = 0.00001083, loss = 0.3737:   0%|                                       | 0/123 [00:09<?, ?it/s][A
lr = 0.00001083, loss = 0.3742:   0%|                                       | 0/123 [00:09<?, ?it/s][A
lr = 0.00001078, loss = 0.3732:   0%|                                       | 0/123 [00:10<?, ?it/s][A
lr = 0.00001078, loss = 0.3732:  10%|██▉                           | 12/123 [00:10<01:37,  1.14it/s][A
lr = 0.00001078, loss = 0.3733:  10%|██▉                           | 12/123 [00:11<01:37,  1.14it/s][A
lr = 0.00001078, loss = 0.3731:  10%|██▉                           | 12/123 [00:11<01:37,  1.14it/s][A
lr = 0.00001072, loss = 0.3738:  10%|██▉                           | 12/123 [00:12<01:37,  1.14it/s][A
lr = 0.00001072, loss = 0.3740:  10%|██▉                           | 12/123 [00:13<01:37,  1.14it/s][A
lr = 0.00001072, loss = 0.3739:  10%|██▉                           | 12/123 [00:14<01:37,  1.14it/s][A
lr = 0.00001067, loss = 0.3735:  10%|██▉                           | 12/123 [00:14<01:37,  1.14it/s][A
lr = 0.00001067, loss = 0.3736:  10%|██▉                           | 12/123 [00:15<01:37,  1.14it/s][A
lr = 0.00001067, loss = 0.3746:  10%|██▉                           | 12/123 [00:16<01:37,  1.14it/s][A
lr = 0.00001062, loss = 0.3738:  10%|██▉                           | 12/123 [00:16<01:37,  1.14it/s][A
lr = 0.00001062, loss = 0.3737:  10%|██▉                           | 12/123 [00:17<01:37,  1.14it/s][A
lr = 0.00001062, loss = 0.3737:  10%|██▉                           | 12/123 [00:18<01:37,  1.14it/s][A
lr = 0.00001056, loss = 0.3737:  10%|██▉                           | 12/123 [00:19<01:37,  1.14it/s][A
lr = 0.00001056, loss = 0.3729:  10%|██▉                           | 12/123 [00:19<01:37,  1.14it/s][A
lr = 0.00001056, loss = 0.3729:  10%|██▉                           | 12/123 [00:20<01:37,  1.14it/s][A
lr = 0.00001051, loss = 0.3718:  10%|██▉                           | 12/123 [00:21<01:37,  1.14it/s][A
lr = 0.00001051, loss = 0.3718:  22%|██████▌                       | 27/123 [00:21<01:19,  1.21it/s][A
lr = 0.00001051, loss = 0.3725:  22%|██████▌                       | 27/123 [00:21<01:19,  1.21it/s][A
lr = 0.00001051, loss = 0.3725:  22%|██████▌                       | 27/123 [00:22<01:19,  1.21it/s][A
lr = 0.00001046, loss = 0.3726:  22%|██████▌                       | 27/123 [00:23<01:19,  1.21it/s][A
lr = 0.00001046, loss = 0.3723:  22%|██████▌                       | 27/123 [00:23<01:19,  1.21it/s][A
lr = 0.00001046, loss = 0.3725:  22%|██████▌                       | 27/123 [00:24<01:19,  1.21it/s][A
lr = 0.00001040, loss = 0.3727:  22%|██████▌                       | 27/123 [00:25<01:19,  1.21it/s][A
lr = 0.00001040, loss = 0.3730:  22%|██████▌                       | 27/123 [00:26<01:19,  1.21it/s][A
lr = 0.00001040, loss = 0.3725:  22%|██████▌                       | 27/123 [00:26<01:19,  1.21it/s][A
lr = 0.00001035, loss = 0.3724:  22%|██████▌                       | 27/123 [00:27<01:19,  1.21it/s][A
lr = 0.00001035, loss = 0.3726:  22%|██████▌                       | 27/123 [00:28<01:19,  1.21it/s][A
lr = 0.00001035, loss = 0.3721:  22%|██████▌                       | 27/123 [00:28<01:19,  1.21it/s][A
lr = 0.00001030, loss = 0.3725:  22%|██████▌                       | 27/123 [00:29<01:19,  1.21it/s][A
lr = 0.00001030, loss = 0.3728:  22%|██████▌                       | 27/123 [00:30<01:19,  1.21it/s][A
lr = 0.00001030, loss = 0.3730:  22%|██████▌                       | 27/123 [00:31<01:19,  1.21it/s][A
lr = 0.00001024, loss = 0.3730:  22%|██████▌                       | 27/123 [00:31<01:19,  1.21it/s][A
lr = 0.00001024, loss = 0.3730:  34%|██████████▏                   | 42/123 [00:31<01:04,  1.26it/s][A
lr = 0.00001024, loss = 0.3724:  34%|██████████▏                   | 42/123 [00:32<01:04,  1.26it/s][A
lr = 0.00001024, loss = 0.3730:  34%|██████████▏                   | 42/123 [00:33<01:04,  1.26it/s][A
lr = 0.00001019, loss = 0.3731:  34%|██████████▏                   | 42/123 [00:34<01:04,  1.26it/s][A
lr = 0.00001019, loss = 0.3735:  34%|██████████▏                   | 42/123 [00:34<01:04,  1.26it/s][A
lr = 0.00001019, loss = 0.3733:  34%|██████████▏                   | 42/123 [00:35<01:04,  1.26it/s][A
lr = 0.00001014, loss = 0.3733:  34%|██████████▏                   | 42/123 [00:36<01:04,  1.26it/s][A
lr = 0.00001014, loss = 0.3734:  34%|██████████▏                   | 42/123 [00:36<01:04,  1.26it/s][A
lr = 0.00001014, loss = 0.3728:  34%|██████████▏                   | 42/123 [00:37<01:04,  1.26it/s][A
lr = 0.00001008, loss = 0.3727:  34%|██████████▏                   | 42/123 [00:38<01:04,  1.26it/s][A
lr = 0.00001008, loss = 0.3727:  34%|██████████▏                   | 42/123 [00:39<01:04,  1.26it/s][A
lr = 0.00001008, loss = 0.3726:  34%|██████████▏                   | 42/123 [00:39<01:04,  1.26it/s][A
lr = 0.00001003, loss = 0.3726:  34%|██████████▏                   | 42/123 [00:40<01:04,  1.26it/s][A
lr = 0.00001003, loss = 0.3723:  34%|██████████▏                   | 42/123 [00:41<01:04,  1.26it/s][A
lr = 0.00001003, loss = 0.3723:  34%|██████████▏                   | 42/123 [00:41<01:04,  1.26it/s][A
lr = 0.00001003, loss = 0.3723:  46%|█████████████▋                | 56/123 [00:41<00:51,  1.30it/s][A
lr = 0.00000997, loss = 0.3722:  46%|█████████████▋                | 56/123 [00:42<00:51,  1.30it/s][A
lr = 0.00000997, loss = 0.3721:  46%|█████████████▋                | 56/123 [00:43<00:51,  1.30it/s][A
lr = 0.00000997, loss = 0.3719:  46%|█████████████▋                | 56/123 [00:44<00:51,  1.30it/s][A
lr = 0.00000992, loss = 0.3722:  46%|█████████████▋                | 56/123 [00:44<00:51,  1.30it/s][A
lr = 0.00000992, loss = 0.3723:  46%|█████████████▋                | 56/123 [00:45<00:51,  1.30it/s][A
lr = 0.00000992, loss = 0.3723:  46%|█████████████▋                | 56/123 [00:46<00:51,  1.30it/s][A
lr = 0.00000987, loss = 0.3724:  46%|█████████████▋                | 56/123 [00:47<00:51,  1.30it/s][A
lr = 0.00000987, loss = 0.3727:  46%|█████████████▋                | 56/123 [00:47<00:51,  1.30it/s][A
lr = 0.00000987, loss = 0.3728:  46%|█████████████▋                | 56/123 [00:48<00:51,  1.30it/s][A
lr = 0.00000981, loss = 0.3728:  46%|█████████████▋                | 56/123 [00:49<00:51,  1.30it/s][A
lr = 0.00000981, loss = 0.3727:  46%|█████████████▋                | 56/123 [00:49<00:51,  1.30it/s][A
lr = 0.00000981, loss = 0.3729:  46%|█████████████▋                | 56/123 [00:50<00:51,  1.30it/s][A
lr = 0.00000976, loss = 0.3728:  46%|█████████████▋                | 56/123 [00:51<00:51,  1.30it/s][A
lr = 0.00000976, loss = 0.3729:  46%|█████████████▋                | 56/123 [00:52<00:51,  1.30it/s][A
lr = 0.00000976, loss = 0.3729:  57%|█████████████████             | 70/123 [00:52<00:40,  1.32it/s][A
lr = 0.00000976, loss = 0.3729:  57%|█████████████████             | 70/123 [00:52<00:40,  1.32it/s][A
lr = 0.00000971, loss = 0.3728:  57%|█████████████████             | 70/123 [00:53<00:40,  1.32it/s][A
lr = 0.00000971, loss = 0.3727:  57%|█████████████████             | 70/123 [00:54<00:40,  1.32it/s][A
lr = 0.00000971, loss = 0.3729:  57%|█████████████████             | 70/123 [00:54<00:40,  1.32it/s][A
lr = 0.00000965, loss = 0.3730:  57%|█████████████████             | 70/123 [00:55<00:40,  1.32it/s][A
lr = 0.00000965, loss = 0.3731:  57%|█████████████████             | 70/123 [00:56<00:40,  1.32it/s][A
lr = 0.00000965, loss = 0.3732:  57%|█████████████████             | 70/123 [00:57<00:40,  1.32it/s][A
lr = 0.00000960, loss = 0.3732:  57%|█████████████████             | 70/123 [00:57<00:40,  1.32it/s][A
lr = 0.00000960, loss = 0.3732:  57%|█████████████████             | 70/123 [00:58<00:40,  1.32it/s][A
lr = 0.00000960, loss = 0.3730:  57%|█████████████████             | 70/123 [00:59<00:40,  1.32it/s][A
lr = 0.00000955, loss = 0.3727:  57%|█████████████████             | 70/123 [01:00<00:40,  1.32it/s][A
lr = 0.00000955, loss = 0.3729:  57%|█████████████████             | 70/123 [01:00<00:40,  1.32it/s][A
lr = 0.00000955, loss = 0.3728:  57%|█████████████████             | 70/123 [01:01<00:40,  1.32it/s][A
lr = 0.00000949, loss = 0.3728:  57%|█████████████████             | 70/123 [01:02<00:40,  1.32it/s][A
lr = 0.00000949, loss = 0.3728:  68%|████████████████████▍         | 84/123 [01:02<00:29,  1.33it/s][A
lr = 0.00000949, loss = 0.3729:  68%|████████████████████▍         | 84/123 [01:03<00:29,  1.33it/s][A
lr = 0.00000949, loss = 0.3729:  68%|████████████████████▍         | 84/123 [01:03<00:29,  1.33it/s][A
lr = 0.00000944, loss = 0.3728:  68%|████████████████████▍         | 84/123 [01:04<00:29,  1.33it/s][A
lr = 0.00000944, loss = 0.3728:  68%|████████████████████▍         | 84/123 [01:05<00:29,  1.33it/s][A
lr = 0.00000944, loss = 0.3727:  68%|████████████████████▍         | 84/123 [01:05<00:29,  1.33it/s][A
lr = 0.00000938, loss = 0.3728:  68%|████████████████████▍         | 84/123 [01:06<00:29,  1.33it/s][A
lr = 0.00000938, loss = 0.3727:  68%|████████████████████▍         | 84/123 [01:07<00:29,  1.33it/s][A
lr = 0.00000938, loss = 0.3727:  68%|████████████████████▍         | 84/123 [01:08<00:29,  1.33it/s][A
lr = 0.00000933, loss = 0.3726:  68%|████████████████████▍         | 84/123 [01:08<00:29,  1.33it/s][A
lr = 0.00000933, loss = 0.3727:  68%|████████████████████▍         | 84/123 [01:09<00:29,  1.33it/s][A
lr = 0.00000933, loss = 0.3726:  68%|████████████████████▍         | 84/123 [01:10<00:29,  1.33it/s][A
lr = 0.00000928, loss = 0.3725:  68%|████████████████████▍         | 84/123 [01:11<00:29,  1.33it/s][A
lr = 0.00000928, loss = 0.3724:  68%|████████████████████▍         | 84/123 [01:11<00:29,  1.33it/s][A
lr = 0.00000928, loss = 0.3723:  68%|████████████████████▍         | 84/123 [01:12<00:29,  1.33it/s][A
lr = 0.00000928, loss = 0.3723:  80%|███████████████████████▉      | 98/123 [01:12<00:18,  1.35it/s][A
lr = 0.00000922, loss = 0.3724:  80%|███████████████████████▉      | 98/123 [01:13<00:18,  1.35it/s][A
lr = 0.00000922, loss = 0.3723:  80%|███████████████████████▉      | 98/123 [01:13<00:18,  1.35it/s][A
lr = 0.00000922, loss = 0.3722:  80%|███████████████████████▉      | 98/123 [01:14<00:18,  1.35it/s][A
lr = 0.00000917, loss = 0.3722:  80%|███████████████████████▉      | 98/123 [01:15<00:18,  1.35it/s][A
lr = 0.00000917, loss = 0.3722:  80%|███████████████████████▉      | 98/123 [01:16<00:18,  1.35it/s][A
lr = 0.00000917, loss = 0.3722:  80%|███████████████████████▉      | 98/123 [01:16<00:18,  1.35it/s][A
lr = 0.00000912, loss = 0.3723:  80%|███████████████████████▉      | 98/123 [01:17<00:18,  1.35it/s][A
lr = 0.00000912, loss = 0.3722:  80%|███████████████████████▉      | 98/123 [01:18<00:18,  1.35it/s][A
lr = 0.00000912, loss = 0.3723:  80%|███████████████████████▉      | 98/123 [01:19<00:18,  1.35it/s][A
lr = 0.00000906, loss = 0.3723:  80%|███████████████████████▉      | 98/123 [01:19<00:18,  1.35it/s][A
lr = 0.00000906, loss = 0.3723:  80%|███████████████████████▉      | 98/123 [01:20<00:18,  1.35it/s][A
lr = 0.00000906, loss = 0.3723:  80%|███████████████████████▉      | 98/123 [01:21<00:18,  1.35it/s][A
lr = 0.00000901, loss = 0.3721:  80%|███████████████████████▉      | 98/123 [01:22<00:18,  1.35it/s][A
lr = 0.00000901, loss = 0.3720:  80%|███████████████████████▉      | 98/123 [01:22<00:18,  1.35it/s][A
lr = 0.00000901, loss = 0.3720:  91%|██████████████████████████▍  | 112/123 [01:22<00:08,  1.35it/s][A
lr = 0.00000901, loss = 0.3718:  91%|██████████████████████████▍  | 112/123 [01:23<00:08,  1.35it/s][A
lr = 0.00000896, loss = 0.3718:  91%|██████████████████████████▍  | 112/123 [01:24<00:08,  1.35it/s][A
lr = 0.00000896, loss = 0.3719:  91%|██████████████████████████▍  | 112/123 [01:24<00:08,  1.35it/s][A
lr = 0.00000896, loss = 0.3717:  91%|██████████████████████████▍  | 112/123 [01:25<00:08,  1.35it/s][A
lr = 0.00000890, loss = 0.3718:  91%|██████████████████████████▍  | 112/123 [01:26<00:08,  1.35it/s][A
lr = 0.00000890, loss = 0.3717:  91%|██████████████████████████▍  | 112/123 [01:27<00:08,  1.35it/s][A
lr = 0.00000890, loss = 0.3717:  91%|██████████████████████████▍  | 112/123 [01:27<00:08,  1.35it/s][A
lr = 0.00000885, loss = 0.3717:  91%|██████████████████████████▍  | 112/123 [01:28<00:08,  1.35it/s][A
lr = 0.00000885, loss = 0.3716:  91%|██████████████████████████▍  | 112/123 [01:29<00:08,  1.35it/s][A
lr = 0.00000885, loss = 0.3716:  91%|██████████████████████████▍  | 112/123 [01:29<00:08,  1.35it/s][A
lr = 0.00000879, loss = 0.3716:  91%|██████████████████████████▍  | 112/123 [01:30<00:08,  1.35it/s][Alr = 0.00000879, loss = 0.3716: 100%|█████████████████████████████| 123/123 [01:30<00:00,  1.36it/s]
2021-03-13 21:41:18,119 - INFO - __main__ - Creating features from dataset file at /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/
2021-03-13 21:41:18,350 - INFO - cartography.classification.glue_utils - Writing example 0/9815
2021-03-13 21:41:22,596 - INFO - __main__ - Saving features into cached file /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/filtered/random/cartography_random_0.01/cache_20/cached_dev_matched_in_training_roberta-large_128_mnli
2021-03-13 21:41:23,941 - INFO - __main__ - ***** Running mnli in_training evaluation on dev_matched *****
2021-03-13 21:41:23,942 - INFO - __main__ -   Num examples = 9815
2021-03-13 21:41:23,942 - INFO - __main__ -   Batch size = 96

Evaluating:   0%|                                                           | 0/103 [00:00<?, ?it/s][A
Evaluating:  15%|███████▎                                          | 15/103 [00:10<00:59,  1.47it/s][A
Evaluating:  29%|██████████████▌                                   | 30/103 [00:20<00:49,  1.47it/s][A
Evaluating:  44%|█████████████████████▊                            | 45/103 [00:30<00:39,  1.47it/s][A
Evaluating:  58%|█████████████████████████████▏                    | 60/103 [00:40<00:29,  1.47it/s][A
Evaluating:  73%|████████████████████████████████████▍             | 75/103 [00:51<00:19,  1.47it/s][A
Evaluating:  87%|███████████████████████████████████████████▋      | 90/103 [01:01<00:08,  1.47it/s][AEvaluating: 100%|█████████████████████████████████████████████████| 103/103 [01:09<00:00,  1.48it/s]
2021-03-13 21:42:33,770 - INFO - cartography.selection.selection_utils - Dev_matched dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/dev_matched_dynamics/dynamics_epoch_0.jsonl
2021-03-13 21:42:33,775 - INFO - __main__ - ***** mnli dev_matched results in_training *****
2021-03-13 21:42:33,775 - INFO - __main__ - mnli dev_matched in_training acc = 0.3346
2021-03-13 21:42:33,779 - INFO - __main__ - ***** Write mnli dev_matched predictions in_training *****
2021-03-13 21:42:33,880 - INFO - __main__ - Creating features from dataset file at /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/
2021-03-13 21:42:34,079 - INFO - cartography.classification.glue_utils - Writing example 0/9832
2021-03-13 21:42:37,897 - INFO - __main__ - Saving features into cached file /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/filtered/random/cartography_random_0.01/cache_20/cached_dev_mismatched_in_training_roberta-large_128_mnli-mm
2021-03-13 21:42:39,084 - INFO - __main__ - ***** Running mnli-mm in_training evaluation on dev_mismatched *****
2021-03-13 21:42:39,085 - INFO - __main__ -   Num examples = 9832
2021-03-13 21:42:39,085 - INFO - __main__ -   Batch size = 96

Evaluating:   0%|                                                           | 0/103 [00:00<?, ?it/s][A
Evaluating:  15%|███████▎                                          | 15/103 [00:10<00:59,  1.47it/s][A
Evaluating:  29%|██████████████▌                                   | 30/103 [00:20<00:49,  1.47it/s][A
Evaluating:  44%|█████████████████████▊                            | 45/103 [00:30<00:39,  1.47it/s][A
Evaluating:  58%|█████████████████████████████▏                    | 60/103 [00:40<00:29,  1.47it/s][A
Evaluating:  73%|████████████████████████████████████▍             | 75/103 [00:51<00:19,  1.46it/s][A
Evaluating:  87%|███████████████████████████████████████████▋      | 90/103 [01:01<00:08,  1.46it/s][AEvaluating: 100%|█████████████████████████████████████████████████| 103/103 [01:09<00:00,  1.47it/s]
2021-03-13 21:43:49,066 - INFO - cartography.selection.selection_utils - Dev_mismatched dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/dev_mismatched_dynamics/dynamics_epoch_0.jsonl
2021-03-13 21:43:49,070 - INFO - __main__ - ***** mnli-mm dev_mismatched results in_training *****
2021-03-13 21:43:49,070 - INFO - __main__ - mnli-mm dev_mismatched in_training acc = 0.3326
2021-03-13 21:43:49,071 - INFO - __main__ - ***** Write mnli-mm dev_mismatched predictions in_training *****
2021-03-13 21:43:49,173 - INFO - transformers.configuration_utils - Configuration saved in /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/config.json
2021-03-13 21:43:54,241 - INFO - transformers.modeling_utils - Model weights saved in /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/pytorch_model.bin
2021-03-13 21:43:54,396 - INFO - __main__ - *** Found BEST model, and saved checkpoint. BEST dev performance : 0.3326 ***
2021-03-13 21:43:54,416 - INFO - cartography.selection.selection_utils - Training dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/training_dynamics/dynamics_epoch_0.jsonl
2021-03-13 21:43:54,418 - INFO - __main__ -   End of epoch : 0
2021-03-13 21:43:54,420 - INFO - __main__ -   epoch: 0.000000
2021-03-13 21:43:54,420 - INFO - __main__ -   train_acc: 0.332315
2021-03-13 21:43:54,420 - INFO - __main__ -   best_dev_performance: 0.332587
2021-03-13 21:43:54,421 - INFO - __main__ -   avg_batch_loss: 1.428401
2021-03-13 21:43:54,421 - INFO - __main__ -   learning_rate: 0.000009
train_epoch: 0 train_acc: 0.0000:  20%|██████                        | 1/5 [04:06<16:27, 246.90s/it]
Iteration:   0%|                                                            | 0/123 [00:00<?, ?it/s][Atrain_epoch: 1 train_acc: 0.3323:  20%|██████                        | 1/5 [04:06<16:27, 246.90s/it]
lr = 0.00000879, loss = 0.3709:   0%|                                       | 0/123 [00:00<?, ?it/s][A
lr = 0.00000879, loss = 0.3746:   0%|                                       | 0/123 [00:01<?, ?it/s][A
lr = 0.00000874, loss = 0.3695:   0%|                                       | 0/123 [00:02<?, ?it/s][A
lr = 0.00000874, loss = 0.3662:   0%|                                       | 0/123 [00:02<?, ?it/s][A
lr = 0.00000874, loss = 0.3661:   0%|                                       | 0/123 [00:03<?, ?it/s][A
lr = 0.00000869, loss = 0.3663:   0%|                                       | 0/123 [00:04<?, ?it/s][A
lr = 0.00000869, loss = 0.3664:   0%|                                       | 0/123 [00:05<?, ?it/s][A
lr = 0.00000869, loss = 0.3656:   0%|                                       | 0/123 [00:05<?, ?it/s][A
lr = 0.00000863, loss = 0.3652:   0%|                                       | 0/123 [00:06<?, ?it/s][A
lr = 0.00000863, loss = 0.3652:   0%|                                       | 0/123 [00:07<?, ?it/s][A
lr = 0.00000863, loss = 0.3655:   0%|                                       | 0/123 [00:07<?, ?it/s][A
lr = 0.00000858, loss = 0.3652:   0%|                                       | 0/123 [00:08<?, ?it/s][A
lr = 0.00000858, loss = 0.3659:   0%|                                       | 0/123 [00:09<?, ?it/s][A
lr = 0.00000858, loss = 0.3658:   0%|                                       | 0/123 [00:10<?, ?it/s][A
lr = 0.00000858, loss = 0.3658:  11%|███▍                          | 14/123 [00:10<01:18,  1.38it/s][A
lr = 0.00000853, loss = 0.3670:  11%|███▍                          | 14/123 [00:10<01:18,  1.38it/s][A
lr = 0.00000853, loss = 0.3672:  11%|███▍                          | 14/123 [00:11<01:18,  1.38it/s][A
lr = 0.00000853, loss = 0.3675:  11%|███▍                          | 14/123 [00:12<01:18,  1.38it/s][A
lr = 0.00000847, loss = 0.3674:  11%|███▍                          | 14/123 [00:13<01:18,  1.38it/s][A
lr = 0.00000847, loss = 0.3679:  11%|███▍                          | 14/123 [00:13<01:18,  1.38it/s][A
lr = 0.00000847, loss = 0.3678:  11%|███▍                          | 14/123 [00:14<01:18,  1.38it/s][A
lr = 0.00000842, loss = 0.3675:  11%|███▍                          | 14/123 [00:15<01:18,  1.38it/s][A
lr = 0.00000842, loss = 0.3676:  11%|███▍                          | 14/123 [00:15<01:18,  1.38it/s][A
lr = 0.00000842, loss = 0.3678:  11%|███▍                          | 14/123 [00:16<01:18,  1.38it/s][A
lr = 0.00000837, loss = 0.3675:  11%|███▍                          | 14/123 [00:17<01:18,  1.38it/s][A
lr = 0.00000837, loss = 0.3674:  11%|███▍                          | 14/123 [00:18<01:18,  1.38it/s][A
lr = 0.00000837, loss = 0.3672:  11%|███▍                          | 14/123 [00:18<01:18,  1.38it/s][A
lr = 0.00000831, loss = 0.3672:  11%|███▍                          | 14/123 [00:19<01:18,  1.38it/s][A
lr = 0.00000831, loss = 0.3674:  11%|███▍                          | 14/123 [00:20<01:18,  1.38it/s][A
lr = 0.00000831, loss = 0.3674:  23%|██████▊                       | 28/123 [00:20<01:08,  1.38it/s][A
lr = 0.00000831, loss = 0.3673:  23%|██████▊                       | 28/123 [00:21<01:08,  1.38it/s][A
lr = 0.00000826, loss = 0.3670:  23%|██████▊                       | 28/123 [00:21<01:08,  1.38it/s][A
lr = 0.00000826, loss = 0.3669:  23%|██████▊                       | 28/123 [00:22<01:08,  1.38it/s][A
lr = 0.00000826, loss = 0.3674:  23%|██████▊                       | 28/123 [00:23<01:08,  1.38it/s][A
lr = 0.00000820, loss = 0.3669:  23%|██████▊                       | 28/123 [00:23<01:08,  1.38it/s][A
lr = 0.00000820, loss = 0.3669:  23%|██████▊                       | 28/123 [00:24<01:08,  1.38it/s][A
lr = 0.00000820, loss = 0.3668:  23%|██████▊                       | 28/123 [00:25<01:08,  1.38it/s][A
lr = 0.00000815, loss = 0.3666:  23%|██████▊                       | 28/123 [00:26<01:08,  1.38it/s][A
lr = 0.00000815, loss = 0.3664:  23%|██████▊                       | 28/123 [00:26<01:08,  1.38it/s][A
lr = 0.00000815, loss = 0.3664:  23%|██████▊                       | 28/123 [00:27<01:08,  1.38it/s][A
lr = 0.00000810, loss = 0.3663:  23%|██████▊                       | 28/123 [00:28<01:08,  1.38it/s][A
lr = 0.00000810, loss = 0.3661:  23%|██████▊                       | 28/123 [00:29<01:08,  1.38it/s][A
lr = 0.00000810, loss = 0.3660:  23%|██████▊                       | 28/123 [00:29<01:08,  1.38it/s][A
lr = 0.00000804, loss = 0.3662:  23%|██████▊                       | 28/123 [00:30<01:08,  1.38it/s][A
lr = 0.00000804, loss = 0.3662:  34%|██████████▏                   | 42/123 [00:30<00:58,  1.38it/s][A
lr = 0.00000804, loss = 0.3662:  34%|██████████▏                   | 42/123 [00:31<00:58,  1.38it/s][A
lr = 0.00000804, loss = 0.3660:  34%|██████████▏                   | 42/123 [00:31<00:58,  1.38it/s][A
lr = 0.00000799, loss = 0.3661:  34%|██████████▏                   | 42/123 [00:32<00:58,  1.38it/s][A
lr = 0.00000799, loss = 0.3661:  34%|██████████▏                   | 42/123 [00:33<00:58,  1.38it/s][A
lr = 0.00000799, loss = 0.3662:  34%|██████████▏                   | 42/123 [00:34<00:58,  1.38it/s][A
lr = 0.00000794, loss = 0.3662:  34%|██████████▏                   | 42/123 [00:34<00:58,  1.38it/s][A
lr = 0.00000794, loss = 0.3659:  34%|██████████▏                   | 42/123 [00:35<00:58,  1.38it/s][A
lr = 0.00000794, loss = 0.3659:  34%|██████████▏                   | 42/123 [00:36<00:58,  1.38it/s][A
lr = 0.00000788, loss = 0.3658:  34%|██████████▏                   | 42/123 [00:37<00:58,  1.38it/s][A
lr = 0.00000788, loss = 0.3657:  34%|██████████▏                   | 42/123 [00:37<00:58,  1.38it/s][A
lr = 0.00000788, loss = 0.3660:  34%|██████████▏                   | 42/123 [00:38<00:58,  1.38it/s][A
lr = 0.00000783, loss = 0.3659:  34%|██████████▏                   | 42/123 [00:39<00:58,  1.38it/s][A
lr = 0.00000783, loss = 0.3659:  34%|██████████▏                   | 42/123 [00:39<00:58,  1.38it/s][A
lr = 0.00000783, loss = 0.3660:  34%|██████████▏                   | 42/123 [00:40<00:58,  1.38it/s][A
lr = 0.00000783, loss = 0.3660:  46%|█████████████▋                | 56/123 [00:40<00:48,  1.38it/s][A
lr = 0.00000778, loss = 0.3659:  46%|█████████████▋                | 56/123 [00:41<00:48,  1.38it/s][A
lr = 0.00000778, loss = 0.3657:  46%|█████████████▋                | 56/123 [00:42<00:48,  1.38it/s][A
lr = 0.00000778, loss = 0.3656:  46%|█████████████▋                | 56/123 [00:42<00:48,  1.38it/s][A
lr = 0.00000772, loss = 0.3656:  46%|█████████████▋                | 56/123 [00:43<00:48,  1.38it/s][A
lr = 0.00000772, loss = 0.3655:  46%|█████████████▋                | 56/123 [00:44<00:48,  1.38it/s][A
lr = 0.00000772, loss = 0.3655:  46%|█████████████▋                | 56/123 [00:45<00:48,  1.38it/s][A
lr = 0.00000767, loss = 0.3658:  46%|█████████████▋                | 56/123 [00:45<00:48,  1.38it/s][A
lr = 0.00000767, loss = 0.3657:  46%|█████████████▋                | 56/123 [00:46<00:48,  1.38it/s][A
lr = 0.00000767, loss = 0.3655:  46%|█████████████▋                | 56/123 [00:47<00:48,  1.38it/s][A
lr = 0.00000761, loss = 0.3653:  46%|█████████████▋                | 56/123 [00:48<00:48,  1.38it/s][A
lr = 0.00000761, loss = 0.3654:  46%|█████████████▋                | 56/123 [00:48<00:48,  1.38it/s][A
lr = 0.00000761, loss = 0.3654:  46%|█████████████▋                | 56/123 [00:49<00:48,  1.38it/s][A
lr = 0.00000756, loss = 0.3652:  46%|█████████████▋                | 56/123 [00:50<00:48,  1.38it/s][A
lr = 0.00000756, loss = 0.3649:  46%|█████████████▋                | 56/123 [00:50<00:48,  1.38it/s][A
lr = 0.00000756, loss = 0.3649:  57%|█████████████████             | 70/123 [00:50<00:38,  1.37it/s][A
lr = 0.00000756, loss = 0.3646:  57%|█████████████████             | 70/123 [00:51<00:38,  1.37it/s][A
lr = 0.00000751, loss = 0.3646:  57%|█████████████████             | 70/123 [00:52<00:38,  1.37it/s][A
lr = 0.00000751, loss = 0.3642:  57%|█████████████████             | 70/123 [00:53<00:38,  1.37it/s][A
lr = 0.00000751, loss = 0.3638:  57%|█████████████████             | 70/123 [00:53<00:38,  1.37it/s][A
lr = 0.00000745, loss = 0.3633:  57%|█████████████████             | 70/123 [00:54<00:38,  1.37it/s][A
lr = 0.00000745, loss = 0.3629:  57%|█████████████████             | 70/123 [00:55<00:38,  1.37it/s][A
lr = 0.00000745, loss = 0.3631:  57%|█████████████████             | 70/123 [00:56<00:38,  1.37it/s][A
lr = 0.00000740, loss = 0.3629:  57%|█████████████████             | 70/123 [00:56<00:38,  1.37it/s][A
lr = 0.00000740, loss = 0.3629:  57%|█████████████████             | 70/123 [00:57<00:38,  1.37it/s][A
lr = 0.00000740, loss = 0.3630:  57%|█████████████████             | 70/123 [00:58<00:38,  1.37it/s][A
lr = 0.00000735, loss = 0.3626:  57%|█████████████████             | 70/123 [00:58<00:38,  1.37it/s][A
lr = 0.00000735, loss = 0.3627:  57%|█████████████████             | 70/123 [00:59<00:38,  1.37it/s][A
lr = 0.00000735, loss = 0.3622:  57%|█████████████████             | 70/123 [01:00<00:38,  1.37it/s][A
lr = 0.00000729, loss = 0.3627:  57%|█████████████████             | 70/123 [01:01<00:38,  1.37it/s][A
lr = 0.00000729, loss = 0.3627:  68%|████████████████████▍         | 84/123 [01:01<00:28,  1.37it/s][A
lr = 0.00000729, loss = 0.3622:  68%|████████████████████▍         | 84/123 [01:01<00:28,  1.37it/s][A
lr = 0.00000729, loss = 0.3618:  68%|████████████████████▍         | 84/123 [01:02<00:28,  1.37it/s][A
lr = 0.00000724, loss = 0.3615:  68%|████████████████████▍         | 84/123 [01:03<00:28,  1.37it/s][A
lr = 0.00000724, loss = 0.3614:  68%|████████████████████▍         | 84/123 [01:04<00:28,  1.37it/s][A
lr = 0.00000724, loss = 0.3615:  68%|████████████████████▍         | 84/123 [01:04<00:28,  1.37it/s][A
lr = 0.00000719, loss = 0.3607:  68%|████████████████████▍         | 84/123 [01:05<00:28,  1.37it/s][A
lr = 0.00000719, loss = 0.3606:  68%|████████████████████▍         | 84/123 [01:06<00:28,  1.37it/s][A
lr = 0.00000719, loss = 0.3607:  68%|████████████████████▍         | 84/123 [01:06<00:28,  1.37it/s][A
lr = 0.00000713, loss = 0.3608:  68%|████████████████████▍         | 84/123 [01:07<00:28,  1.37it/s][A
lr = 0.00000713, loss = 0.3605:  68%|████████████████████▍         | 84/123 [01:08<00:28,  1.37it/s][A
lr = 0.00000713, loss = 0.3601:  68%|████████████████████▍         | 84/123 [01:09<00:28,  1.37it/s][A
lr = 0.00000708, loss = 0.3598:  68%|████████████████████▍         | 84/123 [01:09<00:28,  1.37it/s][A
lr = 0.00000708, loss = 0.3594:  68%|████████████████████▍         | 84/123 [01:10<00:28,  1.37it/s][A
lr = 0.00000708, loss = 0.3593:  68%|████████████████████▍         | 84/123 [01:11<00:28,  1.37it/s][A
lr = 0.00000708, loss = 0.3593:  80%|███████████████████████▉      | 98/123 [01:11<00:18,  1.37it/s][A
lr = 0.00000702, loss = 0.3593:  80%|███████████████████████▉      | 98/123 [01:12<00:18,  1.37it/s][A
lr = 0.00000702, loss = 0.3591:  80%|███████████████████████▉      | 98/123 [01:12<00:18,  1.37it/s][A
lr = 0.00000702, loss = 0.3588:  80%|███████████████████████▉      | 98/123 [01:13<00:18,  1.37it/s][A
lr = 0.00000697, loss = 0.3587:  80%|███████████████████████▉      | 98/123 [01:14<00:18,  1.37it/s][A
lr = 0.00000697, loss = 0.3586:  80%|███████████████████████▉      | 98/123 [01:15<00:18,  1.37it/s][A
lr = 0.00000697, loss = 0.3584:  80%|███████████████████████▉      | 98/123 [01:15<00:18,  1.37it/s][A
lr = 0.00000692, loss = 0.3581:  80%|███████████████████████▉      | 98/123 [01:16<00:18,  1.37it/s][A
lr = 0.00000692, loss = 0.3578:  80%|███████████████████████▉      | 98/123 [01:17<00:18,  1.37it/s][A
lr = 0.00000692, loss = 0.3576:  80%|███████████████████████▉      | 98/123 [01:17<00:18,  1.37it/s][A
lr = 0.00000686, loss = 0.3577:  80%|███████████████████████▉      | 98/123 [01:18<00:18,  1.37it/s][A
lr = 0.00000686, loss = 0.3577:  80%|███████████████████████▉      | 98/123 [01:19<00:18,  1.37it/s][A
lr = 0.00000686, loss = 0.3574:  80%|███████████████████████▉      | 98/123 [01:20<00:18,  1.37it/s][A
lr = 0.00000681, loss = 0.3572:  80%|███████████████████████▉      | 98/123 [01:20<00:18,  1.37it/s][A
lr = 0.00000681, loss = 0.3574:  80%|███████████████████████▉      | 98/123 [01:21<00:18,  1.37it/s][A
lr = 0.00000681, loss = 0.3574:  91%|██████████████████████████▍  | 112/123 [01:21<00:08,  1.37it/s][A
lr = 0.00000681, loss = 0.3571:  91%|██████████████████████████▍  | 112/123 [01:22<00:08,  1.37it/s][A
lr = 0.00000676, loss = 0.3570:  91%|██████████████████████████▍  | 112/123 [01:23<00:08,  1.37it/s][A
lr = 0.00000676, loss = 0.3566:  91%|██████████████████████████▍  | 112/123 [01:23<00:08,  1.37it/s][A
lr = 0.00000676, loss = 0.3566:  91%|██████████████████████████▍  | 112/123 [01:24<00:08,  1.37it/s][A
lr = 0.00000670, loss = 0.3566:  91%|██████████████████████████▍  | 112/123 [01:25<00:08,  1.37it/s][A
lr = 0.00000670, loss = 0.3563:  91%|██████████████████████████▍  | 112/123 [01:25<00:08,  1.37it/s][A
lr = 0.00000670, loss = 0.3562:  91%|██████████████████████████▍  | 112/123 [01:26<00:08,  1.37it/s][A
lr = 0.00000665, loss = 0.3561:  91%|██████████████████████████▍  | 112/123 [01:27<00:08,  1.37it/s][A
lr = 0.00000665, loss = 0.3561:  91%|██████████████████████████▍  | 112/123 [01:28<00:08,  1.37it/s][A
lr = 0.00000665, loss = 0.3559:  91%|██████████████████████████▍  | 112/123 [01:28<00:08,  1.37it/s][A
lr = 0.00000660, loss = 0.3557:  91%|██████████████████████████▍  | 112/123 [01:29<00:08,  1.37it/s][Alr = 0.00000660, loss = 0.3557: 100%|█████████████████████████████| 123/123 [01:29<00:00,  1.37it/s]
2021-03-13 21:45:23,918 - INFO - __main__ - Loading features from cached file /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/filtered/random/cartography_random_0.01/cache_20/cached_dev_matched_in_training_roberta-large_128_mnli
2021-03-13 21:45:24,577 - INFO - __main__ - ***** Running mnli in_training evaluation on dev_matched *****
2021-03-13 21:45:24,578 - INFO - __main__ -   Num examples = 9815
2021-03-13 21:45:24,578 - INFO - __main__ -   Batch size = 96

Evaluating:   0%|                                                           | 0/103 [00:00<?, ?it/s][A
Evaluating:  15%|███████▎                                          | 15/103 [00:10<01:00,  1.47it/s][A
Evaluating:  29%|██████████████▌                                   | 30/103 [00:20<00:49,  1.47it/s][A
Evaluating:  44%|█████████████████████▊                            | 45/103 [00:30<00:39,  1.46it/s][A
Evaluating:  58%|█████████████████████████████▏                    | 60/103 [00:40<00:29,  1.46it/s][A
Evaluating:  73%|████████████████████████████████████▍             | 75/103 [00:51<00:19,  1.46it/s][A
Evaluating:  87%|███████████████████████████████████████████▋      | 90/103 [01:01<00:08,  1.46it/s][AEvaluating: 100%|█████████████████████████████████████████████████| 103/103 [01:09<00:00,  1.47it/s]
2021-03-13 21:46:34,462 - INFO - cartography.selection.selection_utils - Dev_matched dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/dev_matched_dynamics/dynamics_epoch_1.jsonl
2021-03-13 21:46:34,466 - INFO - __main__ - ***** mnli dev_matched results in_training *****
2021-03-13 21:46:34,467 - INFO - __main__ - mnli dev_matched in_training acc = 0.5167
2021-03-13 21:46:34,467 - INFO - __main__ - ***** Write mnli dev_matched predictions in_training *****
2021-03-13 21:46:34,642 - INFO - __main__ - Loading features from cached file /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/filtered/random/cartography_random_0.01/cache_20/cached_dev_mismatched_in_training_roberta-large_128_mnli-mm
2021-03-13 21:46:35,199 - INFO - __main__ - ***** Running mnli-mm in_training evaluation on dev_mismatched *****
2021-03-13 21:46:35,201 - INFO - __main__ -   Num examples = 9832
2021-03-13 21:46:35,201 - INFO - __main__ -   Batch size = 96

Evaluating:   0%|                                                           | 0/103 [00:00<?, ?it/s][A
Evaluating:  15%|███████▎                                          | 15/103 [00:10<01:00,  1.46it/s][A
Evaluating:  29%|██████████████▌                                   | 30/103 [00:20<00:49,  1.46it/s][A
Evaluating:  44%|█████████████████████▊                            | 45/103 [00:30<00:39,  1.46it/s][A
Evaluating:  58%|█████████████████████████████▏                    | 60/103 [00:41<00:29,  1.46it/s][A
Evaluating:  73%|████████████████████████████████████▍             | 75/103 [00:51<00:19,  1.46it/s][A
Evaluating:  87%|███████████████████████████████████████████▋      | 90/103 [01:01<00:08,  1.46it/s][AEvaluating: 100%|█████████████████████████████████████████████████| 103/103 [01:10<00:00,  1.47it/s]
2021-03-13 21:47:45,272 - INFO - cartography.selection.selection_utils - Dev_mismatched dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/dev_mismatched_dynamics/dynamics_epoch_1.jsonl
2021-03-13 21:47:45,276 - INFO - __main__ - ***** mnli-mm dev_mismatched results in_training *****
2021-03-13 21:47:45,276 - INFO - __main__ - mnli-mm dev_mismatched in_training acc = 0.5311
2021-03-13 21:47:45,277 - INFO - __main__ - ***** Write mnli-mm dev_mismatched predictions in_training *****
2021-03-13 21:47:45,450 - INFO - transformers.configuration_utils - Configuration saved in /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/config.json
2021-03-13 21:47:50,477 - INFO - transformers.modeling_utils - Model weights saved in /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/pytorch_model.bin
2021-03-13 21:47:50,551 - INFO - __main__ - *** Found BEST model, and saved checkpoint. BEST dev performance : 0.5311 ***
2021-03-13 21:47:50,569 - INFO - cartography.selection.selection_utils - Training dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/training_dynamics/dynamics_epoch_1.jsonl
2021-03-13 21:47:50,571 - INFO - __main__ -   End of epoch : 1
2021-03-13 21:47:50,571 - INFO - __main__ -   epoch: 1.000000
2021-03-13 21:47:50,571 - INFO - __main__ -   train_acc: 0.412783
2021-03-13 21:47:50,572 - INFO - __main__ -   best_dev_performance: 0.531123
2021-03-13 21:47:50,572 - INFO - __main__ -   avg_batch_loss: 1.367300
2021-03-13 21:47:50,572 - INFO - __main__ -   learning_rate: 0.000007
train_epoch: 1 train_acc: 0.3323:  40%|████████████                  | 2/5 [08:03<12:11, 243.68s/it]
Iteration:   0%|                                                            | 0/123 [00:00<?, ?it/s][Atrain_epoch: 2 train_acc: 0.4128:  40%|████████████                  | 2/5 [08:03<12:11, 243.68s/it]
lr = 0.00000660, loss = 0.3325:   0%|                                       | 0/123 [00:00<?, ?it/s][A
lr = 0.00000660, loss = 0.3295:   0%|                                       | 0/123 [00:01<?, ?it/s][A
lr = 0.00000654, loss = 0.3401:   0%|                                       | 0/123 [00:02<?, ?it/s][A
lr = 0.00000654, loss = 0.3399:   0%|                                       | 0/123 [00:02<?, ?it/s][A
lr = 0.00000654, loss = 0.3377:   0%|                                       | 0/123 [00:03<?, ?it/s][A
lr = 0.00000649, loss = 0.3378:   0%|                                       | 0/123 [00:04<?, ?it/s][A
lr = 0.00000649, loss = 0.3406:   0%|                                       | 0/123 [00:05<?, ?it/s][A
lr = 0.00000649, loss = 0.3423:   0%|                                       | 0/123 [00:05<?, ?it/s][A
lr = 0.00000643, loss = 0.3402:   0%|                                       | 0/123 [00:06<?, ?it/s][A
lr = 0.00000643, loss = 0.3380:   0%|                                       | 0/123 [00:07<?, ?it/s][A
lr = 0.00000643, loss = 0.3393:   0%|                                       | 0/123 [00:07<?, ?it/s][A
lr = 0.00000638, loss = 0.3403:   0%|                                       | 0/123 [00:08<?, ?it/s][A
lr = 0.00000638, loss = 0.3428:   0%|                                       | 0/123 [00:09<?, ?it/s][A
lr = 0.00000638, loss = 0.3410:   0%|                                       | 0/123 [00:10<?, ?it/s][A
lr = 0.00000638, loss = 0.3410:  11%|███▍                          | 14/123 [00:10<01:18,  1.38it/s][A
lr = 0.00000633, loss = 0.3395:  11%|███▍                          | 14/123 [00:10<01:18,  1.38it/s][A
lr = 0.00000633, loss = 0.3395:  11%|███▍                          | 14/123 [00:11<01:18,  1.38it/s][A
lr = 0.00000633, loss = 0.3387:  11%|███▍                          | 14/123 [00:12<01:18,  1.38it/s][A
lr = 0.00000627, loss = 0.3374:  11%|███▍                          | 14/123 [00:13<01:18,  1.38it/s][A
lr = 0.00000627, loss = 0.3366:  11%|███▍                          | 14/123 [00:13<01:18,  1.38it/s][A
lr = 0.00000627, loss = 0.3351:  11%|███▍                          | 14/123 [00:14<01:18,  1.38it/s][A
lr = 0.00000622, loss = 0.3338:  11%|███▍                          | 14/123 [00:15<01:18,  1.38it/s][A
lr = 0.00000622, loss = 0.3334:  11%|███▍                          | 14/123 [00:15<01:18,  1.38it/s][A
lr = 0.00000622, loss = 0.3317:  11%|███▍                          | 14/123 [00:16<01:18,  1.38it/s][A
lr = 0.00000617, loss = 0.3323:  11%|███▍                          | 14/123 [00:17<01:18,  1.38it/s][A
lr = 0.00000617, loss = 0.3304:  11%|███▍                          | 14/123 [00:18<01:18,  1.38it/s][A
lr = 0.00000617, loss = 0.3296:  11%|███▍                          | 14/123 [00:18<01:18,  1.38it/s][A
lr = 0.00000611, loss = 0.3304:  11%|███▍                          | 14/123 [00:19<01:18,  1.38it/s][A
lr = 0.00000611, loss = 0.3282:  11%|███▍                          | 14/123 [00:20<01:18,  1.38it/s][A
lr = 0.00000611, loss = 0.3282:  23%|██████▊                       | 28/123 [00:20<01:08,  1.38it/s][A
lr = 0.00000611, loss = 0.3273:  23%|██████▊                       | 28/123 [00:21<01:08,  1.38it/s][A
lr = 0.00000606, loss = 0.3270:  23%|██████▊                       | 28/123 [00:21<01:08,  1.38it/s][A
lr = 0.00000606, loss = 0.3261:  23%|██████▊                       | 28/123 [00:22<01:08,  1.38it/s][A
lr = 0.00000606, loss = 0.3251:  23%|██████▊                       | 28/123 [00:23<01:08,  1.38it/s][A
lr = 0.00000601, loss = 0.3238:  23%|██████▊                       | 28/123 [00:24<01:08,  1.38it/s][A
lr = 0.00000601, loss = 0.3235:  23%|██████▊                       | 28/123 [00:24<01:08,  1.38it/s][A
lr = 0.00000601, loss = 0.3233:  23%|██████▊                       | 28/123 [00:25<01:08,  1.38it/s][A
lr = 0.00000595, loss = 0.3237:  23%|██████▊                       | 28/123 [00:26<01:08,  1.38it/s][A
lr = 0.00000595, loss = 0.3222:  23%|██████▊                       | 28/123 [00:26<01:08,  1.38it/s][A
lr = 0.00000595, loss = 0.3207:  23%|██████▊                       | 28/123 [00:27<01:08,  1.38it/s][A
lr = 0.00000590, loss = 0.3200:  23%|██████▊                       | 28/123 [00:28<01:08,  1.38it/s][A
lr = 0.00000590, loss = 0.3199:  23%|██████▊                       | 28/123 [00:29<01:08,  1.38it/s][A
lr = 0.00000590, loss = 0.3194:  23%|██████▊                       | 28/123 [00:29<01:08,  1.38it/s][A
lr = 0.00000585, loss = 0.3194:  23%|██████▊                       | 28/123 [00:30<01:08,  1.38it/s][A
lr = 0.00000585, loss = 0.3194:  34%|██████████▏                   | 42/123 [00:30<00:58,  1.38it/s][A
lr = 0.00000585, loss = 0.3187:  34%|██████████▏                   | 42/123 [00:31<00:58,  1.38it/s][A
lr = 0.00000585, loss = 0.3200:  34%|██████████▏                   | 42/123 [00:31<00:58,  1.38it/s][A
lr = 0.00000579, loss = 0.3192:  34%|██████████▏                   | 42/123 [00:32<00:58,  1.38it/s][A
lr = 0.00000579, loss = 0.3193:  34%|██████████▏                   | 42/123 [00:33<00:58,  1.38it/s][A
lr = 0.00000579, loss = 0.3177:  34%|██████████▏                   | 42/123 [00:34<00:58,  1.38it/s][A
lr = 0.00000574, loss = 0.3175:  34%|██████████▏                   | 42/123 [00:34<00:58,  1.38it/s][A
lr = 0.00000574, loss = 0.3176:  34%|██████████▏                   | 42/123 [00:35<00:58,  1.38it/s][A
lr = 0.00000574, loss = 0.3178:  34%|██████████▏                   | 42/123 [00:36<00:58,  1.38it/s][A
lr = 0.00000568, loss = 0.3176:  34%|██████████▏                   | 42/123 [00:37<00:58,  1.38it/s][A
lr = 0.00000568, loss = 0.3179:  34%|██████████▏                   | 42/123 [00:37<00:58,  1.38it/s][A
lr = 0.00000568, loss = 0.3174:  34%|██████████▏                   | 42/123 [00:38<00:58,  1.38it/s][A
lr = 0.00000563, loss = 0.3173:  34%|██████████▏                   | 42/123 [00:39<00:58,  1.38it/s][A
lr = 0.00000563, loss = 0.3166:  34%|██████████▏                   | 42/123 [00:40<00:58,  1.38it/s][A
lr = 0.00000563, loss = 0.3161:  34%|██████████▏                   | 42/123 [00:40<00:58,  1.38it/s][A
lr = 0.00000563, loss = 0.3161:  46%|█████████████▋                | 56/123 [00:40<00:48,  1.38it/s][A
lr = 0.00000558, loss = 0.3162:  46%|█████████████▋                | 56/123 [00:41<00:48,  1.38it/s][A
lr = 0.00000558, loss = 0.3156:  46%|█████████████▋                | 56/123 [00:42<00:48,  1.38it/s][A
lr = 0.00000558, loss = 0.3152:  46%|█████████████▋                | 56/123 [00:42<00:48,  1.38it/s][A
lr = 0.00000552, loss = 0.3144:  46%|█████████████▋                | 56/123 [00:43<00:48,  1.38it/s][A
lr = 0.00000552, loss = 0.3131:  46%|█████████████▋                | 56/123 [00:44<00:48,  1.38it/s][A
lr = 0.00000552, loss = 0.3122:  46%|█████████████▋                | 56/123 [00:45<00:48,  1.38it/s][A
lr = 0.00000547, loss = 0.3119:  46%|█████████████▋                | 56/123 [00:45<00:48,  1.38it/s][A
lr = 0.00000547, loss = 0.3109:  46%|█████████████▋                | 56/123 [00:46<00:48,  1.38it/s][A
lr = 0.00000547, loss = 0.3104:  46%|█████████████▋                | 56/123 [00:47<00:48,  1.38it/s][A
lr = 0.00000542, loss = 0.3097:  46%|█████████████▋                | 56/123 [00:48<00:48,  1.38it/s][A
lr = 0.00000542, loss = 0.3083:  46%|█████████████▋                | 56/123 [00:48<00:48,  1.38it/s][A
lr = 0.00000542, loss = 0.3079:  46%|█████████████▋                | 56/123 [00:49<00:48,  1.38it/s][A
lr = 0.00000536, loss = 0.3070:  46%|█████████████▋                | 56/123 [00:50<00:48,  1.38it/s][A
lr = 0.00000536, loss = 0.3063:  46%|█████████████▋                | 56/123 [00:50<00:48,  1.38it/s][A
lr = 0.00000536, loss = 0.3063:  57%|█████████████████             | 70/123 [00:50<00:38,  1.37it/s][A
lr = 0.00000536, loss = 0.3054:  57%|█████████████████             | 70/123 [00:51<00:38,  1.37it/s][A
lr = 0.00000531, loss = 0.3046:  57%|█████████████████             | 70/123 [00:52<00:38,  1.37it/s][A
lr = 0.00000531, loss = 0.3045:  57%|█████████████████             | 70/123 [00:53<00:38,  1.37it/s][A
lr = 0.00000531, loss = 0.3033:  57%|█████████████████             | 70/123 [00:53<00:38,  1.37it/s][A
lr = 0.00000526, loss = 0.3023:  57%|█████████████████             | 70/123 [00:54<00:38,  1.37it/s][A
lr = 0.00000526, loss = 0.3018:  57%|█████████████████             | 70/123 [00:55<00:38,  1.37it/s][A
lr = 0.00000526, loss = 0.3006:  57%|█████████████████             | 70/123 [00:56<00:38,  1.37it/s][A
lr = 0.00000520, loss = 0.2995:  57%|█████████████████             | 70/123 [00:56<00:38,  1.37it/s][A
lr = 0.00000520, loss = 0.2990:  57%|█████████████████             | 70/123 [00:57<00:38,  1.37it/s][A
lr = 0.00000520, loss = 0.2982:  57%|█████████████████             | 70/123 [00:58<00:38,  1.37it/s][A
lr = 0.00000515, loss = 0.2972:  57%|█████████████████             | 70/123 [00:59<00:38,  1.37it/s][A
lr = 0.00000515, loss = 0.2961:  57%|█████████████████             | 70/123 [00:59<00:38,  1.37it/s][A
lr = 0.00000515, loss = 0.2950:  57%|█████████████████             | 70/123 [01:00<00:38,  1.37it/s][A
lr = 0.00000509, loss = 0.2943:  57%|█████████████████             | 70/123 [01:01<00:38,  1.37it/s][A
lr = 0.00000509, loss = 0.2943:  68%|████████████████████▍         | 84/123 [01:01<00:28,  1.37it/s][A
lr = 0.00000509, loss = 0.2948:  68%|████████████████████▍         | 84/123 [01:01<00:28,  1.37it/s][A
lr = 0.00000509, loss = 0.2942:  68%|████████████████████▍         | 84/123 [01:02<00:28,  1.37it/s][A
lr = 0.00000504, loss = 0.2935:  68%|████████████████████▍         | 84/123 [01:03<00:28,  1.37it/s][A
lr = 0.00000504, loss = 0.2926:  68%|████████████████████▍         | 84/123 [01:04<00:28,  1.37it/s][A
lr = 0.00000504, loss = 0.2918:  68%|████████████████████▍         | 84/123 [01:04<00:28,  1.37it/s][A
lr = 0.00000499, loss = 0.2914:  68%|████████████████████▍         | 84/123 [01:05<00:28,  1.37it/s][A
lr = 0.00000499, loss = 0.2905:  68%|████████████████████▍         | 84/123 [01:06<00:28,  1.37it/s][A
lr = 0.00000499, loss = 0.2902:  68%|████████████████████▍         | 84/123 [01:07<00:28,  1.37it/s][A
lr = 0.00000493, loss = 0.2896:  68%|████████████████████▍         | 84/123 [01:07<00:28,  1.37it/s][A
lr = 0.00000493, loss = 0.2889:  68%|████████████████████▍         | 84/123 [01:08<00:28,  1.37it/s][A
lr = 0.00000493, loss = 0.2884:  68%|████████████████████▍         | 84/123 [01:09<00:28,  1.37it/s][A
lr = 0.00000488, loss = 0.2876:  68%|████████████████████▍         | 84/123 [01:10<00:28,  1.37it/s][A
lr = 0.00000488, loss = 0.2871:  68%|████████████████████▍         | 84/123 [01:10<00:28,  1.37it/s][A
lr = 0.00000488, loss = 0.2855:  68%|████████████████████▍         | 84/123 [01:11<00:28,  1.37it/s][A
lr = 0.00000488, loss = 0.2855:  80%|███████████████████████▉      | 98/123 [01:11<00:18,  1.37it/s][A
lr = 0.00000483, loss = 0.2856:  80%|███████████████████████▉      | 98/123 [01:12<00:18,  1.37it/s][A
lr = 0.00000483, loss = 0.2855:  80%|███████████████████████▉      | 98/123 [01:12<00:18,  1.37it/s][A
lr = 0.00000483, loss = 0.2859:  80%|███████████████████████▉      | 98/123 [01:13<00:18,  1.37it/s][A
lr = 0.00000477, loss = 0.2852:  80%|███████████████████████▉      | 98/123 [01:14<00:18,  1.37it/s][A
lr = 0.00000477, loss = 0.2842:  80%|███████████████████████▉      | 98/123 [01:15<00:18,  1.37it/s][A
lr = 0.00000477, loss = 0.2837:  80%|███████████████████████▉      | 98/123 [01:15<00:18,  1.37it/s][A
lr = 0.00000472, loss = 0.2832:  80%|███████████████████████▉      | 98/123 [01:16<00:18,  1.37it/s][A
lr = 0.00000472, loss = 0.2825:  80%|███████████████████████▉      | 98/123 [01:17<00:18,  1.37it/s][A
lr = 0.00000472, loss = 0.2818:  80%|███████████████████████▉      | 98/123 [01:17<00:18,  1.37it/s][A
lr = 0.00000467, loss = 0.2825:  80%|███████████████████████▉      | 98/123 [01:18<00:18,  1.37it/s][A
lr = 0.00000467, loss = 0.2825:  80%|███████████████████████▉      | 98/123 [01:19<00:18,  1.37it/s][A
lr = 0.00000467, loss = 0.2818:  80%|███████████████████████▉      | 98/123 [01:20<00:18,  1.37it/s][A
lr = 0.00000461, loss = 0.2811:  80%|███████████████████████▉      | 98/123 [01:20<00:18,  1.37it/s][A
lr = 0.00000461, loss = 0.2809:  80%|███████████████████████▉      | 98/123 [01:21<00:18,  1.37it/s][A
lr = 0.00000461, loss = 0.2809:  91%|██████████████████████████▍  | 112/123 [01:21<00:08,  1.37it/s][A
lr = 0.00000461, loss = 0.2805:  91%|██████████████████████████▍  | 112/123 [01:22<00:08,  1.37it/s][A
lr = 0.00000456, loss = 0.2792:  91%|██████████████████████████▍  | 112/123 [01:23<00:08,  1.37it/s][A
lr = 0.00000456, loss = 0.2782:  91%|██████████████████████████▍  | 112/123 [01:23<00:08,  1.37it/s][A
lr = 0.00000456, loss = 0.2780:  91%|██████████████████████████▍  | 112/123 [01:24<00:08,  1.37it/s][A
lr = 0.00000450, loss = 0.2776:  91%|██████████████████████████▍  | 112/123 [01:25<00:08,  1.37it/s][A
lr = 0.00000450, loss = 0.2773:  91%|██████████████████████████▍  | 112/123 [01:26<00:08,  1.37it/s][A
lr = 0.00000450, loss = 0.2770:  91%|██████████████████████████▍  | 112/123 [01:26<00:08,  1.37it/s][A
lr = 0.00000445, loss = 0.2769:  91%|██████████████████████████▍  | 112/123 [01:27<00:08,  1.37it/s][A
lr = 0.00000445, loss = 0.2765:  91%|██████████████████████████▍  | 112/123 [01:28<00:08,  1.37it/s][A
lr = 0.00000445, loss = 0.2763:  91%|██████████████████████████▍  | 112/123 [01:28<00:08,  1.37it/s][A
lr = 0.00000440, loss = 0.2764:  91%|██████████████████████████▍  | 112/123 [01:29<00:08,  1.37it/s][Alr = 0.00000440, loss = 0.2764: 100%|█████████████████████████████| 123/123 [01:29<00:00,  1.37it/s]
2021-03-13 21:49:20,116 - INFO - __main__ - Loading features from cached file /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/filtered/random/cartography_random_0.01/cache_20/cached_dev_matched_in_training_roberta-large_128_mnli
2021-03-13 21:49:20,853 - INFO - __main__ - ***** Running mnli in_training evaluation on dev_matched *****
2021-03-13 21:49:20,854 - INFO - __main__ -   Num examples = 9815
2021-03-13 21:49:20,854 - INFO - __main__ -   Batch size = 96

Evaluating:   0%|                                                           | 0/103 [00:00<?, ?it/s][A
Evaluating:  15%|███████▎                                          | 15/103 [00:10<01:00,  1.47it/s][A
Evaluating:  29%|██████████████▌                                   | 30/103 [00:20<00:49,  1.47it/s][A
Evaluating:  44%|█████████████████████▊                            | 45/103 [00:30<00:39,  1.46it/s][A
Evaluating:  58%|█████████████████████████████▏                    | 60/103 [00:40<00:29,  1.46it/s][A
Evaluating:  73%|████████████████████████████████████▍             | 75/103 [00:51<00:19,  1.46it/s][A
Evaluating:  87%|███████████████████████████████████████████▋      | 90/103 [01:01<00:08,  1.46it/s][AEvaluating: 100%|█████████████████████████████████████████████████| 103/103 [01:09<00:00,  1.47it/s]
2021-03-13 21:50:30,731 - INFO - cartography.selection.selection_utils - Dev_matched dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/dev_matched_dynamics/dynamics_epoch_2.jsonl
2021-03-13 21:50:30,734 - INFO - __main__ - ***** mnli dev_matched results in_training *****
2021-03-13 21:50:30,734 - INFO - __main__ - mnli dev_matched in_training acc = 0.7493
2021-03-13 21:50:30,734 - INFO - __main__ - ***** Write mnli dev_matched predictions in_training *****
2021-03-13 21:50:30,830 - INFO - __main__ - Loading features from cached file /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/filtered/random/cartography_random_0.01/cache_20/cached_dev_mismatched_in_training_roberta-large_128_mnli-mm
2021-03-13 21:50:31,431 - INFO - __main__ - ***** Running mnli-mm in_training evaluation on dev_mismatched *****
2021-03-13 21:50:31,433 - INFO - __main__ -   Num examples = 9832
2021-03-13 21:50:31,433 - INFO - __main__ -   Batch size = 96

Evaluating:   0%|                                                           | 0/103 [00:00<?, ?it/s][A
Evaluating:  15%|███████▎                                          | 15/103 [00:10<01:00,  1.46it/s][A
Evaluating:  29%|██████████████▌                                   | 30/103 [00:20<00:49,  1.46it/s][A
Evaluating:  44%|█████████████████████▊                            | 45/103 [00:30<00:39,  1.46it/s][A
Evaluating:  58%|█████████████████████████████▏                    | 60/103 [00:41<00:29,  1.46it/s][A
Evaluating:  73%|████████████████████████████████████▍             | 75/103 [00:51<00:19,  1.46it/s][A
Evaluating:  87%|███████████████████████████████████████████▋      | 90/103 [01:01<00:08,  1.46it/s][AEvaluating: 100%|█████████████████████████████████████████████████| 103/103 [01:10<00:00,  1.47it/s]
2021-03-13 21:51:41,507 - INFO - cartography.selection.selection_utils - Dev_mismatched dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/dev_mismatched_dynamics/dynamics_epoch_2.jsonl
2021-03-13 21:51:41,510 - INFO - __main__ - ***** mnli-mm dev_mismatched results in_training *****
2021-03-13 21:51:41,510 - INFO - __main__ - mnli-mm dev_mismatched in_training acc = 0.7665
2021-03-13 21:51:41,511 - INFO - __main__ - ***** Write mnli-mm dev_mismatched predictions in_training *****
2021-03-13 21:51:41,609 - INFO - transformers.configuration_utils - Configuration saved in /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/config.json
2021-03-13 21:51:46,421 - INFO - transformers.modeling_utils - Model weights saved in /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/pytorch_model.bin
2021-03-13 21:51:46,566 - INFO - __main__ - *** Found BEST model, and saved checkpoint. BEST dev performance : 0.7665 ***
2021-03-13 21:51:46,584 - INFO - cartography.selection.selection_utils - Training dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/training_dynamics/dynamics_epoch_2.jsonl
2021-03-13 21:51:46,586 - INFO - __main__ -   End of epoch : 2
2021-03-13 21:51:46,587 - INFO - __main__ -   epoch: 2.000000
2021-03-13 21:51:46,587 - INFO - __main__ -   train_acc: 0.652916
2021-03-13 21:51:46,588 - INFO - __main__ -   best_dev_performance: 0.766477
2021-03-13 21:51:46,588 - INFO - __main__ -   avg_batch_loss: 1.062232
2021-03-13 21:51:46,589 - INFO - __main__ -   learning_rate: 0.000004
train_epoch: 2 train_acc: 0.4128:  60%|██████████████████            | 3/5 [11:59<08:02, 241.38s/it]
Iteration:   0%|                                                            | 0/123 [00:00<?, ?it/s][Atrain_epoch: 3 train_acc: 0.6529:  60%|██████████████████            | 3/5 [11:59<08:02, 241.38s/it]
lr = 0.00000440, loss = 0.1822:   0%|                                       | 0/123 [00:00<?, ?it/s][A
lr = 0.00000440, loss = 0.2345:   0%|                                       | 0/123 [00:01<?, ?it/s][A
lr = 0.00000434, loss = 0.2188:   0%|                                       | 0/123 [00:02<?, ?it/s][A
lr = 0.00000434, loss = 0.2205:   0%|                                       | 0/123 [00:02<?, ?it/s][A
lr = 0.00000434, loss = 0.2183:   0%|                                       | 0/123 [00:03<?, ?it/s][A
lr = 0.00000429, loss = 0.2113:   0%|                                       | 0/123 [00:04<?, ?it/s][A
lr = 0.00000429, loss = 0.2081:   0%|                                       | 0/123 [00:05<?, ?it/s][A
lr = 0.00000429, loss = 0.2026:   0%|                                       | 0/123 [00:05<?, ?it/s][A
lr = 0.00000424, loss = 0.2031:   0%|                                       | 0/123 [00:06<?, ?it/s][A
lr = 0.00000424, loss = 0.2009:   0%|                                       | 0/123 [00:07<?, ?it/s][A
lr = 0.00000424, loss = 0.2040:   0%|                                       | 0/123 [00:07<?, ?it/s][A
lr = 0.00000418, loss = 0.2023:   0%|                                       | 0/123 [00:08<?, ?it/s][A
lr = 0.00000418, loss = 0.1996:   0%|                                       | 0/123 [00:09<?, ?it/s][A
lr = 0.00000418, loss = 0.1981:   0%|                                       | 0/123 [00:10<?, ?it/s][A
lr = 0.00000418, loss = 0.1981:  11%|███▍                          | 14/123 [00:10<01:18,  1.38it/s][A
lr = 0.00000413, loss = 0.1943:  11%|███▍                          | 14/123 [00:10<01:18,  1.38it/s][A
lr = 0.00000413, loss = 0.1930:  11%|███▍                          | 14/123 [00:11<01:18,  1.38it/s][A
lr = 0.00000413, loss = 0.1939:  11%|███▍                          | 14/123 [00:12<01:18,  1.38it/s][A
lr = 0.00000408, loss = 0.1964:  11%|███▍                          | 14/123 [00:13<01:18,  1.38it/s][A
lr = 0.00000408, loss = 0.1960:  11%|███▍                          | 14/123 [00:13<01:18,  1.38it/s][A
lr = 0.00000408, loss = 0.1986:  11%|███▍                          | 14/123 [00:14<01:18,  1.38it/s][A
lr = 0.00000402, loss = 0.1995:  11%|███▍                          | 14/123 [00:15<01:18,  1.38it/s][A
lr = 0.00000402, loss = 0.1999:  11%|███▍                          | 14/123 [00:15<01:18,  1.38it/s][A
lr = 0.00000402, loss = 0.1999:  11%|███▍                          | 14/123 [00:16<01:18,  1.38it/s][A
lr = 0.00000397, loss = 0.2009:  11%|███▍                          | 14/123 [00:17<01:18,  1.38it/s][A
lr = 0.00000397, loss = 0.1980:  11%|███▍                          | 14/123 [00:18<01:18,  1.38it/s][A
lr = 0.00000397, loss = 0.1975:  11%|███▍                          | 14/123 [00:18<01:18,  1.38it/s][A
lr = 0.00000391, loss = 0.1952:  11%|███▍                          | 14/123 [00:19<01:18,  1.38it/s][A
lr = 0.00000391, loss = 0.1940:  11%|███▍                          | 14/123 [00:20<01:18,  1.38it/s][A
lr = 0.00000391, loss = 0.1940:  23%|██████▊                       | 28/123 [00:20<01:08,  1.38it/s][A
lr = 0.00000391, loss = 0.1971:  23%|██████▊                       | 28/123 [00:21<01:08,  1.38it/s][A
lr = 0.00000386, loss = 0.2010:  23%|██████▊                       | 28/123 [00:21<01:08,  1.38it/s][A
lr = 0.00000386, loss = 0.1998:  23%|██████▊                       | 28/123 [00:22<01:08,  1.38it/s][A
lr = 0.00000386, loss = 0.1998:  23%|██████▊                       | 28/123 [00:23<01:08,  1.38it/s][A
lr = 0.00000381, loss = 0.1987:  23%|██████▊                       | 28/123 [00:24<01:08,  1.38it/s][A
lr = 0.00000381, loss = 0.1973:  23%|██████▊                       | 28/123 [00:24<01:08,  1.38it/s][A
lr = 0.00000381, loss = 0.1965:  23%|██████▊                       | 28/123 [00:25<01:08,  1.38it/s][A
lr = 0.00000375, loss = 0.1961:  23%|██████▊                       | 28/123 [00:26<01:08,  1.38it/s][A
lr = 0.00000375, loss = 0.1957:  23%|██████▊                       | 28/123 [00:26<01:08,  1.38it/s][A
lr = 0.00000375, loss = 0.1953:  23%|██████▊                       | 28/123 [00:27<01:08,  1.38it/s][A
lr = 0.00000370, loss = 0.1972:  23%|██████▊                       | 28/123 [00:28<01:08,  1.38it/s][A
lr = 0.00000370, loss = 0.1952:  23%|██████▊                       | 28/123 [00:29<01:08,  1.38it/s][A
lr = 0.00000370, loss = 0.1961:  23%|██████▊                       | 28/123 [00:29<01:08,  1.38it/s][A
lr = 0.00000365, loss = 0.1948:  23%|██████▊                       | 28/123 [00:30<01:08,  1.38it/s][A
lr = 0.00000365, loss = 0.1948:  34%|██████████▏                   | 42/123 [00:30<00:58,  1.37it/s][A
lr = 0.00000365, loss = 0.1961:  34%|██████████▏                   | 42/123 [00:31<00:58,  1.37it/s][A
lr = 0.00000365, loss = 0.1957:  34%|██████████▏                   | 42/123 [00:31<00:58,  1.37it/s][A
lr = 0.00000359, loss = 0.1956:  34%|██████████▏                   | 42/123 [00:32<00:58,  1.37it/s][A
lr = 0.00000359, loss = 0.1941:  34%|██████████▏                   | 42/123 [00:33<00:58,  1.37it/s][A
lr = 0.00000359, loss = 0.1940:  34%|██████████▏                   | 42/123 [00:34<00:58,  1.37it/s][A
lr = 0.00000354, loss = 0.1935:  34%|██████████▏                   | 42/123 [00:34<00:58,  1.37it/s][A
lr = 0.00000354, loss = 0.1945:  34%|██████████▏                   | 42/123 [00:35<00:58,  1.37it/s][A
lr = 0.00000354, loss = 0.1944:  34%|██████████▏                   | 42/123 [00:36<00:58,  1.37it/s][A
lr = 0.00000349, loss = 0.1964:  34%|██████████▏                   | 42/123 [00:37<00:58,  1.37it/s][A
lr = 0.00000349, loss = 0.1993:  34%|██████████▏                   | 42/123 [00:37<00:58,  1.37it/s][A
lr = 0.00000349, loss = 0.1990:  34%|██████████▏                   | 42/123 [00:38<00:58,  1.37it/s][A
lr = 0.00000343, loss = 0.1975:  34%|██████████▏                   | 42/123 [00:39<00:58,  1.37it/s][A
lr = 0.00000343, loss = 0.1981:  34%|██████████▏                   | 42/123 [00:40<00:58,  1.37it/s][A
lr = 0.00000343, loss = 0.1983:  34%|██████████▏                   | 42/123 [00:40<00:58,  1.37it/s][A
lr = 0.00000343, loss = 0.1983:  46%|█████████████▋                | 56/123 [00:40<00:48,  1.38it/s][A
lr = 0.00000338, loss = 0.1986:  46%|█████████████▋                | 56/123 [00:41<00:48,  1.38it/s][A
lr = 0.00000338, loss = 0.1996:  46%|█████████████▋                | 56/123 [00:42<00:48,  1.38it/s][A
lr = 0.00000338, loss = 0.1992:  46%|█████████████▋                | 56/123 [00:42<00:48,  1.38it/s][A
lr = 0.00000332, loss = 0.1979:  46%|█████████████▋                | 56/123 [00:43<00:48,  1.38it/s][A
lr = 0.00000332, loss = 0.1983:  46%|█████████████▋                | 56/123 [00:44<00:48,  1.38it/s][A
lr = 0.00000332, loss = 0.1985:  46%|█████████████▋                | 56/123 [00:45<00:48,  1.38it/s][A
lr = 0.00000327, loss = 0.1984:  46%|█████████████▋                | 56/123 [00:45<00:48,  1.38it/s][A
lr = 0.00000327, loss = 0.1981:  46%|█████████████▋                | 56/123 [00:46<00:48,  1.38it/s][A
lr = 0.00000327, loss = 0.1982:  46%|█████████████▋                | 56/123 [00:47<00:48,  1.38it/s][A
lr = 0.00000322, loss = 0.1972:  46%|█████████████▋                | 56/123 [00:48<00:48,  1.38it/s][A
lr = 0.00000322, loss = 0.1967:  46%|█████████████▋                | 56/123 [00:48<00:48,  1.38it/s][A
lr = 0.00000322, loss = 0.1957:  46%|█████████████▋                | 56/123 [00:49<00:48,  1.38it/s][A
lr = 0.00000316, loss = 0.1953:  46%|█████████████▋                | 56/123 [00:50<00:48,  1.38it/s][A
lr = 0.00000316, loss = 0.1953:  46%|█████████████▋                | 56/123 [00:50<00:48,  1.38it/s][A
lr = 0.00000316, loss = 0.1953:  57%|█████████████████             | 70/123 [00:50<00:38,  1.37it/s][A
lr = 0.00000316, loss = 0.1945:  57%|█████████████████             | 70/123 [00:51<00:38,  1.37it/s][A
lr = 0.00000311, loss = 0.1943:  57%|█████████████████             | 70/123 [00:52<00:38,  1.37it/s][A
lr = 0.00000311, loss = 0.1942:  57%|█████████████████             | 70/123 [00:53<00:38,  1.37it/s][A
lr = 0.00000311, loss = 0.1936:  57%|█████████████████             | 70/123 [00:53<00:38,  1.37it/s][A
lr = 0.00000306, loss = 0.1930:  57%|█████████████████             | 70/123 [00:54<00:38,  1.37it/s][A
lr = 0.00000306, loss = 0.1924:  57%|█████████████████             | 70/123 [00:55<00:38,  1.37it/s][A
lr = 0.00000306, loss = 0.1927:  57%|█████████████████             | 70/123 [00:56<00:38,  1.37it/s][A
lr = 0.00000300, loss = 0.1932:  57%|█████████████████             | 70/123 [00:56<00:38,  1.37it/s][A
lr = 0.00000300, loss = 0.1931:  57%|█████████████████             | 70/123 [00:57<00:38,  1.37it/s][A
lr = 0.00000300, loss = 0.1926:  57%|█████████████████             | 70/123 [00:58<00:38,  1.37it/s][A
lr = 0.00000295, loss = 0.1925:  57%|█████████████████             | 70/123 [00:59<00:38,  1.37it/s][A
lr = 0.00000295, loss = 0.1929:  57%|█████████████████             | 70/123 [00:59<00:38,  1.37it/s][A
lr = 0.00000295, loss = 0.1926:  57%|█████████████████             | 70/123 [01:00<00:38,  1.37it/s][A
lr = 0.00000295, loss = 0.1926:  57%|█████████████████             | 70/123 [01:01<00:38,  1.37it/s][A
lr = 0.00000290, loss = 0.1933:  57%|█████████████████             | 70/123 [01:01<00:38,  1.37it/s][A
lr = 0.00000290, loss = 0.1933:  68%|████████████████████▍         | 84/123 [01:01<00:28,  1.37it/s][A
lr = 0.00000290, loss = 0.1939:  68%|████████████████████▍         | 84/123 [01:01<00:28,  1.37it/s][A
lr = 0.00000290, loss = 0.1930:  68%|████████████████████▍         | 84/123 [01:02<00:28,  1.37it/s][A
lr = 0.00000284, loss = 0.1923:  68%|████████████████████▍         | 84/123 [01:03<00:28,  1.37it/s][A
lr = 0.00000284, loss = 0.1913:  68%|████████████████████▍         | 84/123 [01:04<00:28,  1.37it/s][A
lr = 0.00000284, loss = 0.1903:  68%|████████████████████▍         | 84/123 [01:04<00:28,  1.37it/s][A
lr = 0.00000279, loss = 0.1909:  68%|████████████████████▍         | 84/123 [01:05<00:28,  1.37it/s][A
lr = 0.00000279, loss = 0.1910:  68%|████████████████████▍         | 84/123 [01:06<00:28,  1.37it/s][A
lr = 0.00000279, loss = 0.1910:  68%|████████████████████▍         | 84/123 [01:07<00:28,  1.37it/s][A
lr = 0.00000273, loss = 0.1918:  68%|████████████████████▍         | 84/123 [01:07<00:28,  1.37it/s][A
lr = 0.00000273, loss = 0.1921:  68%|████████████████████▍         | 84/123 [01:08<00:28,  1.37it/s][A
lr = 0.00000273, loss = 0.1922:  68%|████████████████████▍         | 84/123 [01:09<00:28,  1.37it/s][A
lr = 0.00000268, loss = 0.1921:  68%|████████████████████▍         | 84/123 [01:10<00:28,  1.37it/s][A
lr = 0.00000268, loss = 0.1922:  68%|████████████████████▍         | 84/123 [01:10<00:28,  1.37it/s][A
lr = 0.00000268, loss = 0.1925:  68%|████████████████████▍         | 84/123 [01:11<00:28,  1.37it/s][A
lr = 0.00000268, loss = 0.1925:  80%|███████████████████████▉      | 98/123 [01:11<00:18,  1.37it/s][A
lr = 0.00000263, loss = 0.1924:  80%|███████████████████████▉      | 98/123 [01:12<00:18,  1.37it/s][A
lr = 0.00000263, loss = 0.1926:  80%|███████████████████████▉      | 98/123 [01:13<00:18,  1.37it/s][A
lr = 0.00000263, loss = 0.1924:  80%|███████████████████████▉      | 98/123 [01:13<00:18,  1.37it/s][A
lr = 0.00000257, loss = 0.1925:  80%|███████████████████████▉      | 98/123 [01:14<00:18,  1.37it/s][A
lr = 0.00000257, loss = 0.1919:  80%|███████████████████████▉      | 98/123 [01:15<00:18,  1.37it/s][A
lr = 0.00000257, loss = 0.1922:  80%|███████████████████████▉      | 98/123 [01:15<00:18,  1.37it/s][A
lr = 0.00000252, loss = 0.1918:  80%|███████████████████████▉      | 98/123 [01:16<00:18,  1.37it/s][A
lr = 0.00000252, loss = 0.1922:  80%|███████████████████████▉      | 98/123 [01:17<00:18,  1.37it/s][A
lr = 0.00000252, loss = 0.1924:  80%|███████████████████████▉      | 98/123 [01:18<00:18,  1.37it/s][A
lr = 0.00000247, loss = 0.1913:  80%|███████████████████████▉      | 98/123 [01:18<00:18,  1.37it/s][A
lr = 0.00000247, loss = 0.1908:  80%|███████████████████████▉      | 98/123 [01:19<00:18,  1.37it/s][A
lr = 0.00000247, loss = 0.1909:  80%|███████████████████████▉      | 98/123 [01:20<00:18,  1.37it/s][A
lr = 0.00000241, loss = 0.1905:  80%|███████████████████████▉      | 98/123 [01:21<00:18,  1.37it/s][A
lr = 0.00000241, loss = 0.1908:  80%|███████████████████████▉      | 98/123 [01:21<00:18,  1.37it/s][A
lr = 0.00000241, loss = 0.1908:  91%|██████████████████████████▍  | 112/123 [01:21<00:08,  1.37it/s][A
lr = 0.00000241, loss = 0.1906:  91%|██████████████████████████▍  | 112/123 [01:22<00:08,  1.37it/s][A
lr = 0.00000236, loss = 0.1913:  91%|██████████████████████████▍  | 112/123 [01:23<00:08,  1.37it/s][A
lr = 0.00000236, loss = 0.1915:  91%|██████████████████████████▍  | 112/123 [01:24<00:08,  1.37it/s][A
lr = 0.00000236, loss = 0.1918:  91%|██████████████████████████▍  | 112/123 [01:24<00:08,  1.37it/s][A
lr = 0.00000231, loss = 0.1919:  91%|██████████████████████████▍  | 112/123 [01:25<00:08,  1.37it/s][A
lr = 0.00000231, loss = 0.1916:  91%|██████████████████████████▍  | 112/123 [01:26<00:08,  1.37it/s][A
lr = 0.00000231, loss = 0.1912:  91%|██████████████████████████▍  | 112/123 [01:26<00:08,  1.37it/s][A
lr = 0.00000225, loss = 0.1913:  91%|██████████████████████████▍  | 112/123 [01:27<00:08,  1.37it/s][A
lr = 0.00000225, loss = 0.1916:  91%|██████████████████████████▍  | 112/123 [01:28<00:08,  1.37it/s][A
lr = 0.00000225, loss = 0.1914:  91%|██████████████████████████▍  | 112/123 [01:29<00:08,  1.37it/s][A
lr = 0.00000220, loss = 0.1915:  91%|██████████████████████████▍  | 112/123 [01:29<00:08,  1.37it/s][Alr = 0.00000220, loss = 0.1915: 100%|█████████████████████████████| 123/123 [01:29<00:00,  1.37it/s]
2021-03-13 21:53:16,305 - INFO - __main__ - Loading features from cached file /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/filtered/random/cartography_random_0.01/cache_20/cached_dev_matched_in_training_roberta-large_128_mnli
2021-03-13 21:53:16,990 - INFO - __main__ - ***** Running mnli in_training evaluation on dev_matched *****
2021-03-13 21:53:16,992 - INFO - __main__ -   Num examples = 9815
2021-03-13 21:53:16,992 - INFO - __main__ -   Batch size = 96

Evaluating:   0%|                                                           | 0/103 [00:00<?, ?it/s][A
Evaluating:  15%|███████▎                                          | 15/103 [00:10<01:00,  1.46it/s][A
Evaluating:  29%|██████████████▌                                   | 30/103 [00:20<00:49,  1.46it/s][A
Evaluating:  29%|██████████████▌                                   | 30/103 [00:30<00:49,  1.46it/s][A
Evaluating:  44%|█████████████████████▊                            | 45/103 [00:30<00:39,  1.46it/s][A
Evaluating:  58%|█████████████████████████████▏                    | 60/103 [00:40<00:29,  1.46it/s][A
Evaluating:  73%|████████████████████████████████████▍             | 75/103 [00:51<00:19,  1.46it/s][A
Evaluating:  87%|███████████████████████████████████████████▋      | 90/103 [01:01<00:08,  1.46it/s][AEvaluating: 100%|█████████████████████████████████████████████████| 103/103 [01:09<00:00,  1.47it/s]
2021-03-13 21:54:26,881 - INFO - cartography.selection.selection_utils - Dev_matched dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/dev_matched_dynamics/dynamics_epoch_3.jsonl
2021-03-13 21:54:26,884 - INFO - __main__ - ***** mnli dev_matched results in_training *****
2021-03-13 21:54:26,884 - INFO - __main__ - mnli dev_matched in_training acc = 0.7872
2021-03-13 21:54:26,885 - INFO - __main__ - ***** Write mnli dev_matched predictions in_training *****
2021-03-13 21:54:26,980 - INFO - __main__ - Loading features from cached file /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/filtered/random/cartography_random_0.01/cache_20/cached_dev_mismatched_in_training_roberta-large_128_mnli-mm
2021-03-13 21:54:27,595 - INFO - __main__ - ***** Running mnli-mm in_training evaluation on dev_mismatched *****
2021-03-13 21:54:27,596 - INFO - __main__ -   Num examples = 9832
2021-03-13 21:54:27,596 - INFO - __main__ -   Batch size = 96

Evaluating:   0%|                                                           | 0/103 [00:00<?, ?it/s][A
Evaluating:  15%|███████▎                                          | 15/103 [00:10<01:00,  1.46it/s][A
Evaluating:  29%|██████████████▌                                   | 30/103 [00:20<00:49,  1.46it/s][A
Evaluating:  44%|█████████████████████▊                            | 45/103 [00:30<00:39,  1.46it/s][A
Evaluating:  58%|█████████████████████████████▏                    | 60/103 [00:41<00:29,  1.46it/s][A
Evaluating:  73%|████████████████████████████████████▍             | 75/103 [00:51<00:19,  1.46it/s][A
Evaluating:  87%|███████████████████████████████████████████▋      | 90/103 [01:01<00:08,  1.46it/s][AEvaluating: 100%|█████████████████████████████████████████████████| 103/103 [01:10<00:00,  1.47it/s]
2021-03-13 21:55:37,666 - INFO - cartography.selection.selection_utils - Dev_mismatched dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/dev_mismatched_dynamics/dynamics_epoch_3.jsonl
2021-03-13 21:55:37,670 - INFO - __main__ - ***** mnli-mm dev_mismatched results in_training *****
2021-03-13 21:55:37,670 - INFO - __main__ - mnli-mm dev_mismatched in_training acc = 0.8029
2021-03-13 21:55:37,671 - INFO - __main__ - ***** Write mnli-mm dev_mismatched predictions in_training *****
2021-03-13 21:55:37,774 - INFO - transformers.configuration_utils - Configuration saved in /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/config.json
2021-03-13 21:55:43,078 - INFO - transformers.modeling_utils - Model weights saved in /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/pytorch_model.bin
2021-03-13 21:55:43,227 - INFO - __main__ - *** Found BEST model, and saved checkpoint. BEST dev performance : 0.8029 ***
2021-03-13 21:55:43,246 - INFO - cartography.selection.selection_utils - Training dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/training_dynamics/dynamics_epoch_3.jsonl
2021-03-13 21:55:43,247 - INFO - __main__ -   End of epoch : 3
2021-03-13 21:55:43,248 - INFO - __main__ -   epoch: 3.000000
2021-03-13 21:55:43,249 - INFO - __main__ -   train_acc: 0.777693
2021-03-13 21:55:43,249 - INFO - __main__ -   best_dev_performance: 0.802889
2021-03-13 21:55:43,249 - INFO - __main__ -   avg_batch_loss: 0.735986
2021-03-13 21:55:43,250 - INFO - __main__ -   learning_rate: 0.000002
train_epoch: 3 train_acc: 0.6529:  80%|████████████████████████      | 4/5 [15:55<03:59, 239.96s/it]
Iteration:   0%|                                                            | 0/123 [00:00<?, ?it/s][Atrain_epoch: 4 train_acc: 0.7777:  80%|████████████████████████      | 4/5 [15:55<03:59, 239.96s/it]
lr = 0.00000220, loss = 0.2057:   0%|                                       | 0/123 [00:00<?, ?it/s][A
lr = 0.00000220, loss = 0.1886:   0%|                                       | 0/123 [00:01<?, ?it/s][A
lr = 0.00000214, loss = 0.1791:   0%|                                       | 0/123 [00:02<?, ?it/s][A
lr = 0.00000214, loss = 0.1771:   0%|                                       | 0/123 [00:02<?, ?it/s][A
lr = 0.00000214, loss = 0.1775:   0%|                                       | 0/123 [00:03<?, ?it/s][A
lr = 0.00000209, loss = 0.1762:   0%|                                       | 0/123 [00:04<?, ?it/s][A
lr = 0.00000209, loss = 0.1659:   0%|                                       | 0/123 [00:05<?, ?it/s][A
lr = 0.00000209, loss = 0.1535:   0%|                                       | 0/123 [00:05<?, ?it/s][A
lr = 0.00000204, loss = 0.1511:   0%|                                       | 0/123 [00:06<?, ?it/s][A
lr = 0.00000204, loss = 0.1473:   0%|                                       | 0/123 [00:07<?, ?it/s][A
lr = 0.00000204, loss = 0.1431:   0%|                                       | 0/123 [00:07<?, ?it/s][A
lr = 0.00000198, loss = 0.1434:   0%|                                       | 0/123 [00:08<?, ?it/s][A
lr = 0.00000198, loss = 0.1432:   0%|                                       | 0/123 [00:09<?, ?it/s][A
lr = 0.00000198, loss = 0.1429:   0%|                                       | 0/123 [00:10<?, ?it/s][A
lr = 0.00000198, loss = 0.1429:  11%|███▍                          | 14/123 [00:10<01:18,  1.38it/s][A
lr = 0.00000193, loss = 0.1434:  11%|███▍                          | 14/123 [00:10<01:18,  1.38it/s][A
lr = 0.00000193, loss = 0.1440:  11%|███▍                          | 14/123 [00:11<01:18,  1.38it/s][A
lr = 0.00000193, loss = 0.1441:  11%|███▍                          | 14/123 [00:12<01:18,  1.38it/s][A
lr = 0.00000188, loss = 0.1465:  11%|███▍                          | 14/123 [00:13<01:18,  1.38it/s][A
lr = 0.00000188, loss = 0.1480:  11%|███▍                          | 14/123 [00:13<01:18,  1.38it/s][A
lr = 0.00000188, loss = 0.1470:  11%|███▍                          | 14/123 [00:14<01:18,  1.38it/s][A
lr = 0.00000182, loss = 0.1531:  11%|███▍                          | 14/123 [00:15<01:18,  1.38it/s][A
lr = 0.00000182, loss = 0.1528:  11%|███▍                          | 14/123 [00:15<01:18,  1.38it/s][A
lr = 0.00000182, loss = 0.1553:  11%|███▍                          | 14/123 [00:16<01:18,  1.38it/s][A
lr = 0.00000177, loss = 0.1543:  11%|███▍                          | 14/123 [00:17<01:18,  1.38it/s][A
lr = 0.00000177, loss = 0.1552:  11%|███▍                          | 14/123 [00:18<01:18,  1.38it/s][A
lr = 0.00000177, loss = 0.1586:  11%|███▍                          | 14/123 [00:18<01:18,  1.38it/s][A
lr = 0.00000172, loss = 0.1608:  11%|███▍                          | 14/123 [00:19<01:18,  1.38it/s][A
lr = 0.00000172, loss = 0.1628:  11%|███▍                          | 14/123 [00:20<01:18,  1.38it/s][A
lr = 0.00000172, loss = 0.1628:  23%|██████▊                       | 28/123 [00:20<01:08,  1.38it/s][A
lr = 0.00000172, loss = 0.1646:  23%|██████▊                       | 28/123 [00:21<01:08,  1.38it/s][A
lr = 0.00000166, loss = 0.1658:  23%|██████▊                       | 28/123 [00:21<01:08,  1.38it/s][A
lr = 0.00000166, loss = 0.1660:  23%|██████▊                       | 28/123 [00:22<01:08,  1.38it/s][A
lr = 0.00000166, loss = 0.1639:  23%|██████▊                       | 28/123 [00:23<01:08,  1.38it/s][A
lr = 0.00000161, loss = 0.1624:  23%|██████▊                       | 28/123 [00:24<01:08,  1.38it/s][A
lr = 0.00000161, loss = 0.1613:  23%|██████▊                       | 28/123 [00:24<01:08,  1.38it/s][A
lr = 0.00000161, loss = 0.1608:  23%|██████▊                       | 28/123 [00:25<01:08,  1.38it/s][A
lr = 0.00000156, loss = 0.1617:  23%|██████▊                       | 28/123 [00:26<01:08,  1.38it/s][A
lr = 0.00000156, loss = 0.1637:  23%|██████▊                       | 28/123 [00:26<01:08,  1.38it/s][A
lr = 0.00000156, loss = 0.1629:  23%|██████▊                       | 28/123 [00:27<01:08,  1.38it/s][A
lr = 0.00000150, loss = 0.1634:  23%|██████▊                       | 28/123 [00:28<01:08,  1.38it/s][A
lr = 0.00000150, loss = 0.1639:  23%|██████▊                       | 28/123 [00:29<01:08,  1.38it/s][A
lr = 0.00000150, loss = 0.1642:  23%|██████▊                       | 28/123 [00:29<01:08,  1.38it/s][A
lr = 0.00000145, loss = 0.1645:  23%|██████▊                       | 28/123 [00:30<01:08,  1.38it/s][A
lr = 0.00000145, loss = 0.1645:  34%|██████████▏                   | 42/123 [00:30<00:58,  1.38it/s][A
lr = 0.00000145, loss = 0.1632:  34%|██████████▏                   | 42/123 [00:31<00:58,  1.38it/s][A
lr = 0.00000145, loss = 0.1633:  34%|██████████▏                   | 42/123 [00:31<00:58,  1.38it/s][A
lr = 0.00000139, loss = 0.1638:  34%|██████████▏                   | 42/123 [00:32<00:58,  1.38it/s][A
lr = 0.00000139, loss = 0.1634:  34%|██████████▏                   | 42/123 [00:33<00:58,  1.38it/s][A
lr = 0.00000139, loss = 0.1629:  34%|██████████▏                   | 42/123 [00:34<00:58,  1.38it/s][A
lr = 0.00000134, loss = 0.1630:  34%|██████████▏                   | 42/123 [00:34<00:58,  1.38it/s][A
lr = 0.00000134, loss = 0.1639:  34%|██████████▏                   | 42/123 [00:35<00:58,  1.38it/s][A
lr = 0.00000134, loss = 0.1628:  34%|██████████▏                   | 42/123 [00:36<00:58,  1.38it/s][A
lr = 0.00000129, loss = 0.1612:  34%|██████████▏                   | 42/123 [00:37<00:58,  1.38it/s][A
lr = 0.00000129, loss = 0.1616:  34%|██████████▏                   | 42/123 [00:37<00:58,  1.38it/s][A
lr = 0.00000129, loss = 0.1605:  34%|██████████▏                   | 42/123 [00:38<00:58,  1.38it/s][A
lr = 0.00000123, loss = 0.1608:  34%|██████████▏                   | 42/123 [00:39<00:58,  1.38it/s][A
lr = 0.00000123, loss = 0.1606:  34%|██████████▏                   | 42/123 [00:40<00:58,  1.38it/s][A
lr = 0.00000123, loss = 0.1599:  34%|██████████▏                   | 42/123 [00:40<00:58,  1.38it/s][A
lr = 0.00000123, loss = 0.1599:  46%|█████████████▋                | 56/123 [00:40<00:48,  1.38it/s][A
lr = 0.00000118, loss = 0.1602:  46%|█████████████▋                | 56/123 [00:41<00:48,  1.38it/s][A
lr = 0.00000118, loss = 0.1591:  46%|█████████████▋                | 56/123 [00:42<00:48,  1.38it/s][A
lr = 0.00000118, loss = 0.1583:  46%|█████████████▋                | 56/123 [00:42<00:48,  1.38it/s][A
lr = 0.00000113, loss = 0.1573:  46%|█████████████▋                | 56/123 [00:43<00:48,  1.38it/s][A
lr = 0.00000113, loss = 0.1576:  46%|█████████████▋                | 56/123 [00:44<00:48,  1.38it/s][A
lr = 0.00000113, loss = 0.1563:  46%|█████████████▋                | 56/123 [00:45<00:48,  1.38it/s][A
lr = 0.00000107, loss = 0.1559:  46%|█████████████▋                | 56/123 [00:45<00:48,  1.38it/s][A
lr = 0.00000107, loss = 0.1557:  46%|█████████████▋                | 56/123 [00:46<00:48,  1.38it/s][A
lr = 0.00000107, loss = 0.1553:  46%|█████████████▋                | 56/123 [00:47<00:48,  1.38it/s][A
lr = 0.00000102, loss = 0.1552:  46%|█████████████▋                | 56/123 [00:48<00:48,  1.38it/s][A
lr = 0.00000102, loss = 0.1559:  46%|█████████████▋                | 56/123 [00:48<00:48,  1.38it/s][A
lr = 0.00000102, loss = 0.1550:  46%|█████████████▋                | 56/123 [00:49<00:48,  1.38it/s][A
lr = 0.00000097, loss = 0.1554:  46%|█████████████▋                | 56/123 [00:50<00:48,  1.38it/s][A
lr = 0.00000097, loss = 0.1556:  46%|█████████████▋                | 56/123 [00:50<00:48,  1.38it/s][A
lr = 0.00000097, loss = 0.1556:  57%|█████████████████             | 70/123 [00:50<00:38,  1.37it/s][A
lr = 0.00000097, loss = 0.1556:  57%|█████████████████             | 70/123 [00:51<00:38,  1.37it/s][A
lr = 0.00000091, loss = 0.1550:  57%|█████████████████             | 70/123 [00:52<00:38,  1.37it/s][A
lr = 0.00000091, loss = 0.1542:  57%|█████████████████             | 70/123 [00:53<00:38,  1.37it/s][A
lr = 0.00000091, loss = 0.1546:  57%|█████████████████             | 70/123 [00:53<00:38,  1.37it/s][A
lr = 0.00000086, loss = 0.1541:  57%|█████████████████             | 70/123 [00:54<00:38,  1.37it/s][A
lr = 0.00000086, loss = 0.1534:  57%|█████████████████             | 70/123 [00:55<00:38,  1.37it/s][A
lr = 0.00000086, loss = 0.1546:  57%|█████████████████             | 70/123 [00:56<00:38,  1.37it/s][A
lr = 0.00000080, loss = 0.1544:  57%|█████████████████             | 70/123 [00:56<00:38,  1.37it/s][A
lr = 0.00000080, loss = 0.1547:  57%|█████████████████             | 70/123 [00:57<00:38,  1.37it/s][A
lr = 0.00000080, loss = 0.1548:  57%|█████████████████             | 70/123 [00:58<00:38,  1.37it/s][A
lr = 0.00000075, loss = 0.1546:  57%|█████████████████             | 70/123 [00:59<00:38,  1.37it/s][A
lr = 0.00000075, loss = 0.1546:  57%|█████████████████             | 70/123 [00:59<00:38,  1.37it/s][A
lr = 0.00000075, loss = 0.1554:  57%|█████████████████             | 70/123 [01:00<00:38,  1.37it/s][A
lr = 0.00000070, loss = 0.1549:  57%|█████████████████             | 70/123 [01:01<00:38,  1.37it/s][A
lr = 0.00000070, loss = 0.1549:  68%|████████████████████▍         | 84/123 [01:01<00:28,  1.37it/s][A
lr = 0.00000070, loss = 0.1546:  68%|████████████████████▍         | 84/123 [01:01<00:28,  1.37it/s][A
lr = 0.00000070, loss = 0.1548:  68%|████████████████████▍         | 84/123 [01:02<00:28,  1.37it/s][A
lr = 0.00000064, loss = 0.1546:  68%|████████████████████▍         | 84/123 [01:03<00:28,  1.37it/s][A
lr = 0.00000064, loss = 0.1554:  68%|████████████████████▍         | 84/123 [01:04<00:28,  1.37it/s][A
lr = 0.00000064, loss = 0.1556:  68%|████████████████████▍         | 84/123 [01:04<00:28,  1.37it/s][A
lr = 0.00000059, loss = 0.1555:  68%|████████████████████▍         | 84/123 [01:05<00:28,  1.37it/s][A
lr = 0.00000059, loss = 0.1556:  68%|████████████████████▍         | 84/123 [01:06<00:28,  1.37it/s][A
lr = 0.00000059, loss = 0.1568:  68%|████████████████████▍         | 84/123 [01:07<00:28,  1.37it/s][A
lr = 0.00000054, loss = 0.1577:  68%|████████████████████▍         | 84/123 [01:07<00:28,  1.37it/s][A
lr = 0.00000054, loss = 0.1577:  68%|████████████████████▍         | 84/123 [01:08<00:28,  1.37it/s][A
lr = 0.00000054, loss = 0.1581:  68%|████████████████████▍         | 84/123 [01:09<00:28,  1.37it/s][A
lr = 0.00000048, loss = 0.1575:  68%|████████████████████▍         | 84/123 [01:10<00:28,  1.37it/s][A
lr = 0.00000048, loss = 0.1566:  68%|████████████████████▍         | 84/123 [01:10<00:28,  1.37it/s][A
lr = 0.00000048, loss = 0.1564:  68%|████████████████████▍         | 84/123 [01:11<00:28,  1.37it/s][A
lr = 0.00000048, loss = 0.1564:  80%|███████████████████████▉      | 98/123 [01:11<00:18,  1.37it/s][A
lr = 0.00000043, loss = 0.1560:  80%|███████████████████████▉      | 98/123 [01:12<00:18,  1.37it/s][A
lr = 0.00000043, loss = 0.1562:  80%|███████████████████████▉      | 98/123 [01:12<00:18,  1.37it/s][A
lr = 0.00000043, loss = 0.1558:  80%|███████████████████████▉      | 98/123 [01:13<00:18,  1.37it/s][A
lr = 0.00000038, loss = 0.1564:  80%|███████████████████████▉      | 98/123 [01:14<00:18,  1.37it/s][A
lr = 0.00000038, loss = 0.1563:  80%|███████████████████████▉      | 98/123 [01:15<00:18,  1.37it/s][A
lr = 0.00000038, loss = 0.1562:  80%|███████████████████████▉      | 98/123 [01:15<00:18,  1.37it/s][A
lr = 0.00000032, loss = 0.1560:  80%|███████████████████████▉      | 98/123 [01:16<00:18,  1.37it/s][A
lr = 0.00000032, loss = 0.1564:  80%|███████████████████████▉      | 98/123 [01:17<00:18,  1.37it/s][A
lr = 0.00000032, loss = 0.1563:  80%|███████████████████████▉      | 98/123 [01:17<00:18,  1.37it/s][A
lr = 0.00000027, loss = 0.1571:  80%|███████████████████████▉      | 98/123 [01:18<00:18,  1.37it/s][A
lr = 0.00000027, loss = 0.1576:  80%|███████████████████████▉      | 98/123 [01:19<00:18,  1.37it/s][A
lr = 0.00000027, loss = 0.1573:  80%|███████████████████████▉      | 98/123 [01:20<00:18,  1.37it/s][A
lr = 0.00000021, loss = 0.1573:  80%|███████████████████████▉      | 98/123 [01:20<00:18,  1.37it/s][A
lr = 0.00000021, loss = 0.1569:  80%|███████████████████████▉      | 98/123 [01:21<00:18,  1.37it/s][A
lr = 0.00000021, loss = 0.1569:  91%|██████████████████████████▍  | 112/123 [01:21<00:08,  1.37it/s][A
lr = 0.00000021, loss = 0.1573:  91%|██████████████████████████▍  | 112/123 [01:22<00:08,  1.37it/s][A
lr = 0.00000016, loss = 0.1574:  91%|██████████████████████████▍  | 112/123 [01:23<00:08,  1.37it/s][A
lr = 0.00000016, loss = 0.1575:  91%|██████████████████████████▍  | 112/123 [01:23<00:08,  1.37it/s][A
lr = 0.00000016, loss = 0.1574:  91%|██████████████████████████▍  | 112/123 [01:24<00:08,  1.37it/s][A
lr = 0.00000011, loss = 0.1572:  91%|██████████████████████████▍  | 112/123 [01:25<00:08,  1.37it/s][A
lr = 0.00000011, loss = 0.1565:  91%|██████████████████████████▍  | 112/123 [01:26<00:08,  1.37it/s][A
lr = 0.00000011, loss = 0.1560:  91%|██████████████████████████▍  | 112/123 [01:26<00:08,  1.37it/s][A
lr = 0.00000005, loss = 0.1559:  91%|██████████████████████████▍  | 112/123 [01:27<00:08,  1.37it/s][A
lr = 0.00000005, loss = 0.1559:  91%|██████████████████████████▍  | 112/123 [01:28<00:08,  1.37it/s][A
lr = 0.00000005, loss = 0.1562:  91%|██████████████████████████▍  | 112/123 [01:28<00:08,  1.37it/s][A
lr = 0.00000000, loss = 0.1559:  91%|██████████████████████████▍  | 112/123 [01:29<00:08,  1.37it/s][Alr = 0.00000000, loss = 0.1559: 100%|█████████████████████████████| 123/123 [01:29<00:00,  1.37it/s]
2021-03-13 21:57:12,800 - INFO - __main__ - Loading features from cached file /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/filtered/random/cartography_random_0.01/cache_20/cached_dev_matched_in_training_roberta-large_128_mnli
2021-03-13 21:57:13,396 - INFO - __main__ - ***** Running mnli in_training evaluation on dev_matched *****
2021-03-13 21:57:13,397 - INFO - __main__ -   Num examples = 9815
2021-03-13 21:57:13,398 - INFO - __main__ -   Batch size = 96

Evaluating:   0%|                                                           | 0/103 [00:00<?, ?it/s][A
Evaluating:  15%|███████▎                                          | 15/103 [00:10<01:00,  1.47it/s][A
Evaluating:  29%|██████████████▌                                   | 30/103 [00:20<00:49,  1.46it/s][A
Evaluating:  44%|█████████████████████▊                            | 45/103 [00:30<00:39,  1.46it/s][A
Evaluating:  58%|█████████████████████████████▏                    | 60/103 [00:40<00:29,  1.46it/s][A
Evaluating:  73%|████████████████████████████████████▍             | 75/103 [00:51<00:19,  1.46it/s][A
Evaluating:  87%|███████████████████████████████████████████▋      | 90/103 [01:01<00:08,  1.46it/s][AEvaluating: 100%|█████████████████████████████████████████████████| 103/103 [01:09<00:00,  1.47it/s]
2021-03-13 21:58:23,283 - INFO - cartography.selection.selection_utils - Dev_matched dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/dev_matched_dynamics/dynamics_epoch_4.jsonl
2021-03-13 21:58:23,287 - INFO - __main__ - ***** mnli dev_matched results in_training *****
2021-03-13 21:58:23,287 - INFO - __main__ - mnli dev_matched in_training acc = 0.7939
2021-03-13 21:58:23,287 - INFO - __main__ - ***** Write mnli dev_matched predictions in_training *****
2021-03-13 21:58:23,458 - INFO - __main__ - Loading features from cached file /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/filtered/random/cartography_random_0.01/cache_20/cached_dev_mismatched_in_training_roberta-large_128_mnli-mm
2021-03-13 21:58:24,018 - INFO - __main__ - ***** Running mnli-mm in_training evaluation on dev_mismatched *****
2021-03-13 21:58:24,019 - INFO - __main__ -   Num examples = 9832
2021-03-13 21:58:24,019 - INFO - __main__ -   Batch size = 96

Evaluating:   0%|                                                           | 0/103 [00:00<?, ?it/s][A
Evaluating:  15%|███████▎                                          | 15/103 [00:10<01:00,  1.47it/s][A
Evaluating:  29%|██████████████▌                                   | 30/103 [00:20<00:49,  1.46it/s][A
Evaluating:  44%|█████████████████████▊                            | 45/103 [00:30<00:39,  1.46it/s][A
Evaluating:  58%|█████████████████████████████▏                    | 60/103 [00:41<00:29,  1.46it/s][A
Evaluating:  73%|████████████████████████████████████▍             | 75/103 [00:51<00:19,  1.46it/s][A
Evaluating:  87%|███████████████████████████████████████████▋      | 90/103 [01:01<00:08,  1.46it/s][AEvaluating: 100%|█████████████████████████████████████████████████| 103/103 [01:10<00:00,  1.47it/s]
2021-03-13 21:59:34,063 - INFO - cartography.selection.selection_utils - Dev_mismatched dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/dev_mismatched_dynamics/dynamics_epoch_4.jsonl
2021-03-13 21:59:34,067 - INFO - __main__ - ***** mnli-mm dev_mismatched results in_training *****
2021-03-13 21:59:34,067 - INFO - __main__ - mnli-mm dev_mismatched in_training acc = 0.8116
2021-03-13 21:59:34,068 - INFO - __main__ - ***** Write mnli-mm dev_mismatched predictions in_training *****
2021-03-13 21:59:34,249 - INFO - transformers.configuration_utils - Configuration saved in /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/config.json
2021-03-13 21:59:39,543 - INFO - transformers.modeling_utils - Model weights saved in /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/pytorch_model.bin
2021-03-13 21:59:39,619 - INFO - __main__ - *** Found BEST model, and saved checkpoint. BEST dev performance : 0.8116 ***
2021-03-13 21:59:39,637 - INFO - cartography.selection.selection_utils - Training dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/training_dynamics/dynamics_epoch_4.jsonl
2021-03-13 21:59:39,639 - INFO - __main__ -   End of epoch : 4
2021-03-13 21:59:39,639 - INFO - __main__ -   epoch: 4.000000
2021-03-13 21:59:39,640 - INFO - __main__ -   train_acc: 0.830405
2021-03-13 21:59:39,640 - INFO - __main__ -   best_dev_performance: 0.811635
2021-03-13 21:59:39,640 - INFO - __main__ -   avg_batch_loss: 0.599257
2021-03-13 21:59:39,641 - INFO - __main__ -   learning_rate: 0.000000
train_epoch: 4 train_acc: 0.7777: 100%|██████████████████████████████| 5/5 [19:52<00:00, 238.89s/it]train_epoch: 4 train_acc: 0.7777: 100%|██████████████████████████████| 5/5 [19:52<00:00, 238.42s/it]
2021-03-13 21:59:39,720 - INFO - __main__ -  global_step = 205, average loss = 0.8106
2021-03-13 21:59:39,722 - INFO - __main__ -  **** Done with training ****
2021-03-13 21:59:39,722 - INFO - transformers.tokenization_utils - Model name '/gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01' not found in model shortcut name list (roberta-base, roberta-large, roberta-large-mnli, distilroberta-base, roberta-base-openai-detector, roberta-large-openai-detector). Assuming '/gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01' is a path, a model identifier, or url to a directory containing tokenizer files.
2021-03-13 21:59:39,723 - INFO - transformers.tokenization_utils - Didn't find file /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/added_tokens.json. We won't load it.
2021-03-13 21:59:39,723 - INFO - transformers.tokenization_utils - loading file /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/vocab.json
2021-03-13 21:59:39,723 - INFO - transformers.tokenization_utils - loading file /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/merges.txt
2021-03-13 21:59:39,723 - INFO - transformers.tokenization_utils - loading file None
2021-03-13 21:59:39,723 - INFO - transformers.tokenization_utils - loading file /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/special_tokens_map.json
2021-03-13 21:59:39,723 - INFO - transformers.tokenization_utils - loading file /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/tokenizer_config.json
2021-03-13 21:59:39,805 - INFO - __main__ - Evaluate the following checkpoints: ['/gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01']
2021-03-13 21:59:39,807 - INFO - transformers.configuration_utils - loading configuration file /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/config.json
2021-03-13 21:59:39,808 - INFO - transformers.configuration_utils - Model config RobertaConfig {
  "architectures": [
    "AdaptedRobertaForSequenceClassification"
  ],
  "attention_probs_dropout_prob": 0.1,
  "bos_token_id": 0,
  "do_sample": false,
  "eos_token_id": 2,
  "eos_token_ids": null,
  "finetuning_task": "mnli",
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 1024,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "intermediate_size": 4096,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-05,
  "length_penalty": 1.0,
  "max_length": 20,
  "max_position_embeddings": 514,
  "model_type": "roberta",
  "num_attention_heads": 16,
  "num_beams": 1,
  "num_hidden_layers": 24,
  "num_labels": 3,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 1,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "type_vocab_size": 1,
  "use_bfloat16": false,
  "vocab_size": 50265
}

2021-03-13 21:59:39,808 - INFO - transformers.modeling_utils - loading weights file /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/pytorch_model.bin
2021-03-13 21:59:53,170 - INFO - __main__ - Creating features from dataset file at /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/
2021-03-13 21:59:53,183 - INFO - cartography.classification.glue_utils - Writing example 0/1104
2021-03-13 21:59:53,684 - INFO - __main__ - Saving features into cached file /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/filtered/random/cartography_random_0.01/cache_20/cached_test_matched__roberta-large_128_mnli
2021-03-13 21:59:53,819 - INFO - __main__ - ***** Running mnli  evaluation on test_matched *****
2021-03-13 21:59:53,820 - INFO - __main__ -   Num examples = 1104
2021-03-13 21:59:53,820 - INFO - __main__ -   Batch size = 96
Evaluating:   0%|                                                            | 0/12 [00:00<?, ?it/s]Evaluating: 100%|███████████████████████████████████████████████████| 12/12 [00:07<00:00,  1.55it/s]
2021-03-13 22:00:01,575 - INFO - cartography.selection.selection_utils - Test_matched dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/test_matched_dynamics/dynamics_epoch_None.jsonl
2021-03-13 22:00:01,576 - INFO - __main__ - ***** mnli test_matched results  *****
2021-03-13 22:00:01,576 - INFO - __main__ - mnli test_matched  acc = 0.3460
2021-03-13 22:00:01,578 - INFO - __main__ - ***** Write mnli test_matched predictions  *****
2021-03-13 22:00:01,593 - INFO - __main__ - Creating features from dataset file at /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/
2021-03-13 22:00:01,601 - INFO - cartography.classification.glue_utils - Writing example 0/1104
2021-03-13 22:00:01,895 - INFO - __main__ - Saving features into cached file /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/filtered/random/cartography_random_0.01/cache_20/cached_test_mismatched__roberta-large_128_mnli-mm
2021-03-13 22:00:02,023 - INFO - __main__ - ***** Running mnli-mm  evaluation on test_mismatched *****
2021-03-13 22:00:02,025 - INFO - __main__ -   Num examples = 1104
2021-03-13 22:00:02,025 - INFO - __main__ -   Batch size = 96
Evaluating:   0%|                                                            | 0/12 [00:00<?, ?it/s]Evaluating: 100%|███████████████████████████████████████████████████| 12/12 [00:07<00:00,  1.55it/s]
2021-03-13 22:00:09,766 - INFO - cartography.selection.selection_utils - Test_mismatched dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/test_mismatched_dynamics/dynamics_epoch_None.jsonl
2021-03-13 22:00:09,767 - INFO - __main__ - ***** mnli-mm test_mismatched results  *****
2021-03-13 22:00:09,767 - INFO - __main__ - mnli-mm test_mismatched  acc = 0.3460
2021-03-13 22:00:09,768 - INFO - __main__ - ***** Write mnli-mm test_mismatched predictions  *****
  0%|          | 0/1105 [00:00<?, ?it/s]100%|██████████| 1105/1105 [00:00<00:00, 553860.65it/s]
2021-03-13 22:00:09,787 - INFO - cartography.data_utils_glue - Read 1104 valid examples, with unique IDS, out of 1104 from /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/diagnostic/diagnostic_test.tsv
2021-03-13 22:00:10,099 - INFO - cartography.classification.diagnostics_evaluation - logic                         : 0.3681 r3: 0.0663 134/ 364 class-var: 0.046
2021-03-13 22:00:10,100 - INFO - cartography.classification.diagnostics_evaluation - predicate_argument_structure  : 0.4835 r3: -0.0062 205/ 424 class-var: 0.148
2021-03-13 22:00:10,100 - INFO - cartography.classification.diagnostics_evaluation - lexical_semantics             : 0.4270 r3: 0.0645 158/ 370 class-var: 0.063
2021-03-13 22:00:10,100 - INFO - cartography.classification.diagnostics_evaluation - knowledge                     : 0.4225 r3: 0.0339 120/ 284 class-var: 0.064
2021-03-13 22:00:10,100 - INFO - cartography.classification.diagnostics_evaluation - total acc                     : 0.4194 r3: 0.0462 463/1104 class-var: 0.076
2021-03-13 22:00:10,100 - INFO - cartography.classification.diagnostics_evaluation - Results written to /gscratch/xlab/alisaliu/cartography/output/mnli_random/random_0.01/eval_metrics_diagnostics.json
2021-03-13 22:00:10,101 - INFO - __main__ -  **** Done ****
