#!/bin/bash
#SBATCH --job-name=train-ambiguous
#SBATCH --partition=xlab-gpu
#SBATCH --nodes=1
#SBATCH --mem=64G
#SBATCH --gres=gpu:1
#SBATCH --time=20:00:00
#SBATCH --mail-type=ALL
#SBATCH --mail-user=alisaliu@uw.edu
#SBATCH --output="slurm/train/slurm-%J-%x.out"

cat $0
echo "--------------------"

MODEL_OUTPUT_DIR=output/mnli_ambiguous/ambiguous_$FRACTION

python -m cartography.classification.run_glue \
    -c configs/mnli.jsonnet \
    --do_train \
    --do_test \
    --train filtered/ambiguous/cartography_variability_$FRACTION/train.tsv \
    -o $MODEL_OUTPUT_DIR
--------------------
2021-03-13 21:35:25,604 - WARNING - __main__ - Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, 16-bits training: False
2021-03-13 21:35:35,856 - INFO - transformers.configuration_utils - loading configuration file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-large-config.json from cache at /usr/lusers/alisaliu/.cache/torch/transformers/c22e0b5bbb7c0cb93a87a2ae01263ae715b4c18d692b1740ce72cacaa99ad184.2d28da311092e99a05f9ee17520204614d60b0bfdb32f8a75644df7737b6a748
2021-03-13 21:35:35,859 - INFO - transformers.configuration_utils - Model config RobertaConfig {
  "architectures": [
    "RobertaForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "bos_token_id": 0,
  "do_sample": false,
  "eos_token_id": 2,
  "eos_token_ids": null,
  "finetuning_task": "mnli",
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 1024,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "intermediate_size": 4096,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-05,
  "length_penalty": 1.0,
  "max_length": 20,
  "max_position_embeddings": 514,
  "model_type": "roberta",
  "num_attention_heads": 16,
  "num_beams": 1,
  "num_hidden_layers": 24,
  "num_labels": 3,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 1,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "type_vocab_size": 1,
  "use_bfloat16": false,
  "vocab_size": 50265
}

2021-03-13 21:35:55,903 - INFO - transformers.tokenization_utils - loading file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-large-vocab.json from cache at /usr/lusers/alisaliu/.cache/torch/transformers/1ae1f5b6e2b22b25ccc04c000bb79ca847aa226d0761536b011cf7e5868f0655.ef00af9e673c7160b4d41cfda1f48c5f4cba57d5142754525572a846a1ab1b9b
2021-03-13 21:35:55,905 - INFO - transformers.tokenization_utils - loading file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-large-merges.txt from cache at /usr/lusers/alisaliu/.cache/torch/transformers/f8f83199a6270d582d6245dc100e99c4155de81c9745c6248077018fe01abcfb.70bec105b4158ed9a1747fea67a43f5dee97855c64d62b6ec3742f4cfdb5feda
2021-03-13 21:36:06,115 - INFO - transformers.modeling_utils - loading weights file https://s3.amazonaws.com/models.huggingface.co/bert/roberta-large-pytorch_model.bin from cache at /usr/lusers/alisaliu/.cache/torch/transformers/195c00f28dc68ef13a307c6db84d566f801f03b2b6bcf8b29524f10f767fac2a.fc7abf72755ecc4a75d0d336a93c1c63358d2334f5998ed326f3b0da380bf536
2021-03-13 21:36:18,584 - INFO - transformers.modeling_utils - Weights of AdaptedRobertaForSequenceClassification not initialized from pretrained model: ['classifier.dense.weight', 'classifier.dense.bias', 'classifier.out_proj.weight', 'classifier.out_proj.bias']
2021-03-13 21:36:18,586 - INFO - transformers.modeling_utils - Weights from pretrained model not used in AdaptedRobertaForSequenceClassification: ['lm_head.bias', 'lm_head.dense.weight', 'lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.layer_norm.bias', 'lm_head.decoder.weight']
2021-03-13 21:36:33,240 - INFO - __main__ - Training/evaluation parameters <cartography.classification.params.Params object at 0x2b0226240f10>
2021-03-13 21:36:33,267 - INFO - __main__ - Creating features from dataset file at /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/
2021-03-13 21:36:33,395 - INFO - cartography.classification.glue_utils - Writing example 0/3927
2021-03-13 21:36:35,372 - INFO - __main__ - Saving features into cached file /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/filtered/ambiguous/cartography_variability_0.01/cache_20/cached_train_roberta-large_128_mnli
2021-03-13 21:36:35,814 - INFO - __main__ - ***** Running training *****
2021-03-13 21:36:35,816 - INFO - __main__ -   Num examples = 3927
2021-03-13 21:36:35,816 - INFO - __main__ -   Num Epochs = 5
2021-03-13 21:36:35,816 - INFO - __main__ -   Instantaneous batch size per GPU = 32
2021-03-13 21:36:35,816 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 96
2021-03-13 21:36:35,816 - INFO - __main__ -   Gradient Accumulation steps = 3
2021-03-13 21:36:35,816 - INFO - __main__ -   Total optimization steps = 205
Epoch:   0%|                                                                  | 0/5 [00:00<?, ?it/s]
Iteration:   0%|                                                            | 0/123 [00:00<?, ?it/s][Atrain_epoch: 0 train_acc: 0.0000:   0%|                                       | 0/5 [00:00<?, ?it/s]/gscratch/cse/alisaliu/miniconda3/envs/cartography/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:247: UserWarning: To get the last learning rate computed by the scheduler, please use `get_last_lr()`.
  warnings.warn("To get the last learning rate computed by the scheduler, "

lr = 0.00001099, loss = 0.3425:   0%|                                       | 0/123 [00:03<?, ?it/s][A
lr = 0.00001099, loss = 0.3590:   0%|                                       | 0/123 [00:04<?, ?it/s][A/gscratch/cse/alisaliu/miniconda3/envs/cartography/lib/python3.9/site-packages/transformers/optimization.py:155: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at  /opt/conda/conda-bld/pytorch_1607370151529/work/torch/csrc/utils/python_arg_parser.cpp:882.)
  exp_avg.mul_(beta1).add_(1.0 - beta1, grad)

lr = 0.00001094, loss = 0.3514:   0%|                                       | 0/123 [00:05<?, ?it/s][A
lr = 0.00001094, loss = 0.3485:   0%|                                       | 0/123 [00:06<?, ?it/s][A
lr = 0.00001094, loss = 0.3487:   0%|                                       | 0/123 [00:06<?, ?it/s][A
lr = 0.00001089, loss = 0.3444:   0%|                                       | 0/123 [00:07<?, ?it/s][A
lr = 0.00001089, loss = 0.3448:   0%|                                       | 0/123 [00:08<?, ?it/s][A
lr = 0.00001089, loss = 0.3473:   0%|                                       | 0/123 [00:08<?, ?it/s][A
lr = 0.00001083, loss = 0.3462:   0%|                                       | 0/123 [00:09<?, ?it/s][A
lr = 0.00001083, loss = 0.3413:   0%|                                       | 0/123 [00:10<?, ?it/s][A
lr = 0.00001083, loss = 0.3413:   8%|██▍                           | 10/123 [00:10<01:57,  1.04s/it][A
lr = 0.00001083, loss = 0.3415:   8%|██▍                           | 10/123 [00:11<01:57,  1.04s/it][A
lr = 0.00001078, loss = 0.3378:   8%|██▍                           | 10/123 [00:11<01:57,  1.04s/it][A
lr = 0.00001078, loss = 0.3348:   8%|██▍                           | 10/123 [00:12<01:57,  1.04s/it][A
lr = 0.00001078, loss = 0.3325:   8%|██▍                           | 10/123 [00:13<01:57,  1.04s/it][A
lr = 0.00001072, loss = 0.3319:   8%|██▍                           | 10/123 [00:13<01:57,  1.04s/it][A
lr = 0.00001072, loss = 0.3302:   8%|██▍                           | 10/123 [00:14<01:57,  1.04s/it][A
lr = 0.00001072, loss = 0.3311:   8%|██▍                           | 10/123 [00:15<01:57,  1.04s/it][A
lr = 0.00001067, loss = 0.3365:   8%|██▍                           | 10/123 [00:16<01:57,  1.04s/it][A
lr = 0.00001067, loss = 0.3345:   8%|██▍                           | 10/123 [00:16<01:57,  1.04s/it][A
lr = 0.00001067, loss = 0.3388:   8%|██▍                           | 10/123 [00:17<01:57,  1.04s/it][A
lr = 0.00001062, loss = 0.3380:   8%|██▍                           | 10/123 [00:18<01:57,  1.04s/it][A
lr = 0.00001062, loss = 0.3373:   8%|██▍                           | 10/123 [00:19<01:57,  1.04s/it][A
lr = 0.00001062, loss = 0.3365:   8%|██▍                           | 10/123 [00:19<01:57,  1.04s/it][A
lr = 0.00001056, loss = 0.3362:   8%|██▍                           | 10/123 [00:20<01:57,  1.04s/it][A
lr = 0.00001056, loss = 0.3362:  20%|█████▊                        | 24/123 [00:20<01:33,  1.06it/s][A
lr = 0.00001056, loss = 0.3365:  20%|█████▊                        | 24/123 [00:21<01:33,  1.06it/s][A
lr = 0.00001056, loss = 0.3375:  20%|█████▊                        | 24/123 [00:21<01:33,  1.06it/s][A
lr = 0.00001051, loss = 0.3371:  20%|█████▊                        | 24/123 [00:22<01:33,  1.06it/s][A
lr = 0.00001051, loss = 0.3356:  20%|█████▊                        | 24/123 [00:23<01:33,  1.06it/s][A
lr = 0.00001051, loss = 0.3371:  20%|█████▊                        | 24/123 [00:24<01:33,  1.06it/s][A
lr = 0.00001046, loss = 0.3348:  20%|█████▊                        | 24/123 [00:24<01:33,  1.06it/s][A
lr = 0.00001046, loss = 0.3352:  20%|█████▊                        | 24/123 [00:25<01:33,  1.06it/s][A
lr = 0.00001046, loss = 0.3350:  20%|█████▊                        | 24/123 [00:26<01:33,  1.06it/s][A
lr = 0.00001040, loss = 0.3346:  20%|█████▊                        | 24/123 [00:26<01:33,  1.06it/s][A
lr = 0.00001040, loss = 0.3345:  20%|█████▊                        | 24/123 [00:27<01:33,  1.06it/s][A
lr = 0.00001040, loss = 0.3325:  20%|█████▊                        | 24/123 [00:28<01:33,  1.06it/s][A
lr = 0.00001035, loss = 0.3336:  20%|█████▊                        | 24/123 [00:29<01:33,  1.06it/s][A
lr = 0.00001035, loss = 0.3336:  20%|█████▊                        | 24/123 [00:29<01:33,  1.06it/s][A
lr = 0.00001035, loss = 0.3334:  20%|█████▊                        | 24/123 [00:30<01:33,  1.06it/s][A
lr = 0.00001030, loss = 0.3347:  20%|█████▊                        | 24/123 [00:31<01:33,  1.06it/s][A
lr = 0.00001030, loss = 0.3347:  32%|█████████▌                    | 39/123 [00:31<01:13,  1.14it/s][A
lr = 0.00001030, loss = 0.3343:  32%|█████████▌                    | 39/123 [00:31<01:13,  1.14it/s][A
lr = 0.00001030, loss = 0.3343:  32%|█████████▌                    | 39/123 [00:32<01:13,  1.14it/s][A
lr = 0.00001024, loss = 0.3338:  32%|█████████▌                    | 39/123 [00:33<01:13,  1.14it/s][A
lr = 0.00001024, loss = 0.3333:  32%|█████████▌                    | 39/123 [00:34<01:13,  1.14it/s][A
lr = 0.00001024, loss = 0.3344:  32%|█████████▌                    | 39/123 [00:34<01:13,  1.14it/s][A
lr = 0.00001019, loss = 0.3357:  32%|█████████▌                    | 39/123 [00:35<01:13,  1.14it/s][A
lr = 0.00001019, loss = 0.3346:  32%|█████████▌                    | 39/123 [00:36<01:13,  1.14it/s][A
lr = 0.00001019, loss = 0.3329:  32%|█████████▌                    | 39/123 [00:36<01:13,  1.14it/s][A
lr = 0.00001014, loss = 0.3328:  32%|█████████▌                    | 39/123 [00:37<01:13,  1.14it/s][A
lr = 0.00001014, loss = 0.3333:  32%|█████████▌                    | 39/123 [00:38<01:13,  1.14it/s][A
lr = 0.00001014, loss = 0.3324:  32%|█████████▌                    | 39/123 [00:39<01:13,  1.14it/s][A
lr = 0.00001008, loss = 0.3319:  32%|█████████▌                    | 39/123 [00:39<01:13,  1.14it/s][A
lr = 0.00001008, loss = 0.3309:  32%|█████████▌                    | 39/123 [00:40<01:13,  1.14it/s][A
lr = 0.00001008, loss = 0.3304:  32%|█████████▌                    | 39/123 [00:41<01:13,  1.14it/s][A
lr = 0.00001003, loss = 0.3305:  32%|█████████▌                    | 39/123 [00:41<01:13,  1.14it/s][A
lr = 0.00001003, loss = 0.3305:  44%|█████████████▏                | 54/123 [00:41<00:57,  1.21it/s][A
lr = 0.00001003, loss = 0.3302:  44%|█████████████▏                | 54/123 [00:42<00:57,  1.21it/s][A
lr = 0.00001003, loss = 0.3302:  44%|█████████████▏                | 54/123 [00:43<00:57,  1.21it/s][A
lr = 0.00000997, loss = 0.3301:  44%|█████████████▏                | 54/123 [00:44<00:57,  1.21it/s][A
lr = 0.00000997, loss = 0.3299:  44%|█████████████▏                | 54/123 [00:44<00:57,  1.21it/s][A
lr = 0.00000997, loss = 0.3292:  44%|█████████████▏                | 54/123 [00:45<00:57,  1.21it/s][A
lr = 0.00000992, loss = 0.3290:  44%|█████████████▏                | 54/123 [00:46<00:57,  1.21it/s][A
lr = 0.00000992, loss = 0.3299:  44%|█████████████▏                | 54/123 [00:46<00:57,  1.21it/s][A
lr = 0.00000992, loss = 0.3304:  44%|█████████████▏                | 54/123 [00:47<00:57,  1.21it/s][A
lr = 0.00000987, loss = 0.3296:  44%|█████████████▏                | 54/123 [00:48<00:57,  1.21it/s][A
lr = 0.00000987, loss = 0.3299:  44%|█████████████▏                | 54/123 [00:49<00:57,  1.21it/s][A
lr = 0.00000987, loss = 0.3296:  44%|█████████████▏                | 54/123 [00:49<00:57,  1.21it/s][A
lr = 0.00000981, loss = 0.3301:  44%|█████████████▏                | 54/123 [00:50<00:57,  1.21it/s][A
lr = 0.00000981, loss = 0.3297:  44%|█████████████▏                | 54/123 [00:51<00:57,  1.21it/s][A
lr = 0.00000981, loss = 0.3295:  44%|█████████████▏                | 54/123 [00:51<00:57,  1.21it/s][A
lr = 0.00000981, loss = 0.3295:  55%|████████████████▌             | 68/123 [00:51<00:43,  1.26it/s][A
lr = 0.00000976, loss = 0.3297:  55%|████████████████▌             | 68/123 [00:52<00:43,  1.26it/s][A
lr = 0.00000976, loss = 0.3298:  55%|████████████████▌             | 68/123 [00:53<00:43,  1.26it/s][A
lr = 0.00000976, loss = 0.3304:  55%|████████████████▌             | 68/123 [00:54<00:43,  1.26it/s][A
lr = 0.00000971, loss = 0.3302:  55%|████████████████▌             | 68/123 [00:54<00:43,  1.26it/s][A
lr = 0.00000971, loss = 0.3311:  55%|████████████████▌             | 68/123 [00:55<00:43,  1.26it/s][A
lr = 0.00000971, loss = 0.3301:  55%|████████████████▌             | 68/123 [00:56<00:43,  1.26it/s][A
lr = 0.00000965, loss = 0.3300:  55%|████████████████▌             | 68/123 [00:57<00:43,  1.26it/s][A
lr = 0.00000965, loss = 0.3310:  55%|████████████████▌             | 68/123 [00:57<00:43,  1.26it/s][A
lr = 0.00000965, loss = 0.3304:  55%|████████████████▌             | 68/123 [00:58<00:43,  1.26it/s][A
lr = 0.00000960, loss = 0.3302:  55%|████████████████▌             | 68/123 [00:59<00:43,  1.26it/s][A
lr = 0.00000960, loss = 0.3308:  55%|████████████████▌             | 68/123 [00:59<00:43,  1.26it/s][A
lr = 0.00000960, loss = 0.3303:  55%|████████████████▌             | 68/123 [01:00<00:43,  1.26it/s][A
lr = 0.00000955, loss = 0.3305:  55%|████████████████▌             | 68/123 [01:01<00:43,  1.26it/s][A
lr = 0.00000955, loss = 0.3313:  55%|████████████████▌             | 68/123 [01:02<00:43,  1.26it/s][A
lr = 0.00000955, loss = 0.3313:  67%|████████████████████          | 82/123 [01:02<00:31,  1.29it/s][A
lr = 0.00000955, loss = 0.3315:  67%|████████████████████          | 82/123 [01:02<00:31,  1.29it/s][A
lr = 0.00000949, loss = 0.3319:  67%|████████████████████          | 82/123 [01:03<00:31,  1.29it/s][A
lr = 0.00000949, loss = 0.3321:  67%|████████████████████          | 82/123 [01:04<00:31,  1.29it/s][A
lr = 0.00000949, loss = 0.3318:  67%|████████████████████          | 82/123 [01:05<00:31,  1.29it/s][A
lr = 0.00000944, loss = 0.3318:  67%|████████████████████          | 82/123 [01:05<00:31,  1.29it/s][A
lr = 0.00000944, loss = 0.3316:  67%|████████████████████          | 82/123 [01:06<00:31,  1.29it/s][A
lr = 0.00000944, loss = 0.3317:  67%|████████████████████          | 82/123 [01:07<00:31,  1.29it/s][A
lr = 0.00000938, loss = 0.3316:  67%|████████████████████          | 82/123 [01:07<00:31,  1.29it/s][A
lr = 0.00000938, loss = 0.3318:  67%|████████████████████          | 82/123 [01:08<00:31,  1.29it/s][A
lr = 0.00000938, loss = 0.3315:  67%|████████████████████          | 82/123 [01:09<00:31,  1.29it/s][A
lr = 0.00000933, loss = 0.3317:  67%|████████████████████          | 82/123 [01:10<00:31,  1.29it/s][A
lr = 0.00000933, loss = 0.3316:  67%|████████████████████          | 82/123 [01:10<00:31,  1.29it/s][A
lr = 0.00000933, loss = 0.3323:  67%|████████████████████          | 82/123 [01:11<00:31,  1.29it/s][A
lr = 0.00000928, loss = 0.3321:  67%|████████████████████          | 82/123 [01:12<00:31,  1.29it/s][A
lr = 0.00000928, loss = 0.3321:  78%|███████████████████████▍      | 96/123 [01:12<00:20,  1.32it/s][A
lr = 0.00000928, loss = 0.3324:  78%|███████████████████████▍      | 96/123 [01:13<00:20,  1.32it/s][A
lr = 0.00000928, loss = 0.3329:  78%|███████████████████████▍      | 96/123 [01:13<00:20,  1.32it/s][A
lr = 0.00000922, loss = 0.3332:  78%|███████████████████████▍      | 96/123 [01:14<00:20,  1.32it/s][A
lr = 0.00000922, loss = 0.3329:  78%|███████████████████████▍      | 96/123 [01:15<00:20,  1.32it/s][A
lr = 0.00000922, loss = 0.3329:  78%|███████████████████████▍      | 96/123 [01:15<00:20,  1.32it/s][A
lr = 0.00000917, loss = 0.3326:  78%|███████████████████████▍      | 96/123 [01:16<00:20,  1.32it/s][A
lr = 0.00000917, loss = 0.3327:  78%|███████████████████████▍      | 96/123 [01:17<00:20,  1.32it/s][A
lr = 0.00000917, loss = 0.3325:  78%|███████████████████████▍      | 96/123 [01:18<00:20,  1.32it/s][A
lr = 0.00000912, loss = 0.3325:  78%|███████████████████████▍      | 96/123 [01:18<00:20,  1.32it/s][A
lr = 0.00000912, loss = 0.3325:  78%|███████████████████████▍      | 96/123 [01:19<00:20,  1.32it/s][A
lr = 0.00000912, loss = 0.3327:  78%|███████████████████████▍      | 96/123 [01:20<00:20,  1.32it/s][A
lr = 0.00000906, loss = 0.3326:  78%|███████████████████████▍      | 96/123 [01:21<00:20,  1.32it/s][A
lr = 0.00000906, loss = 0.3330:  78%|███████████████████████▍      | 96/123 [01:21<00:20,  1.32it/s][A
lr = 0.00000906, loss = 0.3330:  78%|███████████████████████▍      | 96/123 [01:22<00:20,  1.32it/s][A
lr = 0.00000906, loss = 0.3330:  89%|█████████████████████████▉   | 110/123 [01:22<00:09,  1.34it/s][A
lr = 0.00000901, loss = 0.3334:  89%|█████████████████████████▉   | 110/123 [01:23<00:09,  1.34it/s][A
lr = 0.00000901, loss = 0.3333:  89%|█████████████████████████▉   | 110/123 [01:23<00:09,  1.34it/s][A
lr = 0.00000901, loss = 0.3332:  89%|█████████████████████████▉   | 110/123 [01:24<00:09,  1.34it/s][A
lr = 0.00000896, loss = 0.3331:  89%|█████████████████████████▉   | 110/123 [01:25<00:09,  1.34it/s][A
lr = 0.00000896, loss = 0.3330:  89%|█████████████████████████▉   | 110/123 [01:26<00:09,  1.34it/s][A
lr = 0.00000896, loss = 0.3331:  89%|█████████████████████████▉   | 110/123 [01:26<00:09,  1.34it/s][A
lr = 0.00000890, loss = 0.3330:  89%|█████████████████████████▉   | 110/123 [01:27<00:09,  1.34it/s][A
lr = 0.00000890, loss = 0.3327:  89%|█████████████████████████▉   | 110/123 [01:28<00:09,  1.34it/s][A
lr = 0.00000890, loss = 0.3326:  89%|█████████████████████████▉   | 110/123 [01:28<00:09,  1.34it/s][A
lr = 0.00000885, loss = 0.3326:  89%|█████████████████████████▉   | 110/123 [01:29<00:09,  1.34it/s][A
lr = 0.00000885, loss = 0.3326:  89%|█████████████████████████▉   | 110/123 [01:30<00:09,  1.34it/s][A
lr = 0.00000885, loss = 0.3326:  89%|█████████████████████████▉   | 110/123 [01:31<00:09,  1.34it/s][A
lr = 0.00000879, loss = 0.3325:  89%|█████████████████████████▉   | 110/123 [01:31<00:09,  1.34it/s][Alr = 0.00000879, loss = 0.3325: 100%|█████████████████████████████| 123/123 [01:31<00:00,  1.34it/s]
2021-03-13 21:38:07,604 - INFO - __main__ - Creating features from dataset file at /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/
2021-03-13 21:38:07,800 - INFO - cartography.classification.glue_utils - Writing example 0/9815
2021-03-13 21:38:11,944 - INFO - __main__ - Saving features into cached file /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/filtered/ambiguous/cartography_variability_0.01/cache_20/cached_dev_matched_in_training_roberta-large_128_mnli
2021-03-13 21:38:13,223 - INFO - __main__ - ***** Running mnli in_training evaluation on dev_matched *****
2021-03-13 21:38:13,224 - INFO - __main__ -   Num examples = 9815
2021-03-13 21:38:13,224 - INFO - __main__ -   Batch size = 96

Evaluating:   0%|                                                           | 0/103 [00:00<?, ?it/s][A
Evaluating:  15%|███████▎                                          | 15/103 [00:10<00:59,  1.47it/s][A
Evaluating:  29%|██████████████▌                                   | 30/103 [00:20<00:49,  1.47it/s][A
Evaluating:  44%|█████████████████████▊                            | 45/103 [00:30<00:39,  1.47it/s][A
Evaluating:  58%|█████████████████████████████▏                    | 60/103 [00:40<00:29,  1.47it/s][A
Evaluating:  73%|████████████████████████████████████▍             | 75/103 [00:50<00:19,  1.47it/s][A
Evaluating:  87%|███████████████████████████████████████████▋      | 90/103 [01:01<00:08,  1.47it/s][AEvaluating: 100%|█████████████████████████████████████████████████| 103/103 [01:09<00:00,  1.48it/s]
2021-03-13 21:39:22,762 - INFO - cartography.selection.selection_utils - Dev_matched dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_ambiguous/ambiguous_0.01/dev_matched_dynamics/dynamics_epoch_0.jsonl
2021-03-13 21:39:22,767 - INFO - __main__ - ***** mnli dev_matched results in_training *****
2021-03-13 21:39:22,768 - INFO - __main__ - mnli dev_matched in_training acc = 0.3274
2021-03-13 21:39:22,771 - INFO - __main__ - ***** Write mnli dev_matched predictions in_training *****
2021-03-13 21:39:22,845 - INFO - __main__ - Creating features from dataset file at /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/
2021-03-13 21:39:23,002 - INFO - cartography.classification.glue_utils - Writing example 0/9832
2021-03-13 21:39:25,689 - INFO - __main__ - Saving features into cached file /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/filtered/ambiguous/cartography_variability_0.01/cache_20/cached_dev_mismatched_in_training_roberta-large_128_mnli-mm
2021-03-13 21:39:26,537 - INFO - __main__ - ***** Running mnli-mm in_training evaluation on dev_mismatched *****
2021-03-13 21:39:26,539 - INFO - __main__ -   Num examples = 9832
2021-03-13 21:39:26,539 - INFO - __main__ -   Batch size = 96

Evaluating:   0%|                                                           | 0/103 [00:00<?, ?it/s][A
Evaluating:  15%|███████▎                                          | 15/103 [00:10<00:59,  1.47it/s][A
Evaluating:  29%|██████████████▌                                   | 30/103 [00:20<00:49,  1.47it/s][A
Evaluating:  44%|█████████████████████▊                            | 45/103 [00:30<00:39,  1.46it/s][A
Evaluating:  58%|█████████████████████████████▏                    | 60/103 [00:40<00:29,  1.47it/s][A
Evaluating:  73%|████████████████████████████████████▍             | 75/103 [00:51<00:19,  1.47it/s][A
Evaluating:  87%|███████████████████████████████████████████▋      | 90/103 [01:01<00:08,  1.47it/s][AEvaluating: 100%|█████████████████████████████████████████████████| 103/103 [01:09<00:00,  1.48it/s]
2021-03-13 21:40:36,294 - INFO - cartography.selection.selection_utils - Dev_mismatched dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_ambiguous/ambiguous_0.01/dev_mismatched_dynamics/dynamics_epoch_0.jsonl
2021-03-13 21:40:36,298 - INFO - __main__ - ***** mnli-mm dev_mismatched results in_training *****
2021-03-13 21:40:36,298 - INFO - __main__ - mnli-mm dev_mismatched in_training acc = 0.3295
2021-03-13 21:40:36,300 - INFO - __main__ - ***** Write mnli-mm dev_mismatched predictions in_training *****
2021-03-13 21:40:36,371 - INFO - transformers.configuration_utils - Configuration saved in /gscratch/xlab/alisaliu/cartography/output/mnli_ambiguous/ambiguous_0.01/config.json
2021-03-13 21:40:40,731 - INFO - transformers.modeling_utils - Model weights saved in /gscratch/xlab/alisaliu/cartography/output/mnli_ambiguous/ambiguous_0.01/pytorch_model.bin
2021-03-13 21:40:40,886 - INFO - __main__ - *** Found BEST model, and saved checkpoint. BEST dev performance : 0.3295 ***
2021-03-13 21:40:40,905 - INFO - cartography.selection.selection_utils - Training dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_ambiguous/ambiguous_0.01/training_dynamics/dynamics_epoch_0.jsonl
2021-03-13 21:40:40,908 - INFO - __main__ -   End of epoch : 0
2021-03-13 21:40:40,918 - INFO - __main__ -   epoch: 0.000000
2021-03-13 21:40:40,926 - INFO - __main__ -   train_acc: 0.530685
2021-03-13 21:40:40,940 - INFO - __main__ -   best_dev_performance: 0.329536
2021-03-13 21:40:40,942 - INFO - __main__ -   avg_batch_loss: 1.278215
2021-03-13 21:40:40,942 - INFO - __main__ -   learning_rate: 0.000009
train_epoch: 0 train_acc: 0.0000:  20%|██████                        | 1/5 [04:05<16:20, 245.12s/it]
Iteration:   0%|                                                            | 0/123 [00:00<?, ?it/s][Atrain_epoch: 1 train_acc: 0.5307:  20%|██████                        | 1/5 [04:05<16:20, 245.12s/it]
lr = 0.00000879, loss = 0.3214:   0%|                                       | 0/123 [00:00<?, ?it/s][A
lr = 0.00000879, loss = 0.3246:   0%|                                       | 0/123 [00:01<?, ?it/s][A
lr = 0.00000874, loss = 0.3314:   0%|                                       | 0/123 [00:02<?, ?it/s][A
lr = 0.00000874, loss = 0.3181:   0%|                                       | 0/123 [00:02<?, ?it/s][A
lr = 0.00000874, loss = 0.3204:   0%|                                       | 0/123 [00:03<?, ?it/s][A
lr = 0.00000869, loss = 0.3254:   0%|                                       | 0/123 [00:04<?, ?it/s][A
lr = 0.00000869, loss = 0.3246:   0%|                                       | 0/123 [00:05<?, ?it/s][A
lr = 0.00000869, loss = 0.3243:   0%|                                       | 0/123 [00:05<?, ?it/s][A
lr = 0.00000863, loss = 0.3243:   0%|                                       | 0/123 [00:06<?, ?it/s][A
lr = 0.00000863, loss = 0.3270:   0%|                                       | 0/123 [00:07<?, ?it/s][A
lr = 0.00000863, loss = 0.3283:   0%|                                       | 0/123 [00:07<?, ?it/s][A
lr = 0.00000858, loss = 0.3310:   0%|                                       | 0/123 [00:08<?, ?it/s][A
lr = 0.00000858, loss = 0.3294:   0%|                                       | 0/123 [00:09<?, ?it/s][A
lr = 0.00000858, loss = 0.3272:   0%|                                       | 0/123 [00:10<?, ?it/s][A
lr = 0.00000858, loss = 0.3272:  11%|███▍                          | 14/123 [00:10<01:17,  1.40it/s][A
lr = 0.00000853, loss = 0.3255:  11%|███▍                          | 14/123 [00:10<01:17,  1.40it/s][A
lr = 0.00000853, loss = 0.3244:  11%|███▍                          | 14/123 [00:11<01:17,  1.40it/s][A
lr = 0.00000853, loss = 0.3231:  11%|███▍                          | 14/123 [00:12<01:17,  1.40it/s][A
lr = 0.00000847, loss = 0.3236:  11%|███▍                          | 14/123 [00:12<01:17,  1.40it/s][A
lr = 0.00000847, loss = 0.3225:  11%|███▍                          | 14/123 [00:13<01:17,  1.40it/s][A
lr = 0.00000847, loss = 0.3216:  11%|███▍                          | 14/123 [00:14<01:17,  1.40it/s][A
lr = 0.00000842, loss = 0.3209:  11%|███▍                          | 14/123 [00:15<01:17,  1.40it/s][A
lr = 0.00000842, loss = 0.3215:  11%|███▍                          | 14/123 [00:15<01:17,  1.40it/s][A
lr = 0.00000842, loss = 0.3247:  11%|███▍                          | 14/123 [00:16<01:17,  1.40it/s][A
lr = 0.00000837, loss = 0.3250:  11%|███▍                          | 14/123 [00:17<01:17,  1.40it/s][A
lr = 0.00000837, loss = 0.3271:  11%|███▍                          | 14/123 [00:17<01:17,  1.40it/s][A
lr = 0.00000837, loss = 0.3282:  11%|███▍                          | 14/123 [00:18<01:17,  1.40it/s][A
lr = 0.00000831, loss = 0.3279:  11%|███▍                          | 14/123 [00:19<01:17,  1.40it/s][A
lr = 0.00000831, loss = 0.3274:  11%|███▍                          | 14/123 [00:20<01:17,  1.40it/s][A
lr = 0.00000831, loss = 0.3274:  23%|██████▊                       | 28/123 [00:20<01:08,  1.40it/s][A
lr = 0.00000831, loss = 0.3263:  23%|██████▊                       | 28/123 [00:20<01:08,  1.40it/s][A
lr = 0.00000826, loss = 0.3253:  23%|██████▊                       | 28/123 [00:21<01:08,  1.40it/s][A
lr = 0.00000826, loss = 0.3262:  23%|██████▊                       | 28/123 [00:22<01:08,  1.40it/s][A
lr = 0.00000826, loss = 0.3253:  23%|██████▊                       | 28/123 [00:22<01:08,  1.40it/s][A
lr = 0.00000820, loss = 0.3281:  23%|██████▊                       | 28/123 [00:23<01:08,  1.40it/s][A
lr = 0.00000820, loss = 0.3266:  23%|██████▊                       | 28/123 [00:24<01:08,  1.40it/s][A
lr = 0.00000820, loss = 0.3285:  23%|██████▊                       | 28/123 [00:25<01:08,  1.40it/s][A
lr = 0.00000815, loss = 0.3302:  23%|██████▊                       | 28/123 [00:25<01:08,  1.40it/s][A
lr = 0.00000815, loss = 0.3305:  23%|██████▊                       | 28/123 [00:26<01:08,  1.40it/s][A
lr = 0.00000815, loss = 0.3322:  23%|██████▊                       | 28/123 [00:27<01:08,  1.40it/s][A
lr = 0.00000810, loss = 0.3318:  23%|██████▊                       | 28/123 [00:28<01:08,  1.40it/s][A
lr = 0.00000810, loss = 0.3327:  23%|██████▊                       | 28/123 [00:28<01:08,  1.40it/s][A
lr = 0.00000810, loss = 0.3326:  23%|██████▊                       | 28/123 [00:29<01:08,  1.40it/s][A
lr = 0.00000804, loss = 0.3328:  23%|██████▊                       | 28/123 [00:30<01:08,  1.40it/s][A
lr = 0.00000804, loss = 0.3328:  34%|██████████▏                   | 42/123 [00:30<00:58,  1.39it/s][A
lr = 0.00000804, loss = 0.3320:  34%|██████████▏                   | 42/123 [00:30<00:58,  1.39it/s][A
lr = 0.00000804, loss = 0.3316:  34%|██████████▏                   | 42/123 [00:31<00:58,  1.39it/s][A
lr = 0.00000799, loss = 0.3321:  34%|██████████▏                   | 42/123 [00:32<00:58,  1.39it/s][A
lr = 0.00000799, loss = 0.3313:  34%|██████████▏                   | 42/123 [00:33<00:58,  1.39it/s][A
lr = 0.00000799, loss = 0.3302:  34%|██████████▏                   | 42/123 [00:33<00:58,  1.39it/s][A
lr = 0.00000794, loss = 0.3306:  34%|██████████▏                   | 42/123 [00:34<00:58,  1.39it/s][A
lr = 0.00000794, loss = 0.3318:  34%|██████████▏                   | 42/123 [00:35<00:58,  1.39it/s][A
lr = 0.00000794, loss = 0.3324:  34%|██████████▏                   | 42/123 [00:35<00:58,  1.39it/s][A
lr = 0.00000788, loss = 0.3319:  34%|██████████▏                   | 42/123 [00:36<00:58,  1.39it/s][A
lr = 0.00000788, loss = 0.3324:  34%|██████████▏                   | 42/123 [00:37<00:58,  1.39it/s][A
lr = 0.00000788, loss = 0.3330:  34%|██████████▏                   | 42/123 [00:38<00:58,  1.39it/s][A
lr = 0.00000783, loss = 0.3326:  34%|██████████▏                   | 42/123 [00:38<00:58,  1.39it/s][A
lr = 0.00000783, loss = 0.3326:  34%|██████████▏                   | 42/123 [00:39<00:58,  1.39it/s][A
lr = 0.00000783, loss = 0.3316:  34%|██████████▏                   | 42/123 [00:40<00:58,  1.39it/s][A
lr = 0.00000783, loss = 0.3316:  46%|█████████████▋                | 56/123 [00:40<00:48,  1.39it/s][A
lr = 0.00000778, loss = 0.3311:  46%|█████████████▋                | 56/123 [00:40<00:48,  1.39it/s][A
lr = 0.00000778, loss = 0.3309:  46%|█████████████▋                | 56/123 [00:41<00:48,  1.39it/s][A
lr = 0.00000778, loss = 0.3309:  46%|█████████████▋                | 56/123 [00:42<00:48,  1.39it/s][A
lr = 0.00000772, loss = 0.3309:  46%|█████████████▋                | 56/123 [00:43<00:48,  1.39it/s][A
lr = 0.00000772, loss = 0.3307:  46%|█████████████▋                | 56/123 [00:43<00:48,  1.39it/s][A
lr = 0.00000772, loss = 0.3312:  46%|█████████████▋                | 56/123 [00:44<00:48,  1.39it/s][A
lr = 0.00000767, loss = 0.3309:  46%|█████████████▋                | 56/123 [00:45<00:48,  1.39it/s][A
lr = 0.00000767, loss = 0.3305:  46%|█████████████▋                | 56/123 [00:45<00:48,  1.39it/s][A
lr = 0.00000767, loss = 0.3306:  46%|█████████████▋                | 56/123 [00:46<00:48,  1.39it/s][A
lr = 0.00000761, loss = 0.3309:  46%|█████████████▋                | 56/123 [00:47<00:48,  1.39it/s][A
lr = 0.00000761, loss = 0.3309:  46%|█████████████▋                | 56/123 [00:48<00:48,  1.39it/s][A
lr = 0.00000761, loss = 0.3306:  46%|█████████████▋                | 56/123 [00:48<00:48,  1.39it/s][A
lr = 0.00000756, loss = 0.3303:  46%|█████████████▋                | 56/123 [00:49<00:48,  1.39it/s][A
lr = 0.00000756, loss = 0.3296:  46%|█████████████▋                | 56/123 [00:50<00:48,  1.39it/s][A
lr = 0.00000756, loss = 0.3296:  57%|█████████████████             | 70/123 [00:50<00:38,  1.39it/s][A
lr = 0.00000756, loss = 0.3293:  57%|█████████████████             | 70/123 [00:50<00:38,  1.39it/s][A
lr = 0.00000751, loss = 0.3293:  57%|█████████████████             | 70/123 [00:51<00:38,  1.39it/s][A
lr = 0.00000751, loss = 0.3295:  57%|█████████████████             | 70/123 [00:52<00:38,  1.39it/s][A
lr = 0.00000751, loss = 0.3290:  57%|█████████████████             | 70/123 [00:53<00:38,  1.39it/s][A
lr = 0.00000745, loss = 0.3296:  57%|█████████████████             | 70/123 [00:53<00:38,  1.39it/s][A
lr = 0.00000745, loss = 0.3291:  57%|█████████████████             | 70/123 [00:54<00:38,  1.39it/s][A
lr = 0.00000745, loss = 0.3291:  57%|█████████████████             | 70/123 [00:55<00:38,  1.39it/s][A
lr = 0.00000740, loss = 0.3288:  57%|█████████████████             | 70/123 [00:56<00:38,  1.39it/s][A
lr = 0.00000740, loss = 0.3286:  57%|█████████████████             | 70/123 [00:56<00:38,  1.39it/s][A
lr = 0.00000740, loss = 0.3287:  57%|█████████████████             | 70/123 [00:57<00:38,  1.39it/s][A
lr = 0.00000735, loss = 0.3290:  57%|█████████████████             | 70/123 [00:58<00:38,  1.39it/s][A
lr = 0.00000735, loss = 0.3291:  57%|█████████████████             | 70/123 [00:58<00:38,  1.39it/s][A
lr = 0.00000735, loss = 0.3300:  57%|█████████████████             | 70/123 [00:59<00:38,  1.39it/s][A
lr = 0.00000729, loss = 0.3296:  57%|█████████████████             | 70/123 [01:00<00:38,  1.39it/s][A
lr = 0.00000729, loss = 0.3296:  68%|████████████████████▍         | 84/123 [01:00<00:28,  1.39it/s][A
lr = 0.00000729, loss = 0.3298:  68%|████████████████████▍         | 84/123 [01:01<00:28,  1.39it/s][A
lr = 0.00000729, loss = 0.3299:  68%|████████████████████▍         | 84/123 [01:01<00:28,  1.39it/s][A
lr = 0.00000724, loss = 0.3303:  68%|████████████████████▍         | 84/123 [01:02<00:28,  1.39it/s][A
lr = 0.00000724, loss = 0.3300:  68%|████████████████████▍         | 84/123 [01:03<00:28,  1.39it/s][A
lr = 0.00000724, loss = 0.3296:  68%|████████████████████▍         | 84/123 [01:03<00:28,  1.39it/s][A
lr = 0.00000719, loss = 0.3295:  68%|████████████████████▍         | 84/123 [01:04<00:28,  1.39it/s][A
lr = 0.00000719, loss = 0.3291:  68%|████████████████████▍         | 84/123 [01:05<00:28,  1.39it/s][A
lr = 0.00000719, loss = 0.3287:  68%|████████████████████▍         | 84/123 [01:06<00:28,  1.39it/s][A
lr = 0.00000713, loss = 0.3287:  68%|████████████████████▍         | 84/123 [01:06<00:28,  1.39it/s][A
lr = 0.00000713, loss = 0.3284:  68%|████████████████████▍         | 84/123 [01:07<00:28,  1.39it/s][A
lr = 0.00000713, loss = 0.3287:  68%|████████████████████▍         | 84/123 [01:08<00:28,  1.39it/s][A
lr = 0.00000708, loss = 0.3291:  68%|████████████████████▍         | 84/123 [01:09<00:28,  1.39it/s][A
lr = 0.00000708, loss = 0.3289:  68%|████████████████████▍         | 84/123 [01:09<00:28,  1.39it/s][A
lr = 0.00000708, loss = 0.3288:  68%|████████████████████▍         | 84/123 [01:10<00:28,  1.39it/s][A
lr = 0.00000708, loss = 0.3288:  80%|███████████████████████▉      | 98/123 [01:10<00:17,  1.39it/s][A
lr = 0.00000702, loss = 0.3292:  80%|███████████████████████▉      | 98/123 [01:11<00:17,  1.39it/s][A
lr = 0.00000702, loss = 0.3291:  80%|███████████████████████▉      | 98/123 [01:11<00:17,  1.39it/s][A
lr = 0.00000702, loss = 0.3287:  80%|███████████████████████▉      | 98/123 [01:12<00:17,  1.39it/s][A
lr = 0.00000697, loss = 0.3286:  80%|███████████████████████▉      | 98/123 [01:13<00:17,  1.39it/s][A
lr = 0.00000697, loss = 0.3287:  80%|███████████████████████▉      | 98/123 [01:14<00:17,  1.39it/s][A
lr = 0.00000697, loss = 0.3289:  80%|███████████████████████▉      | 98/123 [01:14<00:17,  1.39it/s][A
lr = 0.00000692, loss = 0.3288:  80%|███████████████████████▉      | 98/123 [01:15<00:17,  1.39it/s][A
lr = 0.00000692, loss = 0.3286:  80%|███████████████████████▉      | 98/123 [01:16<00:17,  1.39it/s][A
lr = 0.00000692, loss = 0.3282:  80%|███████████████████████▉      | 98/123 [01:16<00:17,  1.39it/s][A
lr = 0.00000686, loss = 0.3284:  80%|███████████████████████▉      | 98/123 [01:17<00:17,  1.39it/s][A
lr = 0.00000686, loss = 0.3280:  80%|███████████████████████▉      | 98/123 [01:18<00:17,  1.39it/s][A
lr = 0.00000686, loss = 0.3278:  80%|███████████████████████▉      | 98/123 [01:19<00:17,  1.39it/s][A
lr = 0.00000681, loss = 0.3277:  80%|███████████████████████▉      | 98/123 [01:19<00:17,  1.39it/s][A
lr = 0.00000681, loss = 0.3281:  80%|███████████████████████▉      | 98/123 [01:20<00:17,  1.39it/s][A
lr = 0.00000681, loss = 0.3281:  91%|██████████████████████████▍  | 112/123 [01:20<00:07,  1.39it/s][A
lr = 0.00000681, loss = 0.3284:  91%|██████████████████████████▍  | 112/123 [01:21<00:07,  1.39it/s][A
lr = 0.00000676, loss = 0.3287:  91%|██████████████████████████▍  | 112/123 [01:21<00:07,  1.39it/s][A
lr = 0.00000676, loss = 0.3285:  91%|██████████████████████████▍  | 112/123 [01:22<00:07,  1.39it/s][A
lr = 0.00000676, loss = 0.3285:  91%|██████████████████████████▍  | 112/123 [01:23<00:07,  1.39it/s][A
lr = 0.00000670, loss = 0.3284:  91%|██████████████████████████▍  | 112/123 [01:24<00:07,  1.39it/s][A
lr = 0.00000670, loss = 0.3287:  91%|██████████████████████████▍  | 112/123 [01:24<00:07,  1.39it/s][A
lr = 0.00000670, loss = 0.3289:  91%|██████████████████████████▍  | 112/123 [01:25<00:07,  1.39it/s][A
lr = 0.00000665, loss = 0.3291:  91%|██████████████████████████▍  | 112/123 [01:26<00:07,  1.39it/s][A
lr = 0.00000665, loss = 0.3293:  91%|██████████████████████████▍  | 112/123 [01:27<00:07,  1.39it/s][A
lr = 0.00000665, loss = 0.3294:  91%|██████████████████████████▍  | 112/123 [01:27<00:07,  1.39it/s][A
lr = 0.00000660, loss = 0.3292:  91%|██████████████████████████▍  | 112/123 [01:28<00:07,  1.39it/s][Alr = 0.00000660, loss = 0.3292: 100%|█████████████████████████████| 123/123 [01:28<00:00,  1.39it/s]
2021-03-13 21:42:09,241 - INFO - __main__ - Loading features from cached file /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/filtered/ambiguous/cartography_variability_0.01/cache_20/cached_dev_matched_in_training_roberta-large_128_mnli
2021-03-13 21:42:09,689 - INFO - __main__ - ***** Running mnli in_training evaluation on dev_matched *****
2021-03-13 21:42:09,690 - INFO - __main__ -   Num examples = 9815
2021-03-13 21:42:09,691 - INFO - __main__ -   Batch size = 96

Evaluating:   0%|                                                           | 0/103 [00:00<?, ?it/s][A
Evaluating:  15%|███████▎                                          | 15/103 [00:10<00:59,  1.48it/s][A
Evaluating:  29%|██████████████▌                                   | 30/103 [00:20<00:49,  1.48it/s][A
Evaluating:  44%|█████████████████████▊                            | 45/103 [00:30<00:39,  1.48it/s][A
Evaluating:  58%|█████████████████████████████▏                    | 60/103 [00:40<00:29,  1.48it/s][A
Evaluating:  73%|████████████████████████████████████▍             | 75/103 [00:50<00:18,  1.48it/s][A
Evaluating:  87%|███████████████████████████████████████████▋      | 90/103 [01:00<00:08,  1.48it/s][AEvaluating: 100%|█████████████████████████████████████████████████| 103/103 [01:09<00:00,  1.49it/s]
2021-03-13 21:43:18,965 - INFO - cartography.selection.selection_utils - Dev_matched dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_ambiguous/ambiguous_0.01/dev_matched_dynamics/dynamics_epoch_1.jsonl
2021-03-13 21:43:18,970 - INFO - __main__ - ***** mnli dev_matched results in_training *****
2021-03-13 21:43:18,970 - INFO - __main__ - mnli dev_matched in_training acc = 0.3274
2021-03-13 21:43:18,970 - INFO - __main__ - ***** Write mnli dev_matched predictions in_training *****
2021-03-13 21:43:19,088 - INFO - __main__ - Loading features from cached file /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/filtered/ambiguous/cartography_variability_0.01/cache_20/cached_dev_mismatched_in_training_roberta-large_128_mnli-mm
2021-03-13 21:43:19,522 - INFO - __main__ - ***** Running mnli-mm in_training evaluation on dev_mismatched *****
2021-03-13 21:43:19,523 - INFO - __main__ -   Num examples = 9832
2021-03-13 21:43:19,523 - INFO - __main__ -   Batch size = 96

Evaluating:   0%|                                                           | 0/103 [00:00<?, ?it/s][A
Evaluating:  15%|███████▎                                          | 15/103 [00:10<00:59,  1.48it/s][A
Evaluating:  29%|██████████████▌                                   | 30/103 [00:20<00:49,  1.48it/s][A
Evaluating:  44%|█████████████████████▊                            | 45/103 [00:30<00:39,  1.48it/s][A
Evaluating:  58%|█████████████████████████████▏                    | 60/103 [00:40<00:29,  1.48it/s][A
Evaluating:  73%|████████████████████████████████████▍             | 75/103 [00:50<00:18,  1.48it/s][A
Evaluating:  87%|███████████████████████████████████████████▋      | 90/103 [01:00<00:08,  1.48it/s][AEvaluating: 100%|█████████████████████████████████████████████████| 103/103 [01:09<00:00,  1.48it/s]
2021-03-13 21:44:28,923 - INFO - cartography.selection.selection_utils - Dev_mismatched dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_ambiguous/ambiguous_0.01/dev_mismatched_dynamics/dynamics_epoch_1.jsonl
2021-03-13 21:44:28,927 - INFO - __main__ - ***** mnli-mm dev_mismatched results in_training *****
2021-03-13 21:44:28,928 - INFO - __main__ - mnli-mm dev_mismatched in_training acc = 0.3295
2021-03-13 21:44:28,928 - INFO - __main__ - ***** Write mnli-mm dev_mismatched predictions in_training *****
2021-03-13 21:44:29,068 - INFO - cartography.selection.selection_utils - Training dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_ambiguous/ambiguous_0.01/training_dynamics/dynamics_epoch_1.jsonl
2021-03-13 21:44:29,070 - INFO - __main__ -   End of epoch : 1
2021-03-13 21:44:29,070 - INFO - __main__ -   epoch: 1.000000
2021-03-13 21:44:29,070 - INFO - __main__ -   train_acc: 0.537815
2021-03-13 21:44:29,071 - INFO - __main__ -   best_dev_performance: 0.329536
2021-03-13 21:44:29,071 - INFO - __main__ -   avg_batch_loss: 1.265416
2021-03-13 21:44:29,071 - INFO - __main__ -   learning_rate: 0.000007
train_epoch: 1 train_acc: 0.5307:  40%|████████████                  | 2/5 [07:53<12:00, 240.02s/it]
Iteration:   0%|                                                            | 0/123 [00:00<?, ?it/s][Atrain_epoch: 2 train_acc: 0.5378:  40%|████████████                  | 2/5 [07:53<12:00, 240.02s/it]
lr = 0.00000660, loss = 0.3931:   0%|                                       | 0/123 [00:00<?, ?it/s][A
lr = 0.00000660, loss = 0.3569:   0%|                                       | 0/123 [00:01<?, ?it/s][A
lr = 0.00000654, loss = 0.3325:   0%|                                       | 0/123 [00:02<?, ?it/s][A
lr = 0.00000654, loss = 0.3381:   0%|                                       | 0/123 [00:02<?, ?it/s][A
lr = 0.00000654, loss = 0.3324:   0%|                                       | 0/123 [00:03<?, ?it/s][A
lr = 0.00000649, loss = 0.3330:   0%|                                       | 0/123 [00:04<?, ?it/s][A
lr = 0.00000649, loss = 0.3305:   0%|                                       | 0/123 [00:05<?, ?it/s][A
lr = 0.00000649, loss = 0.3333:   0%|                                       | 0/123 [00:05<?, ?it/s][A
lr = 0.00000643, loss = 0.3380:   0%|                                       | 0/123 [00:06<?, ?it/s][A
lr = 0.00000643, loss = 0.3394:   0%|                                       | 0/123 [00:07<?, ?it/s][A
lr = 0.00000643, loss = 0.3363:   0%|                                       | 0/123 [00:07<?, ?it/s][A
lr = 0.00000638, loss = 0.3353:   0%|                                       | 0/123 [00:08<?, ?it/s][A
lr = 0.00000638, loss = 0.3362:   0%|                                       | 0/123 [00:09<?, ?it/s][A
lr = 0.00000638, loss = 0.3372:   0%|                                       | 0/123 [00:10<?, ?it/s][A
lr = 0.00000638, loss = 0.3372:  11%|███▍                          | 14/123 [00:10<01:17,  1.40it/s][A
lr = 0.00000633, loss = 0.3394:  11%|███▍                          | 14/123 [00:10<01:17,  1.40it/s][A
lr = 0.00000633, loss = 0.3350:  11%|███▍                          | 14/123 [00:11<01:17,  1.40it/s][A
lr = 0.00000633, loss = 0.3336:  11%|███▍                          | 14/123 [00:12<01:17,  1.40it/s][A
lr = 0.00000627, loss = 0.3342:  11%|███▍                          | 14/123 [00:12<01:17,  1.40it/s][A
lr = 0.00000627, loss = 0.3329:  11%|███▍                          | 14/123 [00:13<01:17,  1.40it/s][A
lr = 0.00000627, loss = 0.3307:  11%|███▍                          | 14/123 [00:14<01:17,  1.40it/s][A
lr = 0.00000622, loss = 0.3319:  11%|███▍                          | 14/123 [00:15<01:17,  1.40it/s][A
lr = 0.00000622, loss = 0.3316:  11%|███▍                          | 14/123 [00:15<01:17,  1.40it/s][A
lr = 0.00000622, loss = 0.3302:  11%|███▍                          | 14/123 [00:16<01:17,  1.40it/s][A
lr = 0.00000617, loss = 0.3286:  11%|███▍                          | 14/123 [00:17<01:17,  1.40it/s][A
lr = 0.00000617, loss = 0.3288:  11%|███▍                          | 14/123 [00:17<01:17,  1.40it/s][A
lr = 0.00000617, loss = 0.3279:  11%|███▍                          | 14/123 [00:18<01:17,  1.40it/s][A
lr = 0.00000611, loss = 0.3281:  11%|███▍                          | 14/123 [00:19<01:17,  1.40it/s][A
lr = 0.00000611, loss = 0.3280:  11%|███▍                          | 14/123 [00:20<01:17,  1.40it/s][A
lr = 0.00000611, loss = 0.3280:  23%|██████▊                       | 28/123 [00:20<01:08,  1.39it/s][A
lr = 0.00000611, loss = 0.3289:  23%|██████▊                       | 28/123 [00:20<01:08,  1.39it/s][A
lr = 0.00000606, loss = 0.3287:  23%|██████▊                       | 28/123 [00:21<01:08,  1.39it/s][A
lr = 0.00000606, loss = 0.3293:  23%|██████▊                       | 28/123 [00:22<01:08,  1.39it/s][A
lr = 0.00000606, loss = 0.3294:  23%|██████▊                       | 28/123 [00:22<01:08,  1.39it/s][A
lr = 0.00000601, loss = 0.3298:  23%|██████▊                       | 28/123 [00:23<01:08,  1.39it/s][A
lr = 0.00000601, loss = 0.3296:  23%|██████▊                       | 28/123 [00:24<01:08,  1.39it/s][A
lr = 0.00000601, loss = 0.3292:  23%|██████▊                       | 28/123 [00:25<01:08,  1.39it/s][A
lr = 0.00000595, loss = 0.3300:  23%|██████▊                       | 28/123 [00:25<01:08,  1.39it/s][A
lr = 0.00000595, loss = 0.3309:  23%|██████▊                       | 28/123 [00:26<01:08,  1.39it/s][A
lr = 0.00000595, loss = 0.3310:  23%|██████▊                       | 28/123 [00:27<01:08,  1.39it/s][A
lr = 0.00000590, loss = 0.3305:  23%|██████▊                       | 28/123 [00:28<01:08,  1.39it/s][A
lr = 0.00000590, loss = 0.3294:  23%|██████▊                       | 28/123 [00:28<01:08,  1.39it/s][A
lr = 0.00000590, loss = 0.3292:  23%|██████▊                       | 28/123 [00:29<01:08,  1.39it/s][A
lr = 0.00000585, loss = 0.3294:  23%|██████▊                       | 28/123 [00:30<01:08,  1.39it/s][A
lr = 0.00000585, loss = 0.3294:  34%|██████████▏                   | 42/123 [00:30<00:58,  1.39it/s][A
lr = 0.00000585, loss = 0.3294:  34%|██████████▏                   | 42/123 [00:30<00:58,  1.39it/s][A
lr = 0.00000585, loss = 0.3293:  34%|██████████▏                   | 42/123 [00:31<00:58,  1.39it/s][A
lr = 0.00000579, loss = 0.3290:  34%|██████████▏                   | 42/123 [00:32<00:58,  1.39it/s][A
lr = 0.00000579, loss = 0.3284:  34%|██████████▏                   | 42/123 [00:33<00:58,  1.39it/s][A
lr = 0.00000579, loss = 0.3285:  34%|██████████▏                   | 42/123 [00:33<00:58,  1.39it/s][A
lr = 0.00000574, loss = 0.3290:  34%|██████████▏                   | 42/123 [00:34<00:58,  1.39it/s][A
lr = 0.00000574, loss = 0.3283:  34%|██████████▏                   | 42/123 [00:35<00:58,  1.39it/s][A
lr = 0.00000574, loss = 0.3289:  34%|██████████▏                   | 42/123 [00:35<00:58,  1.39it/s][A
lr = 0.00000568, loss = 0.3296:  34%|██████████▏                   | 42/123 [00:36<00:58,  1.39it/s][A
lr = 0.00000568, loss = 0.3291:  34%|██████████▏                   | 42/123 [00:37<00:58,  1.39it/s][A
lr = 0.00000568, loss = 0.3291:  34%|██████████▏                   | 42/123 [00:38<00:58,  1.39it/s][A
lr = 0.00000563, loss = 0.3289:  34%|██████████▏                   | 42/123 [00:38<00:58,  1.39it/s][A
lr = 0.00000563, loss = 0.3286:  34%|██████████▏                   | 42/123 [00:39<00:58,  1.39it/s][A
lr = 0.00000563, loss = 0.3284:  34%|██████████▏                   | 42/123 [00:40<00:58,  1.39it/s][A
lr = 0.00000563, loss = 0.3284:  46%|█████████████▋                | 56/123 [00:40<00:48,  1.39it/s][A
lr = 0.00000558, loss = 0.3279:  46%|█████████████▋                | 56/123 [00:40<00:48,  1.39it/s][A
lr = 0.00000558, loss = 0.3281:  46%|█████████████▋                | 56/123 [00:41<00:48,  1.39it/s][A
lr = 0.00000558, loss = 0.3280:  46%|█████████████▋                | 56/123 [00:42<00:48,  1.39it/s][A
lr = 0.00000552, loss = 0.3280:  46%|█████████████▋                | 56/123 [00:43<00:48,  1.39it/s][A
lr = 0.00000552, loss = 0.3268:  46%|█████████████▋                | 56/123 [00:43<00:48,  1.39it/s][A
lr = 0.00000552, loss = 0.3269:  46%|█████████████▋                | 56/123 [00:44<00:48,  1.39it/s][A
lr = 0.00000547, loss = 0.3268:  46%|█████████████▋                | 56/123 [00:45<00:48,  1.39it/s][A
lr = 0.00000547, loss = 0.3261:  46%|█████████████▋                | 56/123 [00:45<00:48,  1.39it/s][A
lr = 0.00000547, loss = 0.3255:  46%|█████████████▋                | 56/123 [00:46<00:48,  1.39it/s][A
lr = 0.00000542, loss = 0.3254:  46%|█████████████▋                | 56/123 [00:47<00:48,  1.39it/s][A
lr = 0.00000542, loss = 0.3255:  46%|█████████████▋                | 56/123 [00:48<00:48,  1.39it/s][A
lr = 0.00000542, loss = 0.3253:  46%|█████████████▋                | 56/123 [00:48<00:48,  1.39it/s][A
lr = 0.00000536, loss = 0.3255:  46%|█████████████▋                | 56/123 [00:49<00:48,  1.39it/s][A
lr = 0.00000536, loss = 0.3255:  46%|█████████████▋                | 56/123 [00:50<00:48,  1.39it/s][A
lr = 0.00000536, loss = 0.3255:  57%|█████████████████             | 70/123 [00:50<00:38,  1.39it/s][A
lr = 0.00000536, loss = 0.3264:  57%|█████████████████             | 70/123 [00:50<00:38,  1.39it/s][A
lr = 0.00000531, loss = 0.3260:  57%|█████████████████             | 70/123 [00:51<00:38,  1.39it/s][A
lr = 0.00000531, loss = 0.3261:  57%|█████████████████             | 70/123 [00:52<00:38,  1.39it/s][A
lr = 0.00000531, loss = 0.3260:  57%|█████████████████             | 70/123 [00:53<00:38,  1.39it/s][A
lr = 0.00000526, loss = 0.3266:  57%|█████████████████             | 70/123 [00:53<00:38,  1.39it/s][A
lr = 0.00000526, loss = 0.3276:  57%|█████████████████             | 70/123 [00:54<00:38,  1.39it/s][A
lr = 0.00000526, loss = 0.3274:  57%|█████████████████             | 70/123 [00:55<00:38,  1.39it/s][A
lr = 0.00000520, loss = 0.3266:  57%|█████████████████             | 70/123 [00:56<00:38,  1.39it/s][A
lr = 0.00000520, loss = 0.3262:  57%|█████████████████             | 70/123 [00:56<00:38,  1.39it/s][A
lr = 0.00000520, loss = 0.3269:  57%|█████████████████             | 70/123 [00:57<00:38,  1.39it/s][A
lr = 0.00000515, loss = 0.3280:  57%|█████████████████             | 70/123 [00:58<00:38,  1.39it/s][A
lr = 0.00000515, loss = 0.3279:  57%|█████████████████             | 70/123 [00:58<00:38,  1.39it/s][A
lr = 0.00000515, loss = 0.3286:  57%|█████████████████             | 70/123 [00:59<00:38,  1.39it/s][A
lr = 0.00000509, loss = 0.3284:  57%|█████████████████             | 70/123 [01:00<00:38,  1.39it/s][A
lr = 0.00000509, loss = 0.3284:  68%|████████████████████▍         | 84/123 [01:00<00:28,  1.39it/s][A
lr = 0.00000509, loss = 0.3283:  68%|████████████████████▍         | 84/123 [01:01<00:28,  1.39it/s][A
lr = 0.00000509, loss = 0.3288:  68%|████████████████████▍         | 84/123 [01:01<00:28,  1.39it/s][A
lr = 0.00000504, loss = 0.3287:  68%|████████████████████▍         | 84/123 [01:02<00:28,  1.39it/s][A
lr = 0.00000504, loss = 0.3288:  68%|████████████████████▍         | 84/123 [01:03<00:28,  1.39it/s][A
lr = 0.00000504, loss = 0.3290:  68%|████████████████████▍         | 84/123 [01:03<00:28,  1.39it/s][A
lr = 0.00000499, loss = 0.3282:  68%|████████████████████▍         | 84/123 [01:04<00:28,  1.39it/s][A
lr = 0.00000499, loss = 0.3284:  68%|████████████████████▍         | 84/123 [01:05<00:28,  1.39it/s][A
lr = 0.00000499, loss = 0.3283:  68%|████████████████████▍         | 84/123 [01:06<00:28,  1.39it/s][A
lr = 0.00000493, loss = 0.3283:  68%|████████████████████▍         | 84/123 [01:06<00:28,  1.39it/s][A
lr = 0.00000493, loss = 0.3279:  68%|████████████████████▍         | 84/123 [01:07<00:28,  1.39it/s][A
lr = 0.00000493, loss = 0.3279:  68%|████████████████████▍         | 84/123 [01:08<00:28,  1.39it/s][A
lr = 0.00000488, loss = 0.3280:  68%|████████████████████▍         | 84/123 [01:09<00:28,  1.39it/s][A
lr = 0.00000488, loss = 0.3278:  68%|████████████████████▍         | 84/123 [01:09<00:28,  1.39it/s][A
lr = 0.00000488, loss = 0.3273:  68%|████████████████████▍         | 84/123 [01:10<00:28,  1.39it/s][A
lr = 0.00000488, loss = 0.3273:  80%|███████████████████████▉      | 98/123 [01:10<00:17,  1.39it/s][A
lr = 0.00000483, loss = 0.3274:  80%|███████████████████████▉      | 98/123 [01:11<00:17,  1.39it/s][A
lr = 0.00000483, loss = 0.3275:  80%|███████████████████████▉      | 98/123 [01:11<00:17,  1.39it/s][A
lr = 0.00000483, loss = 0.3272:  80%|███████████████████████▉      | 98/123 [01:12<00:17,  1.39it/s][A
lr = 0.00000477, loss = 0.3275:  80%|███████████████████████▉      | 98/123 [01:13<00:17,  1.39it/s][A
lr = 0.00000477, loss = 0.3277:  80%|███████████████████████▉      | 98/123 [01:14<00:17,  1.39it/s][A
lr = 0.00000477, loss = 0.3276:  80%|███████████████████████▉      | 98/123 [01:14<00:17,  1.39it/s][A
lr = 0.00000472, loss = 0.3277:  80%|███████████████████████▉      | 98/123 [01:15<00:17,  1.39it/s][A
lr = 0.00000472, loss = 0.3279:  80%|███████████████████████▉      | 98/123 [01:16<00:17,  1.39it/s][A
lr = 0.00000472, loss = 0.3278:  80%|███████████████████████▉      | 98/123 [01:16<00:17,  1.39it/s][A
lr = 0.00000467, loss = 0.3280:  80%|███████████████████████▉      | 98/123 [01:17<00:17,  1.39it/s][A
lr = 0.00000467, loss = 0.3278:  80%|███████████████████████▉      | 98/123 [01:18<00:17,  1.39it/s][A
lr = 0.00000467, loss = 0.3277:  80%|███████████████████████▉      | 98/123 [01:19<00:17,  1.39it/s][A
lr = 0.00000461, loss = 0.3278:  80%|███████████████████████▉      | 98/123 [01:19<00:17,  1.39it/s][A
lr = 0.00000461, loss = 0.3278:  80%|███████████████████████▉      | 98/123 [01:20<00:17,  1.39it/s][A
lr = 0.00000461, loss = 0.3278:  91%|██████████████████████████▍  | 112/123 [01:20<00:07,  1.38it/s][A
lr = 0.00000461, loss = 0.3278:  91%|██████████████████████████▍  | 112/123 [01:21<00:07,  1.38it/s][A
lr = 0.00000456, loss = 0.3276:  91%|██████████████████████████▍  | 112/123 [01:22<00:07,  1.38it/s][A
lr = 0.00000456, loss = 0.3277:  91%|██████████████████████████▍  | 112/123 [01:22<00:07,  1.38it/s][A
lr = 0.00000456, loss = 0.3277:  91%|██████████████████████████▍  | 112/123 [01:23<00:07,  1.38it/s][A
lr = 0.00000450, loss = 0.3274:  91%|██████████████████████████▍  | 112/123 [01:24<00:07,  1.38it/s][A
lr = 0.00000450, loss = 0.3272:  91%|██████████████████████████▍  | 112/123 [01:25<00:07,  1.38it/s][A
lr = 0.00000450, loss = 0.3271:  91%|██████████████████████████▍  | 112/123 [01:25<00:07,  1.38it/s][A
lr = 0.00000445, loss = 0.3275:  91%|██████████████████████████▍  | 112/123 [01:26<00:07,  1.38it/s][A
lr = 0.00000445, loss = 0.3276:  91%|██████████████████████████▍  | 112/123 [01:27<00:07,  1.38it/s][A
lr = 0.00000445, loss = 0.3275:  91%|██████████████████████████▍  | 112/123 [01:27<00:07,  1.38it/s][A
lr = 0.00000440, loss = 0.3275:  91%|██████████████████████████▍  | 112/123 [01:28<00:07,  1.38it/s][Alr = 0.00000440, loss = 0.3275: 100%|█████████████████████████████| 123/123 [01:28<00:00,  1.39it/s]
2021-03-13 21:45:57,590 - INFO - __main__ - Loading features from cached file /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/filtered/ambiguous/cartography_variability_0.01/cache_20/cached_dev_matched_in_training_roberta-large_128_mnli
2021-03-13 21:45:57,981 - INFO - __main__ - ***** Running mnli in_training evaluation on dev_matched *****
2021-03-13 21:45:57,982 - INFO - __main__ -   Num examples = 9815
2021-03-13 21:45:57,982 - INFO - __main__ -   Batch size = 96

Evaluating:   0%|                                                           | 0/103 [00:00<?, ?it/s][A
Evaluating:  15%|███████▎                                          | 15/103 [00:10<00:59,  1.48it/s][A
Evaluating:  29%|██████████████▌                                   | 30/103 [00:20<00:49,  1.48it/s][A
Evaluating:  44%|█████████████████████▊                            | 45/103 [00:30<00:39,  1.48it/s][A
Evaluating:  58%|█████████████████████████████▏                    | 60/103 [00:40<00:29,  1.48it/s][A
Evaluating:  73%|████████████████████████████████████▍             | 75/103 [00:50<00:18,  1.48it/s][A
Evaluating:  87%|███████████████████████████████████████████▋      | 90/103 [01:00<00:08,  1.48it/s][AEvaluating: 100%|█████████████████████████████████████████████████| 103/103 [01:09<00:00,  1.49it/s]
2021-03-13 21:47:07,187 - INFO - cartography.selection.selection_utils - Dev_matched dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_ambiguous/ambiguous_0.01/dev_matched_dynamics/dynamics_epoch_2.jsonl
2021-03-13 21:47:07,191 - INFO - __main__ - ***** mnli dev_matched results in_training *****
2021-03-13 21:47:07,191 - INFO - __main__ - mnli dev_matched in_training acc = 0.3274
2021-03-13 21:47:07,191 - INFO - __main__ - ***** Write mnli dev_matched predictions in_training *****
2021-03-13 21:47:07,261 - INFO - __main__ - Loading features from cached file /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/filtered/ambiguous/cartography_variability_0.01/cache_20/cached_dev_mismatched_in_training_roberta-large_128_mnli-mm
2021-03-13 21:47:07,703 - INFO - __main__ - ***** Running mnli-mm in_training evaluation on dev_mismatched *****
2021-03-13 21:47:07,704 - INFO - __main__ -   Num examples = 9832
2021-03-13 21:47:07,704 - INFO - __main__ -   Batch size = 96

Evaluating:   0%|                                                           | 0/103 [00:00<?, ?it/s][A
Evaluating:  15%|███████▎                                          | 15/103 [00:10<00:59,  1.48it/s][A
Evaluating:  29%|██████████████▌                                   | 30/103 [00:20<00:49,  1.48it/s][A
Evaluating:  44%|█████████████████████▊                            | 45/103 [00:30<00:39,  1.48it/s][A
Evaluating:  58%|█████████████████████████████▏                    | 60/103 [00:40<00:29,  1.48it/s][A
Evaluating:  73%|████████████████████████████████████▍             | 75/103 [00:50<00:18,  1.48it/s][A
Evaluating:  87%|███████████████████████████████████████████▋      | 90/103 [01:00<00:08,  1.48it/s][AEvaluating: 100%|█████████████████████████████████████████████████| 103/103 [01:09<00:00,  1.49it/s]
2021-03-13 21:48:17,067 - INFO - cartography.selection.selection_utils - Dev_mismatched dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_ambiguous/ambiguous_0.01/dev_mismatched_dynamics/dynamics_epoch_2.jsonl
2021-03-13 21:48:17,069 - INFO - __main__ - ***** mnli-mm dev_mismatched results in_training *****
2021-03-13 21:48:17,069 - INFO - __main__ - mnli-mm dev_mismatched in_training acc = 0.3295
2021-03-13 21:48:17,070 - INFO - __main__ - ***** Write mnli-mm dev_mismatched predictions in_training *****
2021-03-13 21:48:17,158 - INFO - cartography.selection.selection_utils - Training dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_ambiguous/ambiguous_0.01/training_dynamics/dynamics_epoch_2.jsonl
2021-03-13 21:48:17,160 - INFO - __main__ -   End of epoch : 2
2021-03-13 21:48:17,160 - INFO - __main__ -   epoch: 2.000000
2021-03-13 21:48:17,161 - INFO - __main__ -   train_acc: 0.542144
2021-03-13 21:48:17,161 - INFO - __main__ -   best_dev_performance: 0.329536
2021-03-13 21:48:17,161 - INFO - __main__ -   avg_batch_loss: 1.258744
2021-03-13 21:48:17,161 - INFO - __main__ -   learning_rate: 0.000004
train_epoch: 2 train_acc: 0.5378:  60%|██████████████████            | 3/5 [11:41<07:52, 236.44s/it]
Iteration:   0%|                                                            | 0/123 [00:00<?, ?it/s][Atrain_epoch: 3 train_acc: 0.5421:  60%|██████████████████            | 3/5 [11:41<07:52, 236.44s/it]
lr = 0.00000440, loss = 0.2930:   0%|                                       | 0/123 [00:00<?, ?it/s][A
lr = 0.00000440, loss = 0.3236:   0%|                                       | 0/123 [00:01<?, ?it/s][A
lr = 0.00000434, loss = 0.3339:   0%|                                       | 0/123 [00:02<?, ?it/s][A
lr = 0.00000434, loss = 0.3339:   0%|                                       | 0/123 [00:02<?, ?it/s][A
lr = 0.00000434, loss = 0.3340:   0%|                                       | 0/123 [00:03<?, ?it/s][A
lr = 0.00000429, loss = 0.3319:   0%|                                       | 0/123 [00:04<?, ?it/s][A
lr = 0.00000429, loss = 0.3354:   0%|                                       | 0/123 [00:05<?, ?it/s][A
lr = 0.00000429, loss = 0.3327:   0%|                                       | 0/123 [00:05<?, ?it/s][A
lr = 0.00000424, loss = 0.3328:   0%|                                       | 0/123 [00:06<?, ?it/s][A
lr = 0.00000424, loss = 0.3295:   0%|                                       | 0/123 [00:07<?, ?it/s][A
lr = 0.00000424, loss = 0.3314:   0%|                                       | 0/123 [00:07<?, ?it/s][A
lr = 0.00000418, loss = 0.3278:   0%|                                       | 0/123 [00:08<?, ?it/s][A
lr = 0.00000418, loss = 0.3304:   0%|                                       | 0/123 [00:09<?, ?it/s][A
lr = 0.00000418, loss = 0.3305:   0%|                                       | 0/123 [00:10<?, ?it/s][A
lr = 0.00000418, loss = 0.3305:  11%|███▍                          | 14/123 [00:10<01:17,  1.40it/s][A
lr = 0.00000413, loss = 0.3333:  11%|███▍                          | 14/123 [00:10<01:17,  1.40it/s][A
lr = 0.00000413, loss = 0.3315:  11%|███▍                          | 14/123 [00:11<01:17,  1.40it/s][A
lr = 0.00000413, loss = 0.3325:  11%|███▍                          | 14/123 [00:12<01:17,  1.40it/s][A
lr = 0.00000408, loss = 0.3339:  11%|███▍                          | 14/123 [00:12<01:17,  1.40it/s][A
lr = 0.00000408, loss = 0.3323:  11%|███▍                          | 14/123 [00:13<01:17,  1.40it/s][A
lr = 0.00000408, loss = 0.3308:  11%|███▍                          | 14/123 [00:14<01:17,  1.40it/s][A
lr = 0.00000402, loss = 0.3289:  11%|███▍                          | 14/123 [00:15<01:17,  1.40it/s][A
lr = 0.00000402, loss = 0.3283:  11%|███▍                          | 14/123 [00:15<01:17,  1.40it/s][A
lr = 0.00000402, loss = 0.3286:  11%|███▍                          | 14/123 [00:16<01:17,  1.40it/s][A
lr = 0.00000397, loss = 0.3287:  11%|███▍                          | 14/123 [00:17<01:17,  1.40it/s][A
lr = 0.00000397, loss = 0.3291:  11%|███▍                          | 14/123 [00:17<01:17,  1.40it/s][A
lr = 0.00000397, loss = 0.3289:  11%|███▍                          | 14/123 [00:18<01:17,  1.40it/s][A
lr = 0.00000391, loss = 0.3294:  11%|███▍                          | 14/123 [00:19<01:17,  1.40it/s][A
lr = 0.00000391, loss = 0.3289:  11%|███▍                          | 14/123 [00:20<01:17,  1.40it/s][A
lr = 0.00000391, loss = 0.3289:  23%|██████▊                       | 28/123 [00:20<01:08,  1.40it/s][A
lr = 0.00000391, loss = 0.3285:  23%|██████▊                       | 28/123 [00:20<01:08,  1.40it/s][A
lr = 0.00000386, loss = 0.3290:  23%|██████▊                       | 28/123 [00:21<01:08,  1.40it/s][A
lr = 0.00000386, loss = 0.3294:  23%|██████▊                       | 28/123 [00:22<01:08,  1.40it/s][A
lr = 0.00000386, loss = 0.3300:  23%|██████▊                       | 28/123 [00:22<01:08,  1.40it/s][A
lr = 0.00000381, loss = 0.3310:  23%|██████▊                       | 28/123 [00:23<01:08,  1.40it/s][A
lr = 0.00000381, loss = 0.3320:  23%|██████▊                       | 28/123 [00:24<01:08,  1.40it/s][A
lr = 0.00000381, loss = 0.3327:  23%|██████▊                       | 28/123 [00:25<01:08,  1.40it/s][A
lr = 0.00000375, loss = 0.3318:  23%|██████▊                       | 28/123 [00:25<01:08,  1.40it/s][A
lr = 0.00000375, loss = 0.3319:  23%|██████▊                       | 28/123 [00:26<01:08,  1.40it/s][A
lr = 0.00000375, loss = 0.3327:  23%|██████▊                       | 28/123 [00:27<01:08,  1.40it/s][A
lr = 0.00000370, loss = 0.3321:  23%|██████▊                       | 28/123 [00:28<01:08,  1.40it/s][A
lr = 0.00000370, loss = 0.3324:  23%|██████▊                       | 28/123 [00:28<01:08,  1.40it/s][A
lr = 0.00000370, loss = 0.3315:  23%|██████▊                       | 28/123 [00:29<01:08,  1.40it/s][A
lr = 0.00000365, loss = 0.3312:  23%|██████▊                       | 28/123 [00:30<01:08,  1.40it/s][A
lr = 0.00000365, loss = 0.3312:  34%|██████████▏                   | 42/123 [00:30<00:58,  1.39it/s][A
lr = 0.00000365, loss = 0.3305:  34%|██████████▏                   | 42/123 [00:30<00:58,  1.39it/s][A
lr = 0.00000365, loss = 0.3307:  34%|██████████▏                   | 42/123 [00:31<00:58,  1.39it/s][A
lr = 0.00000359, loss = 0.3303:  34%|██████████▏                   | 42/123 [00:32<00:58,  1.39it/s][A
lr = 0.00000359, loss = 0.3308:  34%|██████████▏                   | 42/123 [00:33<00:58,  1.39it/s][A
lr = 0.00000359, loss = 0.3302:  34%|██████████▏                   | 42/123 [00:33<00:58,  1.39it/s][A
lr = 0.00000354, loss = 0.3297:  34%|██████████▏                   | 42/123 [00:34<00:58,  1.39it/s][A
lr = 0.00000354, loss = 0.3293:  34%|██████████▏                   | 42/123 [00:35<00:58,  1.39it/s][A
lr = 0.00000354, loss = 0.3288:  34%|██████████▏                   | 42/123 [00:35<00:58,  1.39it/s][A
lr = 0.00000349, loss = 0.3287:  34%|██████████▏                   | 42/123 [00:36<00:58,  1.39it/s][A
lr = 0.00000349, loss = 0.3281:  34%|██████████▏                   | 42/123 [00:37<00:58,  1.39it/s][A
lr = 0.00000349, loss = 0.3280:  34%|██████████▏                   | 42/123 [00:38<00:58,  1.39it/s][A
lr = 0.00000343, loss = 0.3283:  34%|██████████▏                   | 42/123 [00:38<00:58,  1.39it/s][A
lr = 0.00000343, loss = 0.3277:  34%|██████████▏                   | 42/123 [00:39<00:58,  1.39it/s][A
lr = 0.00000343, loss = 0.3276:  34%|██████████▏                   | 42/123 [00:40<00:58,  1.39it/s][A
lr = 0.00000343, loss = 0.3276:  46%|█████████████▋                | 56/123 [00:40<00:48,  1.39it/s][A
lr = 0.00000338, loss = 0.3286:  46%|█████████████▋                | 56/123 [00:40<00:48,  1.39it/s][A
lr = 0.00000338, loss = 0.3283:  46%|█████████████▋                | 56/123 [00:41<00:48,  1.39it/s][A
lr = 0.00000338, loss = 0.3279:  46%|█████████████▋                | 56/123 [00:42<00:48,  1.39it/s][A
lr = 0.00000332, loss = 0.3283:  46%|█████████████▋                | 56/123 [00:43<00:48,  1.39it/s][A
lr = 0.00000332, loss = 0.3282:  46%|█████████████▋                | 56/123 [00:43<00:48,  1.39it/s][A
lr = 0.00000332, loss = 0.3274:  46%|█████████████▋                | 56/123 [00:44<00:48,  1.39it/s][A
lr = 0.00000327, loss = 0.3280:  46%|█████████████▋                | 56/123 [00:45<00:48,  1.39it/s][A
lr = 0.00000327, loss = 0.3284:  46%|█████████████▋                | 56/123 [00:45<00:48,  1.39it/s][A
lr = 0.00000327, loss = 0.3295:  46%|█████████████▋                | 56/123 [00:46<00:48,  1.39it/s][A
lr = 0.00000322, loss = 0.3292:  46%|█████████████▋                | 56/123 [00:47<00:48,  1.39it/s][A
lr = 0.00000322, loss = 0.3294:  46%|█████████████▋                | 56/123 [00:48<00:48,  1.39it/s][A
lr = 0.00000322, loss = 0.3292:  46%|█████████████▋                | 56/123 [00:48<00:48,  1.39it/s][A
lr = 0.00000316, loss = 0.3290:  46%|█████████████▋                | 56/123 [00:49<00:48,  1.39it/s][A
lr = 0.00000316, loss = 0.3290:  46%|█████████████▋                | 56/123 [00:50<00:48,  1.39it/s][A
lr = 0.00000316, loss = 0.3290:  57%|█████████████████             | 70/123 [00:50<00:38,  1.39it/s][A
lr = 0.00000316, loss = 0.3286:  57%|█████████████████             | 70/123 [00:50<00:38,  1.39it/s][A
lr = 0.00000311, loss = 0.3286:  57%|█████████████████             | 70/123 [00:51<00:38,  1.39it/s][A
lr = 0.00000311, loss = 0.3290:  57%|█████████████████             | 70/123 [00:52<00:38,  1.39it/s][A
lr = 0.00000311, loss = 0.3282:  57%|█████████████████             | 70/123 [00:53<00:38,  1.39it/s][A
lr = 0.00000306, loss = 0.3278:  57%|█████████████████             | 70/123 [00:53<00:38,  1.39it/s][A
lr = 0.00000306, loss = 0.3274:  57%|█████████████████             | 70/123 [00:54<00:38,  1.39it/s][A
lr = 0.00000306, loss = 0.3273:  57%|█████████████████             | 70/123 [00:55<00:38,  1.39it/s][A
lr = 0.00000300, loss = 0.3275:  57%|█████████████████             | 70/123 [00:56<00:38,  1.39it/s][A
lr = 0.00000300, loss = 0.3271:  57%|█████████████████             | 70/123 [00:56<00:38,  1.39it/s][A
lr = 0.00000300, loss = 0.3268:  57%|█████████████████             | 70/123 [00:57<00:38,  1.39it/s][A
lr = 0.00000295, loss = 0.3263:  57%|█████████████████             | 70/123 [00:58<00:38,  1.39it/s][A
lr = 0.00000295, loss = 0.3260:  57%|█████████████████             | 70/123 [00:58<00:38,  1.39it/s][A
lr = 0.00000295, loss = 0.3262:  57%|█████████████████             | 70/123 [00:59<00:38,  1.39it/s][A
lr = 0.00000290, loss = 0.3267:  57%|█████████████████             | 70/123 [01:00<00:38,  1.39it/s][A
lr = 0.00000290, loss = 0.3267:  68%|████████████████████▍         | 84/123 [01:00<00:28,  1.39it/s][A
lr = 0.00000290, loss = 0.3271:  68%|████████████████████▍         | 84/123 [01:01<00:28,  1.39it/s][A
lr = 0.00000290, loss = 0.3266:  68%|████████████████████▍         | 84/123 [01:01<00:28,  1.39it/s][A
lr = 0.00000284, loss = 0.3274:  68%|████████████████████▍         | 84/123 [01:02<00:28,  1.39it/s][A
lr = 0.00000284, loss = 0.3275:  68%|████████████████████▍         | 84/123 [01:03<00:28,  1.39it/s][A
lr = 0.00000284, loss = 0.3270:  68%|████████████████████▍         | 84/123 [01:03<00:28,  1.39it/s][A
lr = 0.00000279, loss = 0.3268:  68%|████████████████████▍         | 84/123 [01:04<00:28,  1.39it/s][A
lr = 0.00000279, loss = 0.3270:  68%|████████████████████▍         | 84/123 [01:05<00:28,  1.39it/s][A
lr = 0.00000279, loss = 0.3271:  68%|████████████████████▍         | 84/123 [01:06<00:28,  1.39it/s][A
lr = 0.00000273, loss = 0.3268:  68%|████████████████████▍         | 84/123 [01:06<00:28,  1.39it/s][A
lr = 0.00000273, loss = 0.3271:  68%|████████████████████▍         | 84/123 [01:07<00:28,  1.39it/s][A
lr = 0.00000273, loss = 0.3271:  68%|████████████████████▍         | 84/123 [01:08<00:28,  1.39it/s][A
lr = 0.00000268, loss = 0.3269:  68%|████████████████████▍         | 84/123 [01:08<00:28,  1.39it/s][A
lr = 0.00000268, loss = 0.3270:  68%|████████████████████▍         | 84/123 [01:09<00:28,  1.39it/s][A
lr = 0.00000268, loss = 0.3269:  68%|████████████████████▍         | 84/123 [01:10<00:28,  1.39it/s][A
lr = 0.00000268, loss = 0.3269:  80%|███████████████████████▉      | 98/123 [01:10<00:17,  1.39it/s][A
lr = 0.00000263, loss = 0.3270:  80%|███████████████████████▉      | 98/123 [01:11<00:17,  1.39it/s][A
lr = 0.00000263, loss = 0.3266:  80%|███████████████████████▉      | 98/123 [01:11<00:17,  1.39it/s][A
lr = 0.00000263, loss = 0.3272:  80%|███████████████████████▉      | 98/123 [01:12<00:17,  1.39it/s][A
lr = 0.00000257, loss = 0.3268:  80%|███████████████████████▉      | 98/123 [01:13<00:17,  1.39it/s][A
lr = 0.00000257, loss = 0.3267:  80%|███████████████████████▉      | 98/123 [01:13<00:17,  1.39it/s][A
lr = 0.00000257, loss = 0.3266:  80%|███████████████████████▉      | 98/123 [01:14<00:17,  1.39it/s][A
lr = 0.00000252, loss = 0.3270:  80%|███████████████████████▉      | 98/123 [01:15<00:17,  1.39it/s][A
lr = 0.00000252, loss = 0.3264:  80%|███████████████████████▉      | 98/123 [01:16<00:17,  1.39it/s][A
lr = 0.00000252, loss = 0.3271:  80%|███████████████████████▉      | 98/123 [01:16<00:17,  1.39it/s][A
lr = 0.00000247, loss = 0.3272:  80%|███████████████████████▉      | 98/123 [01:17<00:17,  1.39it/s][A
lr = 0.00000247, loss = 0.3269:  80%|███████████████████████▉      | 98/123 [01:18<00:17,  1.39it/s][A
lr = 0.00000247, loss = 0.3269:  80%|███████████████████████▉      | 98/123 [01:19<00:17,  1.39it/s][A
lr = 0.00000241, loss = 0.3271:  80%|███████████████████████▉      | 98/123 [01:19<00:17,  1.39it/s][A
lr = 0.00000241, loss = 0.3270:  80%|███████████████████████▉      | 98/123 [01:20<00:17,  1.39it/s][A
lr = 0.00000241, loss = 0.3270:  91%|██████████████████████████▍  | 112/123 [01:20<00:07,  1.39it/s][A
lr = 0.00000241, loss = 0.3271:  91%|██████████████████████████▍  | 112/123 [01:21<00:07,  1.39it/s][A
lr = 0.00000236, loss = 0.3269:  91%|██████████████████████████▍  | 112/123 [01:21<00:07,  1.39it/s][A
lr = 0.00000236, loss = 0.3267:  91%|██████████████████████████▍  | 112/123 [01:22<00:07,  1.39it/s][A
lr = 0.00000236, loss = 0.3269:  91%|██████████████████████████▍  | 112/123 [01:23<00:07,  1.39it/s][A
lr = 0.00000231, loss = 0.3272:  91%|██████████████████████████▍  | 112/123 [01:24<00:07,  1.39it/s][A
lr = 0.00000231, loss = 0.3273:  91%|██████████████████████████▍  | 112/123 [01:24<00:07,  1.39it/s][A
lr = 0.00000231, loss = 0.3273:  91%|██████████████████████████▍  | 112/123 [01:25<00:07,  1.39it/s][A
lr = 0.00000225, loss = 0.3268:  91%|██████████████████████████▍  | 112/123 [01:26<00:07,  1.39it/s][A
lr = 0.00000225, loss = 0.3268:  91%|██████████████████████████▍  | 112/123 [01:26<00:07,  1.39it/s][A
lr = 0.00000225, loss = 0.3266:  91%|██████████████████████████▍  | 112/123 [01:27<00:07,  1.39it/s][A
lr = 0.00000220, loss = 0.3268:  91%|██████████████████████████▍  | 112/123 [01:28<00:07,  1.39it/s][Alr = 0.00000220, loss = 0.3268: 100%|█████████████████████████████| 123/123 [01:28<00:00,  1.39it/s]
2021-03-13 21:49:45,392 - INFO - __main__ - Loading features from cached file /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/filtered/ambiguous/cartography_variability_0.01/cache_20/cached_dev_matched_in_training_roberta-large_128_mnli
2021-03-13 21:49:45,944 - INFO - __main__ - ***** Running mnli in_training evaluation on dev_matched *****
2021-03-13 21:49:45,946 - INFO - __main__ -   Num examples = 9815
2021-03-13 21:49:45,946 - INFO - __main__ -   Batch size = 96

Evaluating:   0%|                                                           | 0/103 [00:00<?, ?it/s][A
Evaluating:  15%|███████▎                                          | 15/103 [00:10<00:59,  1.48it/s][A
Evaluating:  29%|██████████████▌                                   | 30/103 [00:20<00:49,  1.48it/s][A
Evaluating:  44%|█████████████████████▊                            | 45/103 [00:30<00:39,  1.48it/s][A
Evaluating:  58%|█████████████████████████████▏                    | 60/103 [00:40<00:29,  1.48it/s][A
Evaluating:  73%|████████████████████████████████████▍             | 75/103 [00:50<00:18,  1.48it/s][A
Evaluating:  87%|███████████████████████████████████████████▋      | 90/103 [01:00<00:08,  1.48it/s][AEvaluating: 100%|█████████████████████████████████████████████████| 103/103 [01:09<00:00,  1.49it/s]
2021-03-13 21:50:55,122 - INFO - cartography.selection.selection_utils - Dev_matched dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_ambiguous/ambiguous_0.01/dev_matched_dynamics/dynamics_epoch_3.jsonl
2021-03-13 21:50:55,127 - INFO - __main__ - ***** mnli dev_matched results in_training *****
2021-03-13 21:50:55,127 - INFO - __main__ - mnli dev_matched in_training acc = 0.3274
2021-03-13 21:50:55,127 - INFO - __main__ - ***** Write mnli dev_matched predictions in_training *****
2021-03-13 21:50:55,199 - INFO - __main__ - Loading features from cached file /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/filtered/ambiguous/cartography_variability_0.01/cache_20/cached_dev_mismatched_in_training_roberta-large_128_mnli-mm
2021-03-13 21:50:55,730 - INFO - __main__ - ***** Running mnli-mm in_training evaluation on dev_mismatched *****
2021-03-13 21:50:55,732 - INFO - __main__ -   Num examples = 9832
2021-03-13 21:50:55,732 - INFO - __main__ -   Batch size = 96

Evaluating:   0%|                                                           | 0/103 [00:00<?, ?it/s][A
Evaluating:  15%|███████▎                                          | 15/103 [00:10<00:59,  1.48it/s][A
Evaluating:  15%|███████▎                                          | 15/103 [00:20<00:59,  1.48it/s][A
Evaluating:  29%|██████████████▌                                   | 30/103 [00:20<00:49,  1.48it/s][A
Evaluating:  44%|█████████████████████▊                            | 45/103 [00:30<00:39,  1.48it/s][A
Evaluating:  58%|█████████████████████████████▏                    | 60/103 [00:40<00:29,  1.48it/s][A
Evaluating:  73%|████████████████████████████████████▍             | 75/103 [00:50<00:18,  1.48it/s][A
Evaluating:  87%|███████████████████████████████████████████▋      | 90/103 [01:00<00:08,  1.48it/s][AEvaluating: 100%|█████████████████████████████████████████████████| 103/103 [01:09<00:00,  1.49it/s]
2021-03-13 21:52:05,077 - INFO - cartography.selection.selection_utils - Dev_mismatched dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_ambiguous/ambiguous_0.01/dev_mismatched_dynamics/dynamics_epoch_3.jsonl
2021-03-13 21:52:05,079 - INFO - __main__ - ***** mnli-mm dev_mismatched results in_training *****
2021-03-13 21:52:05,079 - INFO - __main__ - mnli-mm dev_mismatched in_training acc = 0.3295
2021-03-13 21:52:05,080 - INFO - __main__ - ***** Write mnli-mm dev_mismatched predictions in_training *****
2021-03-13 21:52:05,166 - INFO - cartography.selection.selection_utils - Training dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_ambiguous/ambiguous_0.01/training_dynamics/dynamics_epoch_3.jsonl
2021-03-13 21:52:05,167 - INFO - __main__ -   End of epoch : 3
2021-03-13 21:52:05,168 - INFO - __main__ -   epoch: 3.000000
2021-03-13 21:52:05,168 - INFO - __main__ -   train_acc: 0.543163
2021-03-13 21:52:05,168 - INFO - __main__ -   best_dev_performance: 0.329536
2021-03-13 21:52:05,169 - INFO - __main__ -   avg_batch_loss: 1.255965
2021-03-13 21:52:05,169 - INFO - __main__ -   learning_rate: 0.000002
2021-03-13 21:52:05,169 - INFO - __main__ - Ran out of patience. Best epoch was 0. Stopping training at epoch 3 out of 5 epochs.
train_epoch: 3 train_acc: 0.5421:  60%|██████████████████            | 3/5 [15:29<10:19, 309.78s/it]
2021-03-13 21:52:05,173 - INFO - __main__ -  global_step = 164, average loss = 0.9870
2021-03-13 21:52:05,173 - INFO - __main__ -  **** Done with training ****
2021-03-13 21:52:05,173 - INFO - transformers.tokenization_utils - Model name '/gscratch/xlab/alisaliu/cartography/output/mnli_ambiguous/ambiguous_0.01' not found in model shortcut name list (roberta-base, roberta-large, roberta-large-mnli, distilroberta-base, roberta-base-openai-detector, roberta-large-openai-detector). Assuming '/gscratch/xlab/alisaliu/cartography/output/mnli_ambiguous/ambiguous_0.01' is a path, a model identifier, or url to a directory containing tokenizer files.
2021-03-13 21:52:05,173 - INFO - transformers.tokenization_utils - Didn't find file /gscratch/xlab/alisaliu/cartography/output/mnli_ambiguous/ambiguous_0.01/added_tokens.json. We won't load it.
2021-03-13 21:52:05,174 - INFO - transformers.tokenization_utils - loading file /gscratch/xlab/alisaliu/cartography/output/mnli_ambiguous/ambiguous_0.01/vocab.json
2021-03-13 21:52:05,174 - INFO - transformers.tokenization_utils - loading file /gscratch/xlab/alisaliu/cartography/output/mnli_ambiguous/ambiguous_0.01/merges.txt
2021-03-13 21:52:05,174 - INFO - transformers.tokenization_utils - loading file None
2021-03-13 21:52:05,174 - INFO - transformers.tokenization_utils - loading file /gscratch/xlab/alisaliu/cartography/output/mnli_ambiguous/ambiguous_0.01/special_tokens_map.json
2021-03-13 21:52:05,174 - INFO - transformers.tokenization_utils - loading file /gscratch/xlab/alisaliu/cartography/output/mnli_ambiguous/ambiguous_0.01/tokenizer_config.json
2021-03-13 21:52:05,236 - INFO - __main__ - Evaluate the following checkpoints: ['/gscratch/xlab/alisaliu/cartography/output/mnli_ambiguous/ambiguous_0.01']
2021-03-13 21:52:05,237 - INFO - transformers.configuration_utils - loading configuration file /gscratch/xlab/alisaliu/cartography/output/mnli_ambiguous/ambiguous_0.01/config.json
2021-03-13 21:52:05,237 - INFO - transformers.configuration_utils - Model config RobertaConfig {
  "architectures": [
    "AdaptedRobertaForSequenceClassification"
  ],
  "attention_probs_dropout_prob": 0.1,
  "bos_token_id": 0,
  "do_sample": false,
  "eos_token_id": 2,
  "eos_token_ids": null,
  "finetuning_task": "mnli",
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 1024,
  "id2label": {
    "0": "LABEL_0",
    "1": "LABEL_1"
  },
  "initializer_range": 0.02,
  "intermediate_size": 4096,
  "is_decoder": false,
  "label2id": {
    "LABEL_0": 0,
    "LABEL_1": 1
  },
  "layer_norm_eps": 1e-05,
  "length_penalty": 1.0,
  "max_length": 20,
  "max_position_embeddings": 514,
  "model_type": "roberta",
  "num_attention_heads": 16,
  "num_beams": 1,
  "num_hidden_layers": 24,
  "num_labels": 3,
  "num_return_sequences": 1,
  "output_attentions": false,
  "output_hidden_states": false,
  "output_past": true,
  "pad_token_id": 1,
  "pruned_heads": {},
  "repetition_penalty": 1.0,
  "temperature": 1.0,
  "top_k": 50,
  "top_p": 1.0,
  "torchscript": false,
  "type_vocab_size": 1,
  "use_bfloat16": false,
  "vocab_size": 50265
}

2021-03-13 21:52:05,238 - INFO - transformers.modeling_utils - loading weights file /gscratch/xlab/alisaliu/cartography/output/mnli_ambiguous/ambiguous_0.01/pytorch_model.bin
2021-03-13 21:52:17,619 - INFO - __main__ - Creating features from dataset file at /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/
2021-03-13 21:52:17,654 - INFO - cartography.classification.glue_utils - Writing example 0/1104
2021-03-13 21:52:18,057 - INFO - __main__ - Saving features into cached file /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/filtered/ambiguous/cartography_variability_0.01/cache_20/cached_test_matched__roberta-large_128_mnli
2021-03-13 21:52:18,152 - INFO - __main__ - ***** Running mnli  evaluation on test_matched *****
2021-03-13 21:52:18,152 - INFO - __main__ -   Num examples = 1104
2021-03-13 21:52:18,152 - INFO - __main__ -   Batch size = 96
Evaluating:   0%|                                                            | 0/12 [00:00<?, ?it/s]Evaluating: 100%|███████████████████████████████████████████████████| 12/12 [00:07<00:00,  1.56it/s]
2021-03-13 21:52:25,872 - INFO - cartography.selection.selection_utils - Test_matched dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_ambiguous/ambiguous_0.01/test_matched_dynamics/dynamics_epoch_None.jsonl
2021-03-13 21:52:25,872 - INFO - __main__ - ***** mnli test_matched results  *****
2021-03-13 21:52:25,872 - INFO - __main__ - mnli test_matched  acc = 0.2337
2021-03-13 21:52:25,874 - INFO - __main__ - ***** Write mnli test_matched predictions  *****
2021-03-13 21:52:25,890 - INFO - __main__ - Creating features from dataset file at /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/
2021-03-13 21:52:25,896 - INFO - cartography.classification.glue_utils - Writing example 0/1104
2021-03-13 21:52:26,100 - INFO - __main__ - Saving features into cached file /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/filtered/ambiguous/cartography_variability_0.01/cache_20/cached_test_mismatched__roberta-large_128_mnli-mm
2021-03-13 21:52:26,193 - INFO - __main__ - ***** Running mnli-mm  evaluation on test_mismatched *****
2021-03-13 21:52:26,194 - INFO - __main__ -   Num examples = 1104
2021-03-13 21:52:26,194 - INFO - __main__ -   Batch size = 96
Evaluating:   0%|                                                            | 0/12 [00:00<?, ?it/s]Evaluating: 100%|███████████████████████████████████████████████████| 12/12 [00:07<00:00,  1.56it/s]
2021-03-13 21:52:33,919 - INFO - cartography.selection.selection_utils - Test_mismatched dynamics logged to /gscratch/xlab/alisaliu/cartography/output/mnli_ambiguous/ambiguous_0.01/test_mismatched_dynamics/dynamics_epoch_None.jsonl
2021-03-13 21:52:33,920 - INFO - __main__ - ***** mnli-mm test_mismatched results  *****
2021-03-13 21:52:33,920 - INFO - __main__ - mnli-mm test_mismatched  acc = 0.2337
2021-03-13 21:52:33,921 - INFO - __main__ - ***** Write mnli-mm test_mismatched predictions  *****
  0%|          | 0/1105 [00:00<?, ?it/s]100%|██████████| 1105/1105 [00:00<00:00, 734967.64it/s]
2021-03-13 21:52:33,937 - INFO - cartography.data_utils_glue - Read 1104 valid examples, with unique IDS, out of 1104 from /gscratch/xlab/alisaliu/cartography/data/glue/MNLI/diagnostic/diagnostic_test.tsv
/gscratch/cse/alisaliu/miniconda3/envs/cartography/lib/python3.9/site-packages/sklearn/metrics/_classification.py:846: RuntimeWarning: invalid value encountered in double_scalars
  mcc = cov_ytyp / np.sqrt(cov_ytyt * cov_ypyp)
2021-03-13 21:52:33,977 - INFO - cartography.classification.diagnostics_evaluation - logic                         : 0.2692 r3: 0.0000 98/ 364 class-var: 0.046
2021-03-13 21:52:33,978 - INFO - cartography.classification.diagnostics_evaluation - predicate_argument_structure  : 0.1368 r3: 0.0000 58/ 424 class-var: 0.148
2021-03-13 21:52:33,978 - INFO - cartography.classification.diagnostics_evaluation - lexical_semantics             : 0.2703 r3: 0.0000 100/ 370 class-var: 0.063
2021-03-13 21:52:33,978 - INFO - cartography.classification.diagnostics_evaluation - knowledge                     : 0.3169 r3: 0.0000 90/ 284 class-var: 0.064
2021-03-13 21:52:33,978 - INFO - cartography.classification.diagnostics_evaluation - total acc                     : 0.2337 r3: 0.0000 258/1104 class-var: 0.076
2021-03-13 21:52:33,978 - INFO - cartography.classification.diagnostics_evaluation - Results written to /gscratch/xlab/alisaliu/cartography/output/mnli_ambiguous/ambiguous_0.01/eval_metrics_diagnostics.json
2021-03-13 21:52:33,979 - INFO - __main__ -  **** Done ****
